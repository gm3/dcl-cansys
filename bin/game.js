"use strict";const getGlobalThis=function(){if("undefined"!=typeof globalThis)return globalThis;if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==this)return this;throw new Error("Unable to locate global `this`")},globalObject=getGlobalThis();var loader;!function(v){let T=0;const A=[],C=[],E={baseUrl:""},R={};function c(v,A,C){let E=null,O={},z=null;"function"==typeof v?O=v:"string"==typeof v?(E=v,"function"==typeof A?O=A:A instanceof Array&&(z=A,O=C)):v instanceof Array&&(z=v,"function"==typeof A&&(O=A)),z=z||["require","exports","module"],null===E&&(E="unnamed-module-"+T++),E=g(E),z=(z||[]).map((v=>function(v,T){return v?b(T,v):T}(E,v))),R[E]||(R[E]={name:E,parent:null,dclamd:1,dependencies:z,handlers:[],exports:{},dependants:new Set}),R[E].dependencies=z,p(z,(function(v){const T=R[E];if(!T)throw new Error("Could not access registered module "+E);let A=T.exports;A="function"==typeof O?O.apply(globalObject,v)||A:O,T.exports=A,d(E)}),(v=>{if("function"!=typeof onerror)throw v;onerror(v)}),E)}function d(v){const T=R[v];if(!T)throw new Error("Could not access registered module "+v);T.dclamd=2;const A=T.handlers;if(A&&A.length)for(let T=0;T<A.length;T++)A[T](R[v])}function u(v,T,A){if(!R[v])return null;if(v===T||50===A)return[v];const C=R[v].dependencies;for(let E=0,R=C.length;E<R;E++){const R=u(C[E],T,A+1);if(null!==R)return R.push(v),R}return null}function a(v,T){const A=R[v];if(!A)return!1;const C={};for(const v in R)C[v]=!1;const E=[];for(E.push(A),C[v]=!0;E.length>0;){const v=E.shift().dependencies;if(v)for(let A=0,O=v.length;A<O;A++){const O=v[A];if(O===T)return!0;const z=R[O];z&&!C[O]&&(C[O]=!0,E.push(z))}}return!1}function p(v,T,A,E){const O=new Array(v.length).fill(null);let z=0,M=!1;if("string"==typeof v){if(R[v]){if(1===R[v].dclamd)throw new Error(`Trying to load ${v} from ${E}. The first module is still loading.`);return R[v]}throw new Error(v+" has not been defined. Please include it as a dependency in "+E+"'s define()")}const V=v.length;for(let H=0;H<V;H++)switch(v[H]){case"require":const h=function(v,T,A){return p(v,T,A,E)};h.toUrl=function(v){return b(v,E)},O[H]=h,z++;break;case"exports":if(!R[E])throw new Error("Parent module "+E+" not registered yet");O[H]=R[E].exports,z++;break;case"module":O[H]={id:E,uri:b(E)},z++;break;default:{const W=v[H],m=()=>{O[H]=R[W].exports,z++,z===V&&T&&(M=!0,T(O))};if(a(W,E)){const v=u(W,E,0);v&&(v.reverse(),v.push(W),C.push(v)),w(W,(()=>{}),A,E),m()}else w(W,m,A,E);break}}!M&&z===V&&T&&T(O)}function h(v,T){return function(){return dcl.callRpc(v,T.name,A.slice.call(arguments,0))}}function w(v,T,A,C){if(R[v])return R[v].dependants.add(C),void(1===R[v].dclamd?T&&R[v].handlers.push(T):T&&T(R[v]));if(R[v]={name:v,parent:C,dclamd:1,handlers:[T],dependencies:[],dependants:new Set([C]),exports:{}},0===v.indexOf("@")){const T=R[v].exports;if("function"!=typeof dcl.loadModule)throw new Error("Asynchronous modules will not work because loadModule function is not present");dcl.loadModule(v,T).then((A=>{for(const v in A.methods){const C=A.methods[v];T[C.name]=h(A.rpcHandle,C)}d(v)})).catch((v=>{A(v)}))}}function g(v){let T,A=v;for(T=/\/\.\//;T.test(A);)A=A.replace(T,"/");for(A=A.replace(/^\.\//g,""),T=/\/(([^\/])|([^\/][^\/\.])|([^\/\.][^\/])|([^\/][^\/][^\/]+))\/\.\.\//;T.test(A);)A=A.replace(T,"/");return A=A.replace(/^(([^\/])|([^\/][^\/\.])|([^\/\.][^\/])|([^\/][^\/][^\/]+))\/\.\.\//,""),A=A.replace(/^\//g,""),A}function b(v,T){switch(v){case"require":case"exports":case"module":return v}return T?function(v,T){let A=v;if(!A.startsWith("@")&&(A.startsWith("./")||A.startsWith("../"))){const v=T.split("/");v.pop(),A=g(v.join("/")+"/"+A)}return A}(v,T):g(v)}v.config=function(v){if("object"==typeof v)for(const T in v)v.hasOwnProperty(T)&&(E[T]=v[T])},v.define=c,function(v){v.amd={},v.modules=R}(c=v.define||(v.define={})),v.require=p,"undefined"!=typeof dcl&&dcl.onStart((()=>{const v=new Set,T=[];for(const A in R)R[A]&&(1===R[A].dclamd&&T.push(R[A]),R[A].dependencies.forEach((T=>{"require"!==T&&"exports"!==T&&"module"!==T&&(R[T]||v.add(T))})));const A=[];if(C.length&&A.push(`\n> Cyclic dependencies: ${C.map((v=>"\n  - "+v.join(" -> "))).join("")}`),v.size&&A.push(`\n> Undeclared/unknown modules: ${Array.from(v).map((v=>"\n  - "+v)).join("")}`),T.length&&A.push(`\n> These modules didn't load: ${T.map((v=>"\n  - "+v.name)).join("")}.\n`),A.length)throw new Error(A.join("\n"))})),p.toUrl=b}(loader||(loader={})),globalObject.define=loader.define,globalObject.dclamd=loader,function(v){var T=function(){function t(){}return t.AVATAR={getEntityRepresentation:function(v){return v.avatarEntity}},t.FIRST_PERSON_CAMERA={getEntityRepresentation:function(v){return v.firstPersonCameraEntity}},t}(),n=function(v,T){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,T){v.__proto__=T}||function(v,T){for(var A in T)Object.prototype.hasOwnProperty.call(T,A)&&(v[A]=T[A])})(v,T)};
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function i(v,T){if("function"!=typeof T&&null!==T)throw new TypeError("Class extends value "+String(T)+" is not a constructor or null");function i(){this.constructor=v}n(v,T),v.prototype=null===T?Object.create(T):(i.prototype=T.prototype,new i)}var o=function(){return(o=Object.assign||function(v){for(var T,A=1,C=arguments.length;A<C;A++)for(var E in T=arguments[A])Object.prototype.hasOwnProperty.call(T,E)&&(v[E]=T[E]);return v}).apply(this,arguments)};function r(v,T,A,C){var E,R=arguments.length,O=R<3?T:null===C?C=Object.getOwnPropertyDescriptor(T,A):C;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)O=Reflect.decorate(v,T,A,C);else for(var z=v.length-1;z>=0;z--)(E=v[z])&&(O=(R<3?E(O):R>3?E(T,A,O):E(T,A))||O);return R>3&&O&&Object.defineProperty(T,A,O),O}function s(v,T){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(v,T)}function h(v){var T="function"==typeof Symbol&&Symbol.iterator,A=T&&v[T],C=0;if(A)return A.call(v);if(v&&"number"==typeof v.length)return{next:function(){return v&&C>=v.length&&(v=void 0),{value:v&&v[C++],done:!v}}};throw new TypeError(T?"Object is not iterable.":"Symbol.iterator is not defined.")}function l(v,T){var A="function"==typeof Symbol&&v[Symbol.iterator];if(!A)return v;var C,E,R=A.call(v),O=[];try{for(;(void 0===T||T-- >0)&&!(C=R.next()).done;)O.push(C.value)}catch(v){E={error:v}}finally{try{C&&!C.done&&(A=R.return)&&A.call(R)}finally{if(E)throw E.error}}return O}function p(v,T){for(var A=0,C=T.length,E=v.length;A<C;A++,E++)v[E]=T[A];return v}var A=0;function c(){for(var v=[],T=0;T<arguments.length;T++)v[T]=arguments[T];"undefined"!=typeof dcl?dcl.log.apply(dcl,p([],l(v))):console.log.apply(console,p(["DEBUG:"],l(v)))}function y(v,T){"undefined"!=typeof dcl?dcl.error(v,T):console.error("ERROR:",v,T)}function f(v){if(A++,0===v.length)throw new Error("newId(type: string): type cannot be empty");return v+A.toString(36)}function m(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(v){var T=16*Math.random()|0;return("x"===v?T:3&T|8).toString(16)}))}var C=[];function _(v){if(!("__event_name__"in v)||"string"!=typeof v.__event_name__)throw new Error("The EventConstructor is not registered");return v.__event_name__}var E=function(){function t(){this.listeners={}}return t.prototype.addListener=function(v,T,A){if(!v||"function"!=typeof v)throw new Error("Invalid EventConstructor");var C=_(v),E=this.listeners[C];E||(E=this.listeners[C]=[]);for(var R=0;R<E.length;R++)if(E[R].listener===T)throw new Error("The provided listener is already registered");return E.push({listener:T,fn:A}),this},t.prototype.removeListener=function(v,T){if(!T||"function"!=typeof T)throw new Error("Invalid EventConstructor");var A=_(T),C=this.listeners[A];if(!C)return!1;for(var E=0;E<C.length;E++)if(C[E].listener===v)return C.splice(E,1),!0;return!1},t.prototype.fireEvent=function(v){var T=_(v.constructor),A=this.listeners[T];if(A)for(var C=0;C<A.length;C++)try{var E=A[C];E.fn.call(E.listener,v)}catch(v){y(v)}return this},t}();function x(){var v=f("EV");if(-1!==C.indexOf(v))throw new Error("The event name "+v+" is already taken");return C.push(v),function(T){return T.__event_name__=v,T}}var R,O=r([x(),s("design:paramtypes",[Object,String,Object])],(function(v,T,A){this.entity=v,this.componentName=T,this.component=A})),z=r([x(),s("design:paramtypes",[Object,String,Object])],(function(v,T,A){this.entity=v,this.componentName=T,this.classId=A})),M=r([x(),s("design:paramtypes",[Object,Object])],(function(v,T){this.entity=v,this.parent=T}));v.UIValueType=void 0,(R=v.UIValueType||(v.UIValueType={}))[R.PERCENT=0]="PERCENT",R[R.PIXELS=1]="PIXELS";var V=function(){function e(T){if(this.type=v.UIValueType.PIXELS,"string"==typeof T){var A=T;A.indexOf("px")>-1?this.type=v.UIValueType.PIXELS:A.indexOf("%")>-1&&(this.type=v.UIValueType.PERCENT),this.value=parseFloat(A)}else this.value=T}return e.prototype.toString=function(){var T=this.value.toString();return this.type===v.UIValueType.PERCENT?T+="%":T+="px",T},e}(),H="__name__symbol_",W="__classId__symbol_",j="__component__id_",X=r([x(),s("design:paramtypes",[String,String,Number])],(function(v,T,A){this.componentId=v,this.componentName=T,this.classId=A})),K=r([x(),s("design:paramtypes",[String])],(function(v){this.componentId=v})),Z=r([x(),s("design:paramtypes",[String,Object])],(function(v,T){this.componentId=v,this.component=T}));function P(v,T){return function(A){if(A.isComponent)throw new TypeError("You cannot extend a component. Trying to extend "+A.originalClassName+" with: "+v);var C=A,o=function(){var A=Array.prototype.slice.call(arguments),E=new(C.bind.apply(C,p([void 0],l(A))));return Object.defineProperty(E,H,{enumerable:!1,writable:!1,configurable:!1,value:v}),void 0!==T&&Object.defineProperty(E,W,{enumerable:!1,writable:!1,configurable:!1,value:T}),E};return void 0!==T&&(o.__classId__symbol_=T),o.__name__symbol_=v,o.isComponent=!0,o.originalClassName=v,(o.prototype=A.prototype).constructor=A,o}}function N(v,T){return function(A){if(A.isComponent)throw new TypeError("You cannot extend a component. Trying to extend "+A.originalClassName+" with: "+v);if("number"!=typeof T||isNaN(T))throw new Error("classId: "+T+" is an invalid integer");var C=A,o=function(){if(!N.engine)throw new Error("You need to set a DisposableComponent.engine before creating disposable components");var A=Array.prototype.slice.call(arguments),E=new(C.bind.apply(C,p([void 0],l(A)))),R=f("C");return Object.defineProperty(E,H,{enumerable:!1,writable:!1,configurable:!1,value:v}),Object.defineProperty(E,j,{enumerable:!1,writable:!1,configurable:!1,value:R}),void 0!==T&&Object.defineProperty(E,W,{enumerable:!1,writable:!1,configurable:!1,value:T}),N.engine&&N.engine.registerComponent(E),E};return void 0!==T&&(o.__classId__symbol_=T),o.__name__symbol_=v,o.isComponent=!0,o.isDisposableComponent=!0,o.originalClassName=v,(o.prototype=A.prototype).constructor=A,o}}function F(v){if(!v)throw new TypeError(v+" is not a component.");if(v.__name__symbol_)return v.__name__symbol_;throw new TypeError(v+" is not a registered component.")}function L(v){if(!v)throw new TypeError(v+" is not a component.");if(v.__classId__symbol_)return v.__classId__symbol_;if(!v.__name__symbol_)throw new TypeError(v+" is not a registered component.");return null}function D(v){if(!v)throw new TypeError(v+" is not a component.");if(v.__component__id_)return v.__component__id_;throw new TypeError(v+" is not a registered disposable component.")}!function(v){v.engine=null}(N||(N={}));var J=function(){function t(){this.dirty=!1,this.data={},this.subscriptions=[]}return t.component=function(v,T){if(delete v[T]){var A=T+"_"+Math.random();v[A]=void 0,Object.defineProperty(v,A,o(o({},Object.getOwnPropertyDescriptor(v,A)),{enumerable:!1})),Object.defineProperty(v,T.toString(),{get:function(){return this[A]},set:function(v){var C=this[A];if(this.data[T]=v?D(v):null,this[A]=v,v!==C){this.dirty=!0;for(var E=0;E<this.subscriptions.length;E++)this.subscriptions[E](T,v,C)}},enumerable:!0})}},t.field=function(v,T){delete v[T]&&Object.defineProperty(v,T.toString(),{get:function(){return this.data[T]},set:function(v){var A=this.data[T];if(this.data[T]=v,v!==A){this.dirty=!0;for(var C=0;C<this.subscriptions.length;C++)this.subscriptions[C](T,v,A)}},enumerable:!0})},t.uiValue=function(v,T){delete v[T]&&Object.defineProperty(v,T.toString(),{get:function(){return this.data[T].toString()},set:function(v){var A=this.data[T],C=new V(v);if(this.data[T]=C,C!==A){this.dirty=!0;for(var E=0;E<this.subscriptions.length;E++)this.subscriptions[E](T,C,A)}},enumerable:!0})},t.readonly=function(v,T){delete v[T]&&Object.defineProperty(v,T.toString(),{get:function(){if(T in this.data==0)throw new Error("The field "+T+" is uninitialized");return this.data[T]},set:function(v){if(T in this.data)throw new Error("The field "+T+" is readonly");this.data[T]=v,this.dirty=!0},enumerable:!0,configurable:!1})},t.prototype.onChange=function(v){return this.subscriptions.push(v),this},t.prototype.toJSON=function(){return this.data},t}();function U(v){return j in v}var $=function(){function t(){for(var v=[],T=0;T<arguments.length;T++)v[T]=arguments[T];if(this.entities=[],this.active=!1,this._requiresNames=[],!v)throw new Error("ComponentGroup: Could not load the requires list");if(!(v instanceof Array))throw new Error("ComponentGroup: requires list is not an Array");Object.defineProperty(this,"requires",{get:function(){return v.slice()}}),Object.defineProperty(this,"requiresNames",{get:function(){return this._requiresNames.slice()}});for(var n=function(T){var C=v[T],E=null;if(!C)throw new Error("ComponentGroup: the required component at location "+T+" is invalid");try{E=F(C)}catch(v){throw new Error("ComponentGroup: the required component at location "+T+" is not registered as a @Component. Remember to provide the class of the component, not the name")}if(A._requiresNames.some((function(v){return v===E})))throw new Error("ComponentGroup: the required component list has a repeated name "+E);A._requiresNames.push(E)},A=this,C=0;C<v.length;C++)n(C)}return t.prototype.hasEntity=function(v){return!!v.isAddedToEngine()&&-1!==this.entities.indexOf(v)},t.prototype.addEntity=function(v){if(!v.isAddedToEngine())throw new TypeError("ComponentGroup: Cannot add a entity that is not added to the engine");-1===this.entities.indexOf(v)&&this.entities.push(v)},t.prototype.removeEntity=function(v){var T=this.entities.indexOf(v);-1!==T&&this.entities.splice(T,1)},t.prototype.componentRemoved=function(v,T){-1!==this._requiresNames.indexOf(T)&&this.removeEntity(v)},t.prototype.meetsRequirements=function(v){for(var T=0;T<this._requiresNames.length;T++)if(!(this._requiresNames[T]in v.components))return!1;return!0},t}(),et=function(){function t(v){this.name=v,this.children={},this.eventManager=null,this.alive=!1,this.uuid=f("E"),this.components={},this.engine=null,this._parent=null}return t.prototype.addComponentOrReplace=function(v){if("function"==typeof v)throw new Error("You passed a function or class as a component, an instance of component is expected");if("object"!=typeof v)throw new Error("You passed a "+typeof v+", an instance of component is expected");var T=F(v);if(this.components[T]){if(this.components[T]===v)return v;this.removeComponent(this.components[T],!1)}return this.addComponent(v)},t.prototype.hasComponent=function(v){var T=typeof v;if("string"!==T&&"object"!==T&&"function"!==T)throw new Error("Entity#has(component): component is not a class, name or instance");if(null===v)return!1;var A="string"===T?v:F(v),C=this.components[A];return!!C&&("object"===T?C===v:"function"!==T||C instanceof v)},t.prototype.getComponent=function(v){var T=typeof v;if("string"!==T&&"function"!==T)throw new Error("Entity#get(component): component is not a class or name");var A="string"===T?v:F(v),C=this.components[A];if(!C)throw new Error('Can not get component "'+A+'" from entity "'+this.identifier+'"');if("function"===T){if(C instanceof v)return C;throw new Error('Can not get component "'+A+'" from entity "'+this.identifier+'" (by instance)')}return C},t.prototype.getComponentOrNull=function(v){var T=typeof v;if("string"!==T&&"function"!==T)throw new Error("Entity#getOrNull(component): component is not a class or name");var A="string"===T?v:F(v),C=this.components[A];return C?"function"===T?C instanceof v?C:null:C:null},t.prototype.getComponentOrCreate=function(v){if("function"!=typeof v)throw new Error("Entity#getOrCreate(component): component is not a class");var T=this.getComponentOrNull(v);return T||(F(T=new v),this.addComponentOrReplace(T)),T},t.prototype.addComponent=function(v){if("object"!=typeof v)throw new Error("Entity#add(component): You passed a function or class as a component, an instance of component is expected");var T=F(v),A=L(v);if(this.components[T])throw new Error('A component of type "'+T+'" is already present in entity "'+this.identifier+'"');this.components[T]=v,this.eventManager&&this.eventManager.fireEvent(new z(this,T,A));var C=v;return"function"==typeof C.addedToEntity&&C.addedToEntity(this),v},t.prototype.removeComponent=function(v,T){void 0===T&&(T=!0);var A=typeof v;if("string"!==A&&"function"!==A&&"object"!==A)throw new Error("Entity#remove(component): component is not a class, class or name");var C="string"===A?v:F(v),E=this.components[C];if(E){if("function"===A)return E instanceof v?(delete this.components[C],void(E&&(T&&this.eventManager&&this.eventManager.fireEvent(new O(this,C,E)),"function"==typeof E.removedFromEntity&&E.removedFromEntity(this)))):void c('Entity Warning: Trying to remove wrong (by constructor) component "'+C+'" from entity "'+this.identifier+'"');delete this.components[C],E&&(T&&this.eventManager&&this.eventManager.fireEvent(new O(this,C,E)),"function"==typeof E.removedFromEntity&&E.removedFromEntity(this))}else c('Entity Warning: Trying to remove inexisting component "'+C+'" from entity "'+this.identifier+'"')},t.prototype.isAddedToEngine=function(){return!(!this.engine||!(this.uuid in this.engine.entities)&&this.engine.rootEntity!==this)},t.prototype.setParent=function(v){var T;if(v&&"getEntityRepresentation"in v){if(!this.engine)throw new Error("In order to set an attachable as parent, you first need to add the entity to the engine.");T=v.getEntityRepresentation(this.engine)}else T=!v&&this.engine?this.engine.rootEntity:v;var A=this.getParent();if(T===this)throw new Error('Failed to set parent for entity "'+this.identifier+"\": An entity can't set itself as a its own parent");if(T===A)return this;var C=this.getCircularAncestor(T);if(C)throw new Error('Failed to set parent for entity "'+this.identifier+'": Circular parent references are not allowed (See entity "'+C+'")');return A&&delete A.children[this.uuid],null!==T&&"0"!==T.uuid&&(!T.isAddedToEngine()&&this.isAddedToEngine()&&this.engine.removeEntity(this),T.isAddedToEngine()&&!this.isAddedToEngine()&&T.engine.addEntity(this)),this._parent=T||null,this.registerAsChild(),this.eventManager&&this.engine&&this.eventManager.fireEvent(new M(this,T)),this},t.prototype.getParent=function(){return this._parent},Object.defineProperty(t.prototype,"identifier",{get:function(){return this.name||this.uuid},enumerable:!1,configurable:!0}),t.prototype.getCircularAncestor=function(v){for(var T=this.engine?this.engine.rootEntity:null,A=v;A&&A!==T;){var C=A.getParent();if(C===this)return A.uuid;A=C}return null},t.prototype.registerAsChild=function(){var v=this.getParent();this.uuid&&v&&(v.children[this.uuid]=this)},t}(),nt=function(){function t(v){this.eventManager=new E,this.systems=[],this.entityLists={},this.addedSystems=[],this._entities={},this._disposableComponents={},this._componentGroups={},this.simpleSystems=[],this.eventManager.addListener(z,this,this.componentAddedHandler),this.eventManager.addListener(O,this,this.componentRemovedHandler),this.rootEntity=v,this.firstPersonCameraEntity=new et,this.firstPersonCameraEntity.uuid="FirstPersonCameraEntityReference",this.addEntity(this.firstPersonCameraEntity),this.avatarEntity=new et,this.avatarEntity.uuid="AvatarEntityReference",this.addEntity(this.avatarEntity)}return Object.defineProperty(t.prototype,"entities",{get:function(){return this._entities},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"disposableComponents",{get:function(){return this._disposableComponents},enumerable:!1,configurable:!0}),t.prototype.addEntity=function(v){var T=v.getParent();if(v.isAddedToEngine())return v;for(var A in v.eventManager=this.eventManager,v.engine=this,this._entities[v.uuid]=v,this.checkRequirementsAndAdd(v),T?T.isAddedToEngine()||T===this.rootEntity||c("Engine: warning, added an entity with a parent not present in the engine. Parent id: "+T.uuid):v.setParent(this.rootEntity),v.alive=!0,v.children){var C=v.children[A];C&&(C.isAddedToEngine()||this.addEntity(C))}return v},t.prototype.removeEntity=function(v){var T=v.uuid;if(v.isAddedToEngine()){for(var A in v.components){var C=this._componentGroups[A];if(C)for(var E in C)C[E].removeEntity(v);delete this.entityLists[A][T]}for(var R=0;R<this.simpleSystems.length;R++){var O=this.simpleSystems[R];O.onRemoveEntity&&O.onRemoveEntity(v)}for(var R in v.children){var z=v.children[R];z&&this.removeEntity(z)}return v.alive=!1,v.eventManager=null,delete this._entities[T],!0}for(var A in c("Engine: Trying to remove non existent entity from engine."),v.isAddedToEngine()?c("Engine: Entity id: "+T):c('Engine: Entity "'+v.uuid+'" has not been added to any engine yet.'),c("Engine: Entity's components:"),v.components)c(A);return!1},t.prototype.addSystem=function(v,T){if(void 0===T&&(T=0),-1!==this.addedSystems.indexOf(v))return c("Engine: Trying to add a system that is already added. Aborting"),v;if(this.systems.length>0)for(var A=0;A<this.systems.length;A++){var C=this.systems[A],E=A===this.systems.length-1;if(C.priority>T){this.addedSystems.push(v),this.systems.splice(A,0,{system:v,priority:T});break}if(E){this.addedSystems.push(v),this.systems.splice(A+1,0,{system:v,priority:T});break}}else this.addedSystems.push(v),this.systems.splice(1,0,{system:v,priority:T});return this.registerSystem(v),v},t.prototype.removeSystem=function(v){var T=this.addedSystems.indexOf(v);if(-1!==T){v.active=!1,v.deactivate&&v.deactivate(),this.addedSystems.splice(T,1);for(var A=0;A<this.systems.length;A++)this.systems[A].system===v&&this.systems.splice(A,1);return!0}return!1},t.prototype.update=function(v){for(var T in this.systems){var A=this.systems[T].system;if(A.active&&A.update)try{A.update(v)}catch(v){y(v)}}return this},t.prototype.getEntitiesWithComponent=function(v){var T="string"==typeof v?v:F(v);return T in this.entityLists?this.entityLists[T]:this.entityLists[T]={}},t.prototype.registerComponent=function(v){var T=D(v),A=F(v),C=L(v);this._disposableComponents[T]=v,null!==C&&(this.eventManager.fireEvent(new X(T,A,C)),this.eventManager.fireEvent(new Z(T,v)))},t.prototype.disposeComponent=function(v){var T=D(v);return delete this._disposableComponents[T]&&(this.eventManager.fireEvent(new K(T)),v.onDispose&&v.onDispose(),!0)},t.prototype.updateComponent=function(v){this.eventManager.fireEvent(new Z(D(v),v))},t.prototype.getComponentGroup=function(){for(var v=[],T=0;T<arguments.length;T++)v[T]=arguments[T];var A=void 0;if(v.length>0&&(M=this._componentGroups[F(v[0])]))for(var C=v.slice(),E=0;E<M.length;E++){var R=M[E];if(C.length===R.requires.length){for(var O=0;O<C.length&&-1!==R.requires.indexOf(C[O]);O++)O===C.length-1&&(A=R);if(A)break}}if(A)return A;(A=new($.bind.apply($,p([void 0],l(v))))).active=!0;var z=A.requiresNames;for(E=0;E<z.length;E++){var M,V=z[E];(M=this._componentGroups[V])||(this._componentGroups[V]=M=[]),-1===M.indexOf(A)&&M.push(A)}for(var H in this._entities)this.checkRequirements(this._entities[H],A);return A},t.prototype.removeComponentGroup=function(v){if(v.active){v.active=!1;for(var T=v.requiresNames,A=0;A<T.length;A++){var C=T[A],E=this._componentGroups[C];if(E){var R=E.indexOf(v);-1!==R&&E.splice(R,1)}}return!0}return!1},t.prototype.registerSystem=function(v){v.active=!0,v.activate&&v.activate(this),this.simpleSystems.push(v)},t.prototype.checkRequirementsAndAdd=function(v){if(v.isAddedToEngine()){for(var T in v.components){T in this.entityLists||(this.entityLists[T]={}),this.entityLists[T][v.uuid]=v;var A=this._componentGroups[T];if(A)for(var C in A)this.checkRequirements(v,A[C])}for(var E=0;E<this.simpleSystems.length;E++){var R=this.simpleSystems[E];R.onAddEntity&&R.onAddEntity(v)}}},t.prototype.checkRequirements=function(v,T){T.meetsRequirements(v)?T.hasEntity(v)||T.addEntity(v):T.hasEntity(v)&&T.removeEntity(v)},t.prototype.componentAddedHandler=function(v){var T,A=v.entity,C=v.componentName;if(A.isAddedToEngine()){this.entityLists[C]?this.entityLists[C][A.uuid]=A:this.entityLists[C]=((T={})[A.uuid]=A,T);var E=this._componentGroups[C];if(E)for(var R in E)this.checkRequirements(A,E[R])}},t.prototype.componentRemovedHandler=function(v){var T=v.entity,A=v.componentName;if(T.isAddedToEngine()){delete this.entityLists[A][T.uuid];var C=this._componentGroups[A];if(C)for(var E in C)this.checkRequirements(T,C[E])}},t}(),it=Promise.resolve().then.bind(Promise.resolve());function G(v){var T=it(v);return T.isComplete=!1,T.then((function(v){T.isComplete=!0,T.result=v,T.didFail=!1})).catch((function(v){T.isComplete=!0,T.error=v,T.didFail=!0,y("executeTask: FAILED "+v.toString(),v)})),T}var ot,rt,st=function(){function t(v,T,A,C){void 0===T&&(T=!1),this.initalize(v,T,A,C)}return t.prototype.initalize=function(v,T,A,C){return void 0===T&&(T=!1),this.mask=v,this.skipNextObservers=T,this.target=A,this.currentTarget=C,this},t}(),Y=function(v,T,A){void 0===A&&(A=null),this.callback=v,this.mask=T,this.scope=A,this.unregisterOnNextCall=!1,this._willBeUnregistered=!1},at=function(){function t(){this._observers=null,this._observables=null}return t.Watch=function(v,T,A,C){var E,R;void 0===A&&(A=-1),void 0===C&&(C=null);var O=new t;O._observers=new Array,O._observables=v;try{for(var z=h(v),M=z.next();!M.done;M=z.next()){var V=M.value.add(T,A,!1,C);V&&O._observers.push(V)}}catch(v){E={error:v}}finally{try{M&&!M.done&&(R=z.return)&&R.call(z)}finally{if(E)throw E.error}}return O},t.prototype.dispose=function(){if(this._observers&&this._observables)for(var v=0;v<this._observers.length;v++)this._observables[v].remove(this._observers[v]);this._observers=null,this._observables=null},t}(),ct=function(){function t(v){this._observers=new Array,this._onObserverAdded=null,this._eventState=new st(0),v&&(this._onObserverAdded=v)}return t.prototype.add=function(v,T,A,C,E){if(void 0===T&&(T=-1),void 0===A&&(A=!1),void 0===C&&(C=null),void 0===E&&(E=!1),!v)return null;var R=new Y(v,T,C);return R.unregisterOnNextCall=E,A?this._observers.unshift(R):this._observers.push(R),this._onObserverAdded&&this._onObserverAdded(R),R},t.prototype.addOnce=function(v){return this.add(v,void 0,void 0,void 0,!0)},t.prototype.remove=function(v){return!!v&&-1!==this._observers.indexOf(v)&&(this._deferUnregister(v),!0)},t.prototype.removeCallback=function(v,T){for(var A=0;A<this._observers.length;A++)if(this._observers[A].callback===v&&(!T||T===this._observers[A].scope))return this._deferUnregister(this._observers[A]),!0;return!1},t.prototype.notifyObservers=function(v,T,A,C){var E,R;if(void 0===T&&(T=-1),!this._observers.length)return!0;var O=this._eventState;O.mask=T,O.target=A,O.currentTarget=C,O.skipNextObservers=!1,O.lastReturnValue=v;try{for(var z=h(this._observers),M=z.next();!M.done;M=z.next()){var V=M.value;if(!V._willBeUnregistered&&(V.mask&T&&(V.scope?O.lastReturnValue=V.callback.apply(V.scope,[v,O]):O.lastReturnValue=V.callback(v,O),V.unregisterOnNextCall&&this._deferUnregister(V)),O.skipNextObservers))return!1}}catch(v){E={error:v}}finally{try{M&&!M.done&&(R=z.return)&&R.call(z)}finally{if(E)throw E.error}}return!0},t.prototype.notifyObserversWithPromise=function(v,T,A,C){var E=this;void 0===T&&(T=-1);var R=Promise.resolve(v);if(!this._observers.length)return R;var O=this._eventState;return O.mask=T,O.target=A,O.currentTarget=C,O.skipNextObservers=!1,this._observers.forEach((function(A){O.skipNextObservers||A._willBeUnregistered||A.mask&T&&(R=A.scope?R.then((function(T){return O.lastReturnValue=T,A.callback.apply(A.scope,[v,O])})):R.then((function(T){return O.lastReturnValue=T,A.callback(v,O)})),A.unregisterOnNextCall&&E._deferUnregister(A))})),R.then((function(){return v}))},t.prototype.notifyObserver=function(v,T,A){void 0===A&&(A=-1);var C=this._eventState;C.mask=A,C.skipNextObservers=!1,v.callback(T,C)},t.prototype.hasObservers=function(){return this._observers.length>0},t.prototype.clear=function(){this._observers=new Array,this._onObserverAdded=null},t.prototype.clone=function(){var v=new t;return v._observers=this._observers.slice(0),v},t.prototype.hasSpecificMask=function(v){var T,A;void 0===v&&(v=-1);try{for(var C=h(this._observers),E=C.next();!E.done;E=C.next()){var R=E.value;if(R.mask&v||R.mask===v)return!0}}catch(v){T={error:v}}finally{try{E&&!E.done&&(A=C.return)&&A.call(C)}finally{if(T)throw T.error}}return!1},t.prototype._deferUnregister=function(v){var T=this;v.unregisterOnNextCall=!1,v._willBeUnregistered=!0,G((function(){return function(v,T,A,C){return new(A||(A=Promise))((function(T,E){function s(v){try{d(C.next(v))}catch(v){E(v)}}function a(v){try{d(C.throw(v))}catch(v){E(v)}}function d(v){var C;v.done?T(v.value):(C=v.value,C instanceof A?C:new A((function(v){v(C)}))).then(s,a)}d((C=C.apply(v,[])).next())}))}(T,0,void 0,(function(){return function(v,T){var A,C,E,R,O={label:0,sent:function(){if(1&E[0])throw E[1];return E[1]},trys:[],ops:[]};return R={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(R[Symbol.iterator]=function(){return this}),R;function a(R){return function(z){return function(R){if(A)throw new TypeError("Generator is already executing.");for(;O;)try{if(A=1,C&&(E=2&R[0]?C.return:R[0]?C.throw||((E=C.return)&&E.call(C),0):C.next)&&!(E=E.call(C,R[1])).done)return E;switch(C=0,E&&(R=[2&R[0],E.value]),R[0]){case 0:case 1:E=R;break;case 4:return O.label++,{value:R[1],done:!1};case 5:O.label++,C=R[1],R=[0];continue;case 7:R=O.ops.pop(),O.trys.pop();continue;default:if(!((E=(E=O.trys).length>0&&E[E.length-1])||6!==R[0]&&2!==R[0])){O=0;continue}if(3===R[0]&&(!E||R[1]>E[0]&&R[1]<E[3])){O.label=R[1];break}if(6===R[0]&&O.label<E[1]){O.label=E[1],E=R;break}if(E&&O.label<E[2]){O.label=E[2],O.ops.push(R);break}E[2]&&O.ops.pop(),O.trys.pop();continue}R=T.call(v,O)}catch(v){R=[6,v],C=0}finally{A=E=0}if(5&R[0])throw R[1];return{value:R[0]?R[1]:void 0,done:!0}}([R,z])}}}(this,(function(T){return[2,this._remove(v)]}))}))}))},t.prototype._remove=function(v){if(!v)return!1;var T=this._observers.indexOf(v);return-1!==T&&(this._observers.splice(T,1),!0)},t}(),lt=r([x(),s("design:paramtypes",[String,Object])],(function(v,T){this.uuid=v,this.payload=T})),ut=r([x(),s("design:paramtypes",[Object])],(function(v){this.payload=v})),ht=r([x(),s("design:paramtypes",[Object])],(function(v){this.payload=v}));function tt(v){return function(){rt&&rt.subscribe(v)}}var pt=new ct(tt("cameraModeChanged")),dt=new ct(tt("idleStateChanged")),ft=new ct(tt("onEnterScene")),yt=ft,gt=new ct(tt("onLeaveScene")),vt=gt,bt=new ct(tt("sceneStart")),Tt=new ct(tt("playerExpression")),wt=new ct(tt("onPointerLock")),At=new ct(tt("videoEvent")),xt=new ct(tt("profileChanged")),St=new ct(tt("playerConnected")),_t=new ct(tt("playerDisconnected")),Ct=new ct(tt("onRealmChanged")),It=new ct(tt("playerClicked"));function mt(v){(rt=v)&&rt.onEvent((function(v){switch(v.type){case"onEnterScene":return void ft.notifyObservers(v.data);case"onLeaveScene":return void gt.notifyObservers(v.data);case"cameraModeChanged":return void pt.notifyObservers(v.data);case"idleStateChanged":return void dt.notifyObservers(v.data);case"sceneStart":return void bt.notifyObservers(v.data);case"playerExpression":return void Tt.notifyObservers(v.data);case"videoEvent":var T=v.data,A=N.engine.disposableComponents[T.componentId];return A&&A.update(T),void At.notifyObservers(T);case"profileChanged":return void xt.notifyObservers(v.data);case"onPointerLock":return void wt.notifyObservers(v.data);case"playerConnected":return void St.notifyObservers(v.data);case"playerDisconnected":return void _t.notifyObservers(v.data);case"onRealmChanged":return void Ct.notifyObservers(v.data);case"playerClicked":return void It.notifyObservers(v.data)}}))}var Rt=function(){function t(v){this.dcl=v,this.cachedComponents={}}return t.prototype.activate=function(v){var T=this;this.engine=v,v.eventManager.addListener(z,this,this.componentAdded),v.eventManager.addListener(O,this,this.componentRemoved),v.eventManager.addListener(X,this,this.disposableComponentCreated),v.eventManager.addListener(K,this,this.disposableComponentRemoved),v.eventManager.addListener(Z,this,this.disposableComponentUpdated),v.eventManager.addListener(M,this,this.parentChanged);var A=v.rootEntity.uuid;this.dcl.addEntity(A),this.dcl.onUpdate((function(A){v.update(A),T.presentEntities()})),this.dcl.onEvent((function(T){var A=T.data;switch(T.type){case"uuidEvent":v.eventManager.fireEvent(new lt(A.uuid,A.payload));break;case"raycastResponse":("HitFirst"===A.queryType||"HitAll"===A.queryType)&&v.eventManager.fireEvent(new ut(A));break;case"actionButtonEvent":v.eventManager.fireEvent(new ht(A.payload))}}))},t.prototype.onAddEntity=function(v){if(v&&v.isAddedToEngine()){var T=v.uuid,A=v.getParent();for(var C in this.dcl.addEntity(T),A&&this.dcl.setParent(T,A.uuid),this.cachedComponents[T]={},v.components){var E=v.components[C],R=L(E);if(null!==R)if(U(E))this.dcl.attachEntityComponent(v.uuid,C,D(E));else{var O=JSON.stringify(E);this.dcl.updateEntityComponent(T,C,R,O),this.cachedComponents[T][C]=O}}}},t.prototype.onRemoveEntity=function(v){if(v.isAddedToEngine()){var T=v.uuid;this.dcl.removeEntity(T),delete this.cachedComponents[T]}},t.prototype.presentEntities=function(){for(var v in this.engine.entities){var T=this.engine.entities[v];for(var A in T.components){var C=L(O=T.components[A]);if(null!==C&&!U(O)){var E=this.getJsonIfDirty(T.uuid,A,O);E&&(this.dcl.updateEntityComponent(T.uuid,A,C,E),this.clearDirty(T.uuid,A,O,E))}}}for(var R in this.engine.disposableComponents){var O;(O=this.engine.disposableComponents[R])instanceof J&&O.dirty&&(this.dcl.componentUpdated(R,JSON.stringify(O)),O.dirty=!1)}},t.prototype.componentAdded=function(v){if(v.entity.isAddedToEngine()){var T=v.entity.components[v.componentName];if(U(T))this.dcl.attachEntityComponent(v.entity.uuid,v.componentName,D(T));else if(null!==v.classId){var A=JSON.stringify(T);this.dcl.updateEntityComponent(v.entity.uuid,v.componentName,v.classId,A),this.cachedComponents[v.entity.uuid][v.componentName]=A}}},t.prototype.componentRemoved=function(v){v.entity.isAddedToEngine()&&(this.dcl.removeEntityComponent(v.entity.uuid,v.componentName),delete this.cachedComponents[v.entity.uuid][v.componentName])},t.prototype.disposableComponentCreated=function(v){this.dcl.componentCreated(v.componentId,v.componentName,v.classId)},t.prototype.disposableComponentRemoved=function(v){this.dcl.componentDisposed(v.componentId)},t.prototype.disposableComponentUpdated=function(v){this.dcl.componentUpdated(v.componentId,JSON.stringify(v.component))},t.prototype.parentChanged=function(v){this.dcl.setParent(v.entity.uuid,v.parent?v.parent.uuid:"0")},t.prototype.getJsonIfDirty=function(v,T,A){var C=JSON.stringify(A);return C!==this.cachedComponents[v][T]&&C},t.prototype.clearDirty=function(v,T,A,C){this.cachedComponents[v][T]=C},t}(),Ot="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},Pt={},Nt={};!function(v){var T,A;Object.defineProperty(v,"__esModule",{value:!0}),v.RAD2DEG=v.DEG2RAD=v.Epsilon=v.ToLinearSpace=v.ToGammaSpace=v.Space=v.Orientation=void 0,(T=v.Orientation||(v.Orientation={}))[T.CW=0]="CW",T[T.CCW=1]="CCW",(A=v.Space||(v.Space={}))[A.LOCAL=0]="LOCAL",A[A.WORLD=1]="WORLD",A[A.BONE=2]="BONE",v.ToGammaSpace=1/2.2,v.ToLinearSpace=2.2,v.Epsilon=1e-6,v.DEG2RAD=Math.PI/180,v.RAD2DEG=360/(2*Math.PI)}(Nt);var zt={},Lt={};Object.defineProperty(Lt,"__esModule",{value:!0}),Lt.buildArray=void 0,Lt.buildArray=function(v,T){const A=[];for(let C=0;C<v;++C)A.push(T());return A};var Ft={},Bt={},kt={},Ut={},Vt={};Object.defineProperty(Vt,"__esModule",{value:!0}),Vt.Scalar=void 0;class Et{static WithinEpsilon(v,T,A=1401298e-51){const C=v-T;return-A<=C&&C<=A}static ToHex(v){const T=v.toString(16);return v<=15?("0"+T).toUpperCase():T.toUpperCase()}static Sign(v){const T=+v;return 0===T||isNaN(T)?T:T>0?1:-1}static Clamp(v,T=0,A=1){return Math.min(A,Math.max(T,v))}static Log2(v){return Math.log(v)*Math.LOG2E}static Repeat(v,T){return v-Math.floor(v/T)*T}static Normalize(v,T,A){return(v-T)/(A-T)}static Denormalize(v,T,A){return v*(A-T)+T}static DeltaAngle(v,T){let A=Et.Repeat(T-v,360);return A>180&&(A-=360),A}static PingPong(v,T){const A=Et.Repeat(v,2*T);return T-Math.abs(A-T)}static SmoothStep(v,T,A){let C=Et.Clamp(A);return C=-2*C*C*C+3*C*C,T*C+v*(1-C)}static MoveTowards(v,T,A){let C=0;return C=Math.abs(T-v)<=A?T:v+Et.Sign(T-v)*A,C}static MoveTowardsAngle(v,T,A){const C=Et.DeltaAngle(v,T);let E=0;return E=-A<C&&C<A?T:Et.MoveTowards(v,v+C,A),E}static Lerp(v,T,A){return v+(T-v)*A}static LerpAngle(v,T,A){let C=Et.Repeat(T-v,360);return C>180&&(C-=360),v+C*Et.Clamp(A)}static InverseLerp(v,T,A){let C=0;return C=v!==T?Et.Clamp((A-v)/(T-v)):0,C}static Hermite(v,T,A,C,E){const R=E*E,O=E*R;return v*(2*O-3*R+1)+A*(-2*O+3*R)+T*(O-2*R+E)+C*(O-R)}static RandomRange(v,T){return v===T?v:Math.random()*(T-v)+v}static RangeToPercent(v,T,A){return(v-T)/(A-T)}static PercentToRange(v,T,A){return(A-T)*v+T}static NormalizeRadians(v){return v-Et.TwoPi*Math.floor((v+Math.PI)/Et.TwoPi)}}Vt.Scalar=Et,Et.TwoPi=2*Math.PI,Object.defineProperty(Ut,"__esModule",{value:!0}),Ut.Vector4=void 0;const Ht=Nt,Wt=Vt,qt=Ft;class Mt{constructor(v,T,A,C){this.x=v,this.y=T,this.z=A,this.w=C}static Add(v,T){return new Mt(v.x,v.y,v.z,v.w).addInPlace(T)}static FromArray(v,T=0){return new Mt(v[T],v[T+1],v[T+2],v[T+3])}static FromArrayToRef(v,T,A){A.x=v[T],A.y=v[T+1],A.z=v[T+2],A.w=v[T+3]}static FromFloatArrayToRef(v,T,A){Mt.FromArrayToRef(v,T,A)}static FromFloatsToRef(v,T,A,C,E){E.x=v,E.y=T,E.z=A,E.w=C}static Zero(){return new Mt(0,0,0,0)}static One(){return new Mt(1,1,1,1)}static Normalize(v){const T=Mt.Zero();return Mt.NormalizeToRef(v,T),T}static NormalizeToRef(v,T){T.copyFrom(v),T.normalize()}static Minimize(v,T){const A=new Mt(v.x,v.y,v.z,v.w);return A.minimizeInPlace(T),A}static Maximize(v,T){const A=new Mt(v.x,v.y,v.z,v.w);return A.maximizeInPlace(T),A}static Distance(v,T){return Math.sqrt(Mt.DistanceSquared(v,T))}static DistanceSquared(v,T){const A=v.x-T.x,C=v.y-T.y,E=v.z-T.z,R=v.w-T.w;return A*A+C*C+E*E+R*R}static Center(v,T){const A=Mt.Add(v,T);return A.scaleInPlace(.5),A}static TransformNormal(v,T){const A=Mt.Zero();return Mt.TransformNormalToRef(v,T,A),A}static TransformNormalToRef(v,T,A){const C=T.m,E=v.x*C[0]+v.y*C[4]+v.z*C[8],R=v.x*C[1]+v.y*C[5]+v.z*C[9],O=v.x*C[2]+v.y*C[6]+v.z*C[10];A.x=E,A.y=R,A.z=O,A.w=v.w}static TransformNormalFromFloatsToRef(v,T,A,C,E,R){const O=E.m;R.x=v*O[0]+T*O[4]+A*O[8],R.y=v*O[1]+T*O[5]+A*O[9],R.z=v*O[2]+T*O[6]+A*O[10],R.w=C}toString(){return"{X: "+this.x+" Y:"+this.y+" Z:"+this.z+" W:"+this.w+"}"}getClassName(){return"Vector4"}getHashCode(){let v=this.x||0;return v=397*v^(this.y||0),v=397*v^(this.z||0),v=397*v^(this.w||0),v}asArray(){const v=new Array;return this.toArray(v,0),v}toArray(v,T=0){return v[T]=this.x,v[T+1]=this.y,v[T+2]=this.z,v[T+3]=this.w,this}addInPlace(v){return this.x+=v.x,this.y+=v.y,this.z+=v.z,this.w+=v.w,this}add(v){return new Mt(this.x+v.x,this.y+v.y,this.z+v.z,this.w+v.w)}addToRef(v,T){return T.x=this.x+v.x,T.y=this.y+v.y,T.z=this.z+v.z,T.w=this.w+v.w,this}subtractInPlace(v){return this.x-=v.x,this.y-=v.y,this.z-=v.z,this.w-=v.w,this}subtract(v){return new Mt(this.x-v.x,this.y-v.y,this.z-v.z,this.w-v.w)}subtractToRef(v,T){return T.x=this.x-v.x,T.y=this.y-v.y,T.z=this.z-v.z,T.w=this.w-v.w,this}subtractFromFloats(v,T,A,C){return new Mt(this.x-v,this.y-T,this.z-A,this.w-C)}subtractFromFloatsToRef(v,T,A,C,E){return E.x=this.x-v,E.y=this.y-T,E.z=this.z-A,E.w=this.w-C,this}negate(){return new Mt(-this.x,-this.y,-this.z,-this.w)}scaleInPlace(v){return this.x*=v,this.y*=v,this.z*=v,this.w*=v,this}scale(v){return new Mt(this.x*v,this.y*v,this.z*v,this.w*v)}scaleToRef(v,T){return T.x=this.x*v,T.y=this.y*v,T.z=this.z*v,T.w=this.w*v,this}scaleAndAddToRef(v,T){return T.x+=this.x*v,T.y+=this.y*v,T.z+=this.z*v,T.w+=this.w*v,this}equals(v){return v&&this.x===v.x&&this.y===v.y&&this.z===v.z&&this.w===v.w}equalsWithEpsilon(v,T=Ht.Epsilon){return v&&Wt.Scalar.WithinEpsilon(this.x,v.x,T)&&Wt.Scalar.WithinEpsilon(this.y,v.y,T)&&Wt.Scalar.WithinEpsilon(this.z,v.z,T)&&Wt.Scalar.WithinEpsilon(this.w,v.w,T)}equalsToFloats(v,T,A,C){return this.x===v&&this.y===T&&this.z===A&&this.w===C}multiplyInPlace(v){return this.x*=v.x,this.y*=v.y,this.z*=v.z,this.w*=v.w,this}multiply(v){return new Mt(this.x*v.x,this.y*v.y,this.z*v.z,this.w*v.w)}multiplyToRef(v,T){return T.x=this.x*v.x,T.y=this.y*v.y,T.z=this.z*v.z,T.w=this.w*v.w,this}multiplyByFloats(v,T,A,C){return new Mt(this.x*v,this.y*T,this.z*A,this.w*C)}divide(v){return new Mt(this.x/v.x,this.y/v.y,this.z/v.z,this.w/v.w)}divideToRef(v,T){return T.x=this.x/v.x,T.y=this.y/v.y,T.z=this.z/v.z,T.w=this.w/v.w,this}divideInPlace(v){return this.divideToRef(v,this)}minimizeInPlace(v){return v.x<this.x&&(this.x=v.x),v.y<this.y&&(this.y=v.y),v.z<this.z&&(this.z=v.z),v.w<this.w&&(this.w=v.w),this}maximizeInPlace(v){return v.x>this.x&&(this.x=v.x),v.y>this.y&&(this.y=v.y),v.z>this.z&&(this.z=v.z),v.w>this.w&&(this.w=v.w),this}floor(){return new Mt(Math.floor(this.x),Math.floor(this.y),Math.floor(this.z),Math.floor(this.w))}fract(){return new Mt(this.x-Math.floor(this.x),this.y-Math.floor(this.y),this.z-Math.floor(this.z),this.w-Math.floor(this.w))}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}lengthSquared(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}normalize(){const v=this.length();return 0===v?this:this.scaleInPlace(1/v)}toVector3(){return new qt.Vector3(this.x,this.y,this.z)}clone(){return new Mt(this.x,this.y,this.z,this.w)}copyFrom(v){return this.x=v.x,this.y=v.y,this.z=v.z,this.w=v.w,this}copyFromFloats(v,T,A,C){return this.x=v,this.y=T,this.z=A,this.w=C,this}set(v,T,A,C){return this.copyFromFloats(v,T,A,C)}setAll(v){return this.x=this.y=this.z=this.w=v,this}}Ut.Vector4=Mt,Object.defineProperty(kt,"__esModule",{value:!0}),kt.Matrix=void 0;const Gt=Ft,Yt=Bt,Qt=zt,Kt=Ut;class Dt{constructor(){this._isIdentity=!1,this._isIdentityDirty=!0,this._isIdentity3x2=!0,this._isIdentity3x2Dirty=!0,this._m=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this._updateIdentityStatus(!1)}get m(){return this._m}static get IdentityReadOnly(){return Dt._identityReadOnly}static FromArray(v,T=0){const A=new Dt;return Dt.FromArrayToRef(v,T,A),A}static FromArrayToRef(v,T,A){for(let C=0;C<16;C++)A._m[C]=v[C+T];A._markAsUpdated()}static FromFloatArrayToRefScaled(v,T,A,C){for(let E=0;E<16;E++)C._m[E]=v[E+T]*A;C._markAsUpdated()}static FromValuesToRef(v,T,A,C,E,R,O,z,M,V,H,W,j,X,K,Z,J){const $=J._m;$[0]=v,$[1]=T,$[2]=A,$[3]=C,$[4]=E,$[5]=R,$[6]=O,$[7]=z,$[8]=M,$[9]=V,$[10]=H,$[11]=W,$[12]=j,$[13]=X,$[14]=K,$[15]=Z,J._markAsUpdated()}static FromValues(v,T,A,C,E,R,O,z,M,V,H,W,j,X,K,Z){const J=new Dt,$=J._m;return $[0]=v,$[1]=T,$[2]=A,$[3]=C,$[4]=E,$[5]=R,$[6]=O,$[7]=z,$[8]=M,$[9]=V,$[10]=H,$[11]=W,$[12]=j,$[13]=X,$[14]=K,$[15]=Z,J._markAsUpdated(),J}static Compose(v,T,A){const C=new Dt;return Dt.ComposeToRef(v,T,A,C),C}static ComposeToRef(v,T,A,C){Dt.ScalingToRef(v.x,v.y,v.z,Qt.MathTmp.Matrix[1]),T.toRotationMatrix(Qt.MathTmp.Matrix[0]),Qt.MathTmp.Matrix[1].multiplyToRef(Qt.MathTmp.Matrix[0],C),C.setTranslation(A)}static Identity(){const v=Dt.FromValues(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return v._updateIdentityStatus(!0),v}static IdentityToRef(v){Dt.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,v),v._updateIdentityStatus(!0)}static Zero(){const v=Dt.FromValues(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);return v._updateIdentityStatus(!1),v}static RotationX(v){const T=new Dt;return Dt.RotationXToRef(v,T),T}static Invert(v){const T=new Dt;return v.invertToRef(T),T}static RotationXToRef(v,T){const A=Math.sin(v),C=Math.cos(v);Dt.FromValuesToRef(1,0,0,0,0,C,A,0,0,-A,C,0,0,0,0,1,T),T._updateIdentityStatus(1===C&&0===A)}static RotationY(v){const T=new Dt;return Dt.RotationYToRef(v,T),T}static RotationYToRef(v,T){const A=Math.sin(v),C=Math.cos(v);Dt.FromValuesToRef(C,0,-A,0,0,1,0,0,A,0,C,0,0,0,0,1,T),T._updateIdentityStatus(1===C&&0===A)}static RotationZ(v){const T=new Dt;return Dt.RotationZToRef(v,T),T}static RotationZToRef(v,T){const A=Math.sin(v),C=Math.cos(v);Dt.FromValuesToRef(C,A,0,0,-A,C,0,0,0,0,1,0,0,0,0,1,T),T._updateIdentityStatus(1===C&&0===A)}static RotationAxis(v,T){const A=new Dt;return Dt.RotationAxisToRef(v,T,A),A}static RotationAxisToRef(v,T,A){const C=Math.sin(-T),E=Math.cos(-T),R=1-E;v.normalize();const O=A._m;O[0]=v.x*v.x*R+E,O[1]=v.x*v.y*R-v.z*C,O[2]=v.x*v.z*R+v.y*C,O[3]=0,O[4]=v.y*v.x*R+v.z*C,O[5]=v.y*v.y*R+E,O[6]=v.y*v.z*R-v.x*C,O[7]=0,O[8]=v.z*v.x*R-v.y*C,O[9]=v.z*v.y*R+v.x*C,O[10]=v.z*v.z*R+E,O[11]=0,O[12]=0,O[13]=0,O[14]=0,O[15]=1,A._markAsUpdated()}static RotationYawPitchRoll(v,T,A){const C=new Dt;return Dt.RotationYawPitchRollToRef(v,T,A,C),C}static RotationYawPitchRollToRef(v,T,A,C){Yt.Quaternion.RotationYawPitchRollToRef(v,T,A,Qt.MathTmp.Quaternion[0]),Qt.MathTmp.Quaternion[0].toRotationMatrix(C)}static Scaling(v,T,A){const C=new Dt;return Dt.ScalingToRef(v,T,A,C),C}static ScalingToRef(v,T,A,C){Dt.FromValuesToRef(v,0,0,0,0,T,0,0,0,0,A,0,0,0,0,1,C),C._updateIdentityStatus(1===v&&1===T&&1===A)}static Translation(v,T,A){const C=new Dt;return Dt.TranslationToRef(v,T,A,C),C}static TranslationToRef(v,T,A,C){Dt.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,v,T,A,1,C),C._updateIdentityStatus(0===v&&0===T&&0===A)}static Lerp(v,T,A){const C=new Dt;return Dt.LerpToRef(v,T,A,C),C}static LerpToRef(v,T,A,C){for(let E=0;E<16;E++)C._m[E]=v._m[E]*(1-A)+T._m[E]*A;C._markAsUpdated()}static DecomposeLerp(v,T,A){const C=new Dt;return Dt.DecomposeLerpToRef(v,T,A,C),C}static DecomposeLerpToRef(v,T,A,C){const E=Qt.MathTmp.Vector3[0],R=Qt.MathTmp.Quaternion[0],O=Qt.MathTmp.Vector3[1];v.decompose(E,R,O);const z=Qt.MathTmp.Vector3[2],M=Qt.MathTmp.Quaternion[1],V=Qt.MathTmp.Vector3[3];T.decompose(z,M,V);const H=Qt.MathTmp.Vector3[4];Gt.Vector3.LerpToRef(E,z,A,H);const W=Qt.MathTmp.Quaternion[2];Yt.Quaternion.SlerpToRef(R,M,A,W);const j=Qt.MathTmp.Vector3[5];Gt.Vector3.LerpToRef(O,V,A,j),Dt.ComposeToRef(H,W,j,C)}static LookAtLH(v,T,A){const C=new Dt;return Dt.LookAtLHToRef(v,T,A,C),C}static LookAtLHToRef(v,T,A,C){const E=Qt.MathTmp.Vector3[0],R=Qt.MathTmp.Vector3[1],O=Qt.MathTmp.Vector3[2];T.subtractToRef(v,O),O.normalize(),Gt.Vector3.CrossToRef(A,O,E);const z=E.lengthSquared();0===z?E.x=1:E.normalizeFromLength(Math.sqrt(z)),Gt.Vector3.CrossToRef(O,E,R),R.normalize();const M=-Gt.Vector3.Dot(E,v),V=-Gt.Vector3.Dot(R,v),H=-Gt.Vector3.Dot(O,v);Dt.FromValuesToRef(E.x,R.x,O.x,0,E.y,R.y,O.y,0,E.z,R.z,O.z,0,M,V,H,1,C)}static LookAtRH(v,T,A){const C=new Dt;return Dt.LookAtRHToRef(v,T,A,C),C}static LookAtRHToRef(v,T,A,C){const E=Qt.MathTmp.Vector3[0],R=Qt.MathTmp.Vector3[1],O=Qt.MathTmp.Vector3[2];v.subtractToRef(T,O),O.normalize(),Gt.Vector3.CrossToRef(A,O,E);const z=E.lengthSquared();0===z?E.x=1:E.normalizeFromLength(Math.sqrt(z)),Gt.Vector3.CrossToRef(O,E,R),R.normalize();const M=-Gt.Vector3.Dot(E,v),V=-Gt.Vector3.Dot(R,v),H=-Gt.Vector3.Dot(O,v);Dt.FromValuesToRef(E.x,R.x,O.x,0,E.y,R.y,O.y,0,E.z,R.z,O.z,0,M,V,H,1,C)}static OrthoLH(v,T,A,C){const E=new Dt;return Dt.OrthoLHToRef(v,T,A,C,E),E}static OrthoLHToRef(v,T,A,C,E){const R=2/v,O=2/T,z=2/(C-A),M=-(C+A)/(C-A);Dt.FromValuesToRef(R,0,0,0,0,O,0,0,0,0,z,0,0,0,M,1,E),E._updateIdentityStatus(1===R&&1===O&&1===z&&0===M)}static OrthoOffCenterLH(v,T,A,C,E,R){const O=new Dt;return Dt.OrthoOffCenterLHToRef(v,T,A,C,E,R,O),O}static OrthoOffCenterLHToRef(v,T,A,C,E,R,O){const z=2/(T-v),M=2/(C-A),V=2/(R-E),H=-(R+E)/(R-E),W=(v+T)/(v-T),j=(C+A)/(A-C);Dt.FromValuesToRef(z,0,0,0,0,M,0,0,0,0,V,0,W,j,H,1,O),O._markAsUpdated()}static OrthoOffCenterRH(v,T,A,C,E,R){const O=new Dt;return Dt.OrthoOffCenterRHToRef(v,T,A,C,E,R,O),O}static OrthoOffCenterRHToRef(v,T,A,C,E,R,O){Dt.OrthoOffCenterLHToRef(v,T,A,C,E,R,O),O._m[10]*=-1}static PerspectiveLH(v,T,A,C){const E=new Dt,R=2*A/v,O=2*A/T,z=(C+A)/(C-A),M=-2*C*A/(C-A);return Dt.FromValuesToRef(R,0,0,0,0,O,0,0,0,0,z,1,0,0,M,0,E),E._updateIdentityStatus(!1),E}static PerspectiveFovLH(v,T,A,C){const E=new Dt;return Dt.PerspectiveFovLHToRef(v,T,A,C,E),E}static PerspectiveFovLHToRef(v,T,A,C,E,R=!0){const O=A,z=C,M=1/Math.tan(.5*v),V=R?M/T:M,H=R?M:M*T,W=(z+O)/(z-O),j=-2*z*O/(z-O);Dt.FromValuesToRef(V,0,0,0,0,H,0,0,0,0,W,1,0,0,j,0,E),E._updateIdentityStatus(!1)}static PerspectiveFovRH(v,T,A,C){const E=new Dt;return Dt.PerspectiveFovRHToRef(v,T,A,C,E),E}static PerspectiveFovRHToRef(v,T,A,C,E,R=!0){const O=A,z=C,M=1/Math.tan(.5*v),V=R?M/T:M,H=R?M:M*T,W=-(z+O)/(z-O),j=-2*z*O/(z-O);Dt.FromValuesToRef(V,0,0,0,0,H,0,0,0,0,W,-1,0,0,j,0,E),E._updateIdentityStatus(!1)}static PerspectiveFovWebVRToRef(v,T,A,C,E=!1){const R=E?-1:1,O=Math.tan(v.upDegrees*Math.PI/180),z=Math.tan(v.downDegrees*Math.PI/180),M=Math.tan(v.leftDegrees*Math.PI/180),V=Math.tan(v.rightDegrees*Math.PI/180),H=2/(M+V),W=2/(O+z),j=C._m;j[0]=H,j[1]=j[2]=j[3]=j[4]=0,j[5]=W,j[6]=j[7]=0,j[8]=(M-V)*H*.5,j[9]=-(O-z)*W*.5,j[10]=-A/(T-A),j[11]=1*R,j[12]=j[13]=j[15]=0,j[14]=-2*A*T/(A-T),C._markAsUpdated()}static GetAsMatrix2x2(v){return[v._m[0],v._m[1],v._m[4],v._m[5]]}static GetAsMatrix3x3(v){return[v._m[0],v._m[1],v._m[2],v._m[4],v._m[5],v._m[6],v._m[8],v._m[9],v._m[10]]}static Transpose(v){const T=new Dt;return Dt.TransposeToRef(v,T),T}static TransposeToRef(v,T){const A=T._m,C=v._m;A[0]=C[0],A[1]=C[4],A[2]=C[8],A[3]=C[12],A[4]=C[1],A[5]=C[5],A[6]=C[9],A[7]=C[13],A[8]=C[2],A[9]=C[6],A[10]=C[10],A[11]=C[14],A[12]=C[3],A[13]=C[7],A[14]=C[11],A[15]=C[15],T._updateIdentityStatus(v._isIdentity,v._isIdentityDirty)}static Reflection(v){const T=new Dt;return Dt.ReflectionToRef(v,T),T}static ReflectionToRef(v,T){v.normalize();const A=v.normal.x,C=v.normal.y,E=v.normal.z,R=-2*A,O=-2*C,z=-2*E;Dt.FromValuesToRef(R*A+1,O*A,z*A,0,R*C,O*C+1,z*C,0,R*E,O*E,z*E+1,0,R*v.d,O*v.d,z*v.d,1,T)}static FromXYZAxesToRef(v,T,A,C){Dt.FromValuesToRef(v.x,v.y,v.z,0,T.x,T.y,T.z,0,A.x,A.y,A.z,0,0,0,0,1,C)}static FromQuaternionToRef(v,T){const A=v.x*v.x,C=v.y*v.y,E=v.z*v.z,R=v.x*v.y,O=v.z*v.w,z=v.z*v.x,M=v.y*v.w,V=v.y*v.z,H=v.x*v.w;T._m[0]=1-2*(C+E),T._m[1]=2*(R+O),T._m[2]=2*(z-M),T._m[3]=0,T._m[4]=2*(R-O),T._m[5]=1-2*(E+A),T._m[6]=2*(V+H),T._m[7]=0,T._m[8]=2*(z+M),T._m[9]=2*(V-H),T._m[10]=1-2*(C+A),T._m[11]=0,T._m[12]=0,T._m[13]=0,T._m[14]=0,T._m[15]=1,T._markAsUpdated()}_markAsUpdated(){this.updateFlag=Dt._updateFlagSeed++,this._isIdentity=!1,this._isIdentity3x2=!1,this._isIdentityDirty=!0,this._isIdentity3x2Dirty=!0}isIdentity(){if(this._isIdentityDirty){this._isIdentityDirty=!1;const v=this._m;this._isIdentity=1===v[0]&&0===v[1]&&0===v[2]&&0===v[3]&&0===v[4]&&1===v[5]&&0===v[6]&&0===v[7]&&0===v[8]&&0===v[9]&&1===v[10]&&0===v[11]&&0===v[12]&&0===v[13]&&0===v[14]&&1===v[15]}return this._isIdentity}isIdentityAs3x2(){return this._isIdentity3x2Dirty&&(this._isIdentity3x2Dirty=!1,1!==this._m[0]||1!==this._m[5]||1!==this._m[15]||0!==this._m[1]||0!==this._m[2]||0!==this._m[3]||0!==this._m[4]||0!==this._m[6]||0!==this._m[7]||0!==this._m[8]||0!==this._m[9]||0!==this._m[10]||0!==this._m[11]||0!==this._m[12]||0!==this._m[13]||0!==this._m[14]?this._isIdentity3x2=!1:this._isIdentity3x2=!0),this._isIdentity3x2}determinant(){if(!0===this._isIdentity)return 1;const v=this._m,T=v[0],A=v[1],C=v[2],E=v[3],R=v[4],O=v[5],z=v[6],M=v[7],V=v[8],H=v[9],W=v[10],j=v[11],X=v[12],K=v[13],Z=v[14],J=v[15],$=W*J-Z*j,et=H*J-K*j,nt=H*Z-K*W,it=V*J-X*j,ot=V*Z-W*X,rt=V*K-X*H;return T*+(O*$-z*et+M*nt)+A*-(R*$-z*it+M*ot)+C*+(R*et-O*it+M*rt)+E*-(R*nt-O*ot+z*rt)}toArray(){return this._m}asArray(){return this._m}invert(){return this.invertToRef(this),this}reset(){return Dt.FromValuesToRef(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,this),this._updateIdentityStatus(!1),this}add(v){const T=new Dt;return this.addToRef(v,T),T}addToRef(v,T){for(let A=0;A<16;A++)T._m[A]=this._m[A]+v._m[A];return T._markAsUpdated(),this}addToSelf(v){for(let T=0;T<16;T++)this._m[T]+=v._m[T];return this._markAsUpdated(),this}invertToRef(v){if(!0===this._isIdentity)return Dt.IdentityToRef(v),this;const T=this._m,A=T[0],C=T[1],E=T[2],R=T[3],O=T[4],z=T[5],M=T[6],V=T[7],H=T[8],W=T[9],j=T[10],X=T[11],K=T[12],Z=T[13],J=T[14],$=T[15],et=j*$-J*X,nt=W*$-Z*X,it=W*J-Z*j,ot=H*$-K*X,rt=H*J-j*K,st=H*Z-K*W,at=+(z*et-M*nt+V*it),ct=-(O*et-M*ot+V*rt),lt=+(O*nt-z*ot+V*st),ut=-(O*it-z*rt+M*st),ht=A*at+C*ct+E*lt+R*ut;if(0===ht)return v.copyFrom(this),this;const pt=1/ht,dt=M*$-J*V,ft=z*$-Z*V,yt=z*J-Z*M,gt=O*$-K*V,vt=O*J-K*M,bt=O*Z-K*z,Tt=M*X-j*V,wt=z*X-W*V,At=z*j-W*M,xt=O*X-H*V,St=O*j-H*M,_t=O*W-H*z,Ct=-(C*et-E*nt+R*it),It=+(A*et-E*ot+R*rt),Rt=-(A*nt-C*ot+R*st),Ot=+(A*it-C*rt+E*st),Pt=+(C*dt-E*ft+R*yt),Nt=-(A*dt-E*gt+R*vt),zt=+(A*ft-C*gt+R*bt),Lt=-(A*yt-C*vt+E*bt),Ft=-(C*Tt-E*wt+R*At),Bt=+(A*Tt-E*xt+R*St),kt=-(A*wt-C*xt+R*_t),Ut=+(A*At-C*St+E*_t);return Dt.FromValuesToRef(at*pt,Ct*pt,Pt*pt,Ft*pt,ct*pt,It*pt,Nt*pt,Bt*pt,lt*pt,Rt*pt,zt*pt,kt*pt,ut*pt,Ot*pt,Lt*pt,Ut*pt,v),this}addAtIndex(v,T){return this._m[v]+=T,this._markAsUpdated(),this}multiplyAtIndex(v,T){return this._m[v]*=T,this._markAsUpdated(),this}setTranslationFromFloats(v,T,A){return this._m[12]=v,this._m[13]=T,this._m[14]=A,this._markAsUpdated(),this}setTranslation(v){return this.setTranslationFromFloats(v.x,v.y,v.z)}getTranslation(){return new Gt.Vector3(this._m[12],this._m[13],this._m[14])}getTranslationToRef(v){return v.x=this._m[12],v.y=this._m[13],v.z=this._m[14],this}removeRotationAndScaling(){const v=this.m;return Dt.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,v[12],v[13],v[14],v[15],this),this._updateIdentityStatus(0===v[12]&&0===v[13]&&0===v[14]&&1===v[15]),this}multiply(v){const T=new Dt;return this.multiplyToRef(v,T),T}copyFrom(v){v.copyToArray(this._m);const T=v;return this._updateIdentityStatus(T._isIdentity,T._isIdentityDirty,T._isIdentity3x2,T._isIdentity3x2Dirty),this}copyToArray(v,T=0){for(let A=0;A<16;A++)v[T+A]=this._m[A];return this}multiplyToRef(v,T){return this._isIdentity?(T.copyFrom(v),this):v._isIdentity?(T.copyFrom(this),this):(this.multiplyToArray(v,T._m,0),T._markAsUpdated(),this)}multiplyToArray(v,T,A){const C=this._m,E=v.m,R=C[0],O=C[1],z=C[2],M=C[3],V=C[4],H=C[5],W=C[6],j=C[7],X=C[8],K=C[9],Z=C[10],J=C[11],$=C[12],et=C[13],nt=C[14],it=C[15],ot=E[0],rt=E[1],st=E[2],at=E[3],ct=E[4],lt=E[5],ut=E[6],ht=E[7],pt=E[8],dt=E[9],ft=E[10],yt=E[11],gt=E[12],vt=E[13],bt=E[14],Tt=E[15];return T[A]=R*ot+O*ct+z*pt+M*gt,T[A+1]=R*rt+O*lt+z*dt+M*vt,T[A+2]=R*st+O*ut+z*ft+M*bt,T[A+3]=R*at+O*ht+z*yt+M*Tt,T[A+4]=V*ot+H*ct+W*pt+j*gt,T[A+5]=V*rt+H*lt+W*dt+j*vt,T[A+6]=V*st+H*ut+W*ft+j*bt,T[A+7]=V*at+H*ht+W*yt+j*Tt,T[A+8]=X*ot+K*ct+Z*pt+J*gt,T[A+9]=X*rt+K*lt+Z*dt+J*vt,T[A+10]=X*st+K*ut+Z*ft+J*bt,T[A+11]=X*at+K*ht+Z*yt+J*Tt,T[A+12]=$*ot+et*ct+nt*pt+it*gt,T[A+13]=$*rt+et*lt+nt*dt+it*vt,T[A+14]=$*st+et*ut+nt*ft+it*bt,T[A+15]=$*at+et*ht+nt*yt+it*Tt,this}equals(v){const T=v;if(!T)return!1;if((this._isIdentity||T._isIdentity)&&!this._isIdentityDirty&&!T._isIdentityDirty)return this._isIdentity&&T._isIdentity;const A=this.m,C=T.m;return A[0]===C[0]&&A[1]===C[1]&&A[2]===C[2]&&A[3]===C[3]&&A[4]===C[4]&&A[5]===C[5]&&A[6]===C[6]&&A[7]===C[7]&&A[8]===C[8]&&A[9]===C[9]&&A[10]===C[10]&&A[11]===C[11]&&A[12]===C[12]&&A[13]===C[13]&&A[14]===C[14]&&A[15]===C[15]}clone(){const v=new Dt;return v.copyFrom(this),v}getClassName(){return"Matrix"}getHashCode(){let v=this._m[0]||0;for(let T=1;T<16;T++)v=397*v^(this._m[T]||0);return v}decompose(v,T,A){if(this._isIdentity)return A&&A.setAll(0),v&&v.setAll(1),T&&T.copyFromFloats(0,0,0,1),!0;const C=this._m;A&&A.copyFromFloats(C[12],C[13],C[14]);const E=v||Qt.MathTmp.Vector3[0];if(E.x=Math.sqrt(C[0]*C[0]+C[1]*C[1]+C[2]*C[2]),E.y=Math.sqrt(C[4]*C[4]+C[5]*C[5]+C[6]*C[6]),E.z=Math.sqrt(C[8]*C[8]+C[9]*C[9]+C[10]*C[10]),this.determinant()<=0&&(E.y*=-1),0===E.x||0===E.y||0===E.z)return T&&T.copyFromFloats(0,0,0,1),!1;if(T){const v=1/E.x,A=1/E.y,R=1/E.z;Dt.FromValuesToRef(C[0]*v,C[1]*v,C[2]*v,0,C[4]*A,C[5]*A,C[6]*A,0,C[8]*R,C[9]*R,C[10]*R,0,0,0,0,1,Qt.MathTmp.Matrix[0]),Yt.Quaternion.FromRotationMatrixToRef(Qt.MathTmp.Matrix[0],T)}return!0}getRow(v){if(v<0||v>3)return null;const T=4*v;return new Kt.Vector4(this._m[T+0],this._m[T+1],this._m[T+2],this._m[T+3])}setRow(v,T){return this.setRowFromFloats(v,T.x,T.y,T.z,T.w)}transpose(){return Dt.Transpose(this)}transposeToRef(v){return Dt.TransposeToRef(this,v),this}setRowFromFloats(v,T,A,C,E){if(v<0||v>3)return this;const R=4*v;return this._m[R+0]=T,this._m[R+1]=A,this._m[R+2]=C,this._m[R+3]=E,this._markAsUpdated(),this}scale(v){const T=new Dt;return this.scaleToRef(v,T),T}scaleToRef(v,T){for(let A=0;A<16;A++)T._m[A]=this._m[A]*v;return T._markAsUpdated(),this}scaleAndAddToRef(v,T){for(let A=0;A<16;A++)T._m[A]+=this._m[A]*v;return T._markAsUpdated(),this}toNormalMatrix(v){const T=Qt.MathTmp.Matrix[0];this.invertToRef(T),T.transposeToRef(v);const A=v._m;Dt.FromValuesToRef(A[0],A[1],A[2],0,A[4],A[5],A[6],0,A[8],A[9],A[10],0,0,0,0,1,v)}getRotationMatrix(){const v=new Dt;return this.getRotationMatrixToRef(v),v}getRotationMatrixToRef(v){const T=Qt.MathTmp.Vector3[0];if(!this.decompose(T))return Dt.IdentityToRef(v),this;const A=this._m,C=1/T.x,E=1/T.y,R=1/T.z;return Dt.FromValuesToRef(A[0]*C,A[1]*C,A[2]*C,0,A[4]*E,A[5]*E,A[6]*E,0,A[8]*R,A[9]*R,A[10]*R,0,0,0,0,1,v),this}toggleModelMatrixHandInPlace(){const v=this._m;v[2]*=-1,v[6]*=-1,v[8]*=-1,v[9]*=-1,v[14]*=-1,this._markAsUpdated()}toggleProjectionMatrixHandInPlace(){const v=this._m;v[8]*=-1,v[9]*=-1,v[10]*=-1,v[11]*=-1,this._markAsUpdated()}_updateIdentityStatus(v,T=!1,A=!1,C=!0){this.updateFlag=Dt._updateFlagSeed++,this._isIdentity=v,this._isIdentity3x2=v||A,this._isIdentityDirty=!this._isIdentity&&T,this._isIdentity3x2Dirty=!this._isIdentity3x2&&C}}kt.Matrix=Dt,Dt._updateFlagSeed=0,Dt._identityReadOnly=Dt.Identity(),Object.defineProperty(Bt,"__esModule",{value:!0}),Bt.Quaternion=void 0;const Zt=kt,Jt=Ft,$t=zt,ee=Nt,ne=Vt;class jt{constructor(v=0,T=0,A=0,C=1){this.x=v,this.y=T,this.z=A,this.w=C}static FromRotationMatrix(v){const T=new jt;return jt.FromRotationMatrixToRef(v,T),T}static FromRotationMatrixToRef(v,T){const A=v.m,C=A[0],E=A[4],R=A[8],O=A[1],z=A[5],M=A[9],V=A[2],H=A[6],W=A[10],j=C+z+W;let X;j>0?(X=.5/Math.sqrt(j+1),T.w=.25/X,T.x=(H-M)*X,T.y=(R-V)*X,T.z=(O-E)*X):C>z&&C>W?(X=2*Math.sqrt(1+C-z-W),T.w=(H-M)/X,T.x=.25*X,T.y=(E+O)/X,T.z=(R+V)/X):z>W?(X=2*Math.sqrt(1+z-C-W),T.w=(R-V)/X,T.x=(E+O)/X,T.y=.25*X,T.z=(M+H)/X):(X=2*Math.sqrt(1+W-C-z),T.w=(O-E)/X,T.x=(R+V)/X,T.y=(M+H)/X,T.z=.25*X)}static Dot(v,T){return v.x*T.x+v.y*T.y+v.z*T.z+v.w*T.w}static AreClose(v,T){return jt.Dot(v,T)>=0}static Zero(){return new jt(0,0,0,0)}static Inverse(v){return new jt(-v.x,-v.y,-v.z,v.w)}static IsIdentity(v){return v&&0===v.x&&0===v.y&&0===v.z&&1===v.w}static RotationAxis(v,T){const A=T*ee.DEG2RAD;return jt.RotationAxisToRef(v,A,new jt)}static RotationAxisToRef(v,T,A){const C=T*ee.DEG2RAD,E=Math.sin(C/2);return v.normalize(),A.w=Math.cos(C/2),A.x=v.x*E,A.y=v.y*E,A.z=v.z*E,A}static FromArray(v,T=0){return new jt(v[T],v[T+1],v[T+2],v[T+3])}static FromEulerAnglesRef(v,T,A,C){return jt.RotationYawPitchRollToRef(T*ee.DEG2RAD,v*ee.DEG2RAD,A*ee.DEG2RAD,C)}static RotationYawPitchRoll(v,T,A){const C=new jt;return jt.RotationYawPitchRollToRef(v,T,A,C),C}static RotationYawPitchRollToRef(v,T,A,C){const E=.5*T,R=.5*v,O=.5*A,z=Math.cos(E),M=Math.cos(R),V=Math.cos(O),H=Math.sin(E),W=Math.sin(R),j=Math.sin(O);C.x=M*H*V+W*z*j,C.y=W*z*V-M*H*j,C.z=M*z*j-W*H*V,C.w=M*z*V+W*H*j}static RotationAlphaBetaGamma(v,T,A){const C=new jt;return jt.RotationAlphaBetaGammaToRef(v,T,A,C),C}static RotationAlphaBetaGammaToRef(v,T,A,C){const E=.5*(A+v),R=.5*(A-v),O=.5*T;C.x=Math.cos(R)*Math.sin(O),C.y=Math.sin(R)*Math.sin(O),C.z=Math.sin(E)*Math.cos(O),C.w=Math.cos(E)*Math.cos(O)}static RotationQuaternionFromAxis(v,T,A){const C=new jt(0,0,0,0);return jt.RotationQuaternionFromAxisToRef(v,T,A,C),C}static RotationQuaternionFromAxisToRef(v,T,A,C){const E=$t.MathTmp.Matrix[0];Zt.Matrix.FromXYZAxesToRef(v.normalize(),T.normalize(),A.normalize(),E),jt.FromRotationMatrixToRef(E,C)}static Slerp(v,T,A){const C=jt.Identity;return jt.SlerpToRef(v,T,A,C),C}static SlerpToRef(v,T,A,C){let E,R,O=v.x*T.x+v.y*T.y+v.z*T.z+v.w*T.w,z=!1;if(O<0&&(z=!0,O=-O),O>.999999)R=1-A,E=z?-A:A;else{const v=Math.acos(O),T=1/Math.sin(v);R=Math.sin((1-A)*v)*T,E=z?-Math.sin(A*v)*T:Math.sin(A*v)*T}C.x=R*v.x+E*T.x,C.y=R*v.y+E*T.y,C.z=R*v.z+E*T.z,C.w=R*v.w+E*T.w}static Hermite(v,T,A,C,E){const R=E*E,O=E*R,z=2*O-3*R+1,M=-2*O+3*R,V=O-2*R+E,H=O-R,W=v.x*z+A.x*M+T.x*V+C.x*H,j=v.y*z+A.y*M+T.y*V+C.y*H,X=v.z*z+A.z*M+T.z*V+C.z*H,K=v.w*z+A.w*M+T.w*V+C.w*H;return new jt(W,j,X,K)}static get Identity(){return new jt(0,0,0,1)}static Angle(v,T){const A=jt.Dot(v,T);return 2*Math.acos(Math.min(Math.abs(A),1))*ee.RAD2DEG}static Euler(v,T,A){return jt.RotationYawPitchRoll(T*ee.DEG2RAD,v*ee.DEG2RAD,A*ee.DEG2RAD)}static LookRotation(v,T=$t.MathTmp.staticUp){const A=Jt.Vector3.Normalize(v),C=Jt.Vector3.Normalize(Jt.Vector3.Cross(T,A)),E=Jt.Vector3.Cross(A,C),R=C.x,O=C.y,z=C.z,M=E.x,V=E.y,H=E.z,W=A.x,j=A.y,X=A.z,K=R+V+X,Z=new jt;if(K>0){let v=Math.sqrt(K+1);return Z.w=.5*v,v=.5/v,Z.x=(H-j)*v,Z.y=(W-z)*v,Z.z=(O-M)*v,Z}if(R>=V&&R>=X){const v=Math.sqrt(1+R-V-X),T=.5/v;return Z.x=.5*v,Z.y=(O+M)*T,Z.z=(z+W)*T,Z.w=(H-j)*T,Z}if(V>X){const v=Math.sqrt(1+V-R-X),T=.5/v;return Z.x=(M+O)*T,Z.y=.5*v,Z.z=(j+H)*T,Z.w=(W-z)*T,Z}const J=Math.sqrt(1+X-R-V),$=.5/J;return Z.x=(W+z)*$,Z.y=(j+H)*$,Z.z=.5*J,Z.w=(O-M)*$,Z}static RotateTowards(v,T,A){const C=jt.Angle(v,T);if(0===C)return T;const E=Math.min(1,A/C);return jt.Slerp(v,T,E)}static FromToRotation(v,T,A=$t.MathTmp.staticUp){const C=v.normalize(),E=T.normalize(),R=Jt.Vector3.Cross(C,E),O=Math.sqrt(C.lengthSquared()*E.lengthSquared())+Jt.Vector3.Dot(C,E);return R.lengthSquared()<1e-4?Math.abs(O)<1e-4?new jt(A.x,A.y,A.z,0).normalized:jt.Identity:new jt(R.x,R.y,R.z,O).normalized}get normalized(){return this.normalize()}setFromToRotation(v,T,A=$t.MathTmp.staticUp){const C=jt.FromToRotation(v,T,A);this.x=C.x,this.y=C.y,this.z=C.z,this.w=C.w}set eulerAngles(v){this.setEuler(v.x,v.y,v.z)}get eulerAngles(){const v=new Jt.Vector3,T=this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w,A=this.x*this.w-this.y*this.z;return A>.4995*T?(v.x=Math.PI/2,v.y=2*Math.atan2(this.y,this.x),v.z=0):A<-.4995*T?(v.x=-Math.PI/2,v.y=-2*Math.atan2(this.y,this.x),v.z=0):(v.x=Math.asin(2*(this.w*this.x-this.y*this.z)),v.y=Math.atan2(2*this.w*this.y+2*this.z*this.x,1-2*(this.x*this.x+this.y*this.y)),v.z=Math.atan2(2*this.w*this.z+2*this.x*this.y,1-2*(this.z*this.z+this.x*this.x))),v.x*=ee.RAD2DEG,v.y*=ee.RAD2DEG,v.z*=ee.RAD2DEG,v.x=ne.Scalar.Repeat(v.x,360),v.y=ne.Scalar.Repeat(v.y,360),v.z=ne.Scalar.Repeat(v.z,360),v}toString(){return`(${this.x}, ${this.y}, ${this.z}, ${this.w})`}get length(){return Math.sqrt(this.lengthSquared)}get lengthSquared(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}getClassName(){return"Quaternion"}getHashCode(){let v=this.x||0;return v=397*v^(this.y||0),v=397*v^(this.z||0),v=397*v^(this.w||0),v}asArray(){return[this.x,this.y,this.z,this.w]}equals(v){return v&&this.x===v.x&&this.y===v.y&&this.z===v.z&&this.w===v.w}clone(){return new jt(this.x,this.y,this.z,this.w)}copyFrom(v){return this.x=v.x,this.y=v.y,this.z=v.z,this.w=v.w,this}copyFromFloats(v,T,A,C){return this.x=v,this.y=T,this.z=A,this.w=C,this}set(v,T,A,C){return this.copyFromFloats(v,T,A,C)}setEuler(v,T,A){return jt.RotationYawPitchRollToRef(T*ee.DEG2RAD,v*ee.DEG2RAD,A*ee.DEG2RAD,this),this}add(v){return new jt(this.x+v.x,this.y+v.y,this.z+v.z,this.w+v.w)}addInPlace(v){return this.x+=v.x,this.y+=v.y,this.z+=v.z,this.w+=v.w,this}subtract(v){return new jt(this.x-v.x,this.y-v.y,this.z-v.z,this.w-v.w)}scale(v){return new jt(this.x*v,this.y*v,this.z*v,this.w*v)}scaleToRef(v,T){return T.x=this.x*v,T.y=this.y*v,T.z=this.z*v,T.w=this.w*v,this}scaleInPlace(v){return this.x*=v,this.y*=v,this.z*=v,this.w*=v,this}scaleAndAddToRef(v,T){return T.x+=this.x*v,T.y+=this.y*v,T.z+=this.z*v,T.w+=this.w*v,this}multiply(v){const T=new jt(0,0,0,1);return this.multiplyToRef(v,T),T}multiplyToRef(v,T){const A=this.x*v.w+this.y*v.z-this.z*v.y+this.w*v.x,C=-this.x*v.z+this.y*v.w+this.z*v.x+this.w*v.y,E=this.x*v.y-this.y*v.x+this.z*v.w+this.w*v.z,R=-this.x*v.x-this.y*v.y-this.z*v.z+this.w*v.w;return T.copyFromFloats(A,C,E,R),this}multiplyInPlace(v){return this.multiplyToRef(v,this),this}conjugateToRef(v){return v.copyFromFloats(-this.x,-this.y,-this.z,this.w),this}conjugateInPlace(){return this.x*=-1,this.y*=-1,this.z*=-1,this}conjugate(){return new jt(-this.x,-this.y,-this.z,this.w)}normalize(){const v=1/this.length;return this.x*=v,this.y*=v,this.z*=v,this.w*=v,this}angleAxis(v,T){if(0===T.lengthSquared())return jt.Identity;const A=jt.Identity;let C=v*ee.DEG2RAD;C*=.5;let E=T.normalize();return E=T.scaleInPlace(Math.sin(C)),A.x=E.x,A.y=E.y,A.z=E.z,A.w=Math.cos(C),A.normalize()}toRotationMatrix(v){return Zt.Matrix.FromQuaternionToRef(this,v),this}fromRotationMatrix(v){return jt.FromRotationMatrixToRef(v,this),this}}Bt.Quaternion=jt,Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.Vector3=void 0;const ie=zt,oe=Nt,se=Bt,ae=Vt;class Xt{constructor(v=0,T=0,A=0){this.x=v,this.y=T,this.z=A}get isNonUniform(){const v=Math.abs(this.x),T=Math.abs(this.y);if(v!==T)return!0;const A=Math.abs(this.z);return v!==A||T!==A}static Add(v,T){return new Xt(v.x,v.y,v.z).addInPlace(T)}static GetClipFactor(v,T,A,C){const E=Xt.Dot(v,A)-C;return E/(E-(Xt.Dot(T,A)-C))}static GetAngleBetweenVectors(v,T,A){const C=v.normalizeToRef(ie.MathTmp.Vector3[1]),E=T.normalizeToRef(ie.MathTmp.Vector3[2]),R=Xt.Dot(C,E),O=ie.MathTmp.Vector3[3];return Xt.CrossToRef(C,E,O),Xt.Dot(O,A)>0?Math.acos(R):-Math.acos(R)}static FromArray(v,T=0){return new Xt(v[T],v[T+1],v[T+2])}static FromFloatArray(v,T){return Xt.FromArray(v,T)}static FromArrayToRef(v,T,A){A.x=v[T],A.y=v[T+1],A.z=v[T+2]}static FromFloatArrayToRef(v,T,A){return Xt.FromArrayToRef(v,T,A)}static FromFloatsToRef(v,T,A,C){C.copyFromFloats(v,T,A)}static Zero(){return new Xt(0,0,0)}static One(){return new Xt(1,1,1)}static Up(){return new Xt(0,1,0)}static Down(){return new Xt(0,-1,0)}static Forward(){return new Xt(0,0,1)}static Backward(){return new Xt(0,0,-1)}static Right(){return new Xt(1,0,0)}static Left(){return new Xt(-1,0,0)}static TransformCoordinates(v,T){const A=Xt.Zero();return Xt.TransformCoordinatesToRef(v,T,A),A}static TransformCoordinatesToRef(v,T,A){return Xt.TransformCoordinatesFromFloatsToRef(v.x,v.y,v.z,T,A)}static TransformCoordinatesFromFloatsToRef(v,T,A,C,E){const R=C.m,O=v*R[0]+T*R[4]+A*R[8]+R[12],z=v*R[1]+T*R[5]+A*R[9]+R[13],M=v*R[2]+T*R[6]+A*R[10]+R[14],V=1/(v*R[3]+T*R[7]+A*R[11]+R[15]);E.x=O*V,E.y=z*V,E.z=M*V}static TransformNormal(v,T){const A=Xt.Zero();return Xt.TransformNormalToRef(v,T,A),A}static TransformNormalToRef(v,T,A){this.TransformNormalFromFloatsToRef(v.x,v.y,v.z,T,A)}static TransformNormalFromFloatsToRef(v,T,A,C,E){const R=C.m;E.x=v*R[0]+T*R[4]+A*R[8],E.y=v*R[1]+T*R[5]+A*R[9],E.z=v*R[2]+T*R[6]+A*R[10]}static CatmullRom(v,T,A,C,E){const R=E*E,O=E*R,z=.5*(2*T.x+(-v.x+A.x)*E+(2*v.x-5*T.x+4*A.x-C.x)*R+(-v.x+3*T.x-3*A.x+C.x)*O),M=.5*(2*T.y+(-v.y+A.y)*E+(2*v.y-5*T.y+4*A.y-C.y)*R+(-v.y+3*T.y-3*A.y+C.y)*O),V=.5*(2*T.z+(-v.z+A.z)*E+(2*v.z-5*T.z+4*A.z-C.z)*R+(-v.z+3*T.z-3*A.z+C.z)*O);return new Xt(z,M,V)}static Clamp(v,T,A){const C=new Xt;return Xt.ClampToRef(v,T,A,C),C}static ClampToRef(v,T,A,C){let E=v.x;E=E>A.x?A.x:E,E=E<T.x?T.x:E;let R=v.y;R=R>A.y?A.y:R,R=R<T.y?T.y:R;let O=v.z;O=O>A.z?A.z:O,O=O<T.z?T.z:O,C.copyFromFloats(E,R,O)}static Hermite(v,T,A,C,E){const R=E*E,O=E*R,z=2*O-3*R+1,M=-2*O+3*R,V=O-2*R+E,H=O-R,W=v.x*z+A.x*M+T.x*V+C.x*H,j=v.y*z+A.y*M+T.y*V+C.y*H,X=v.z*z+A.z*M+T.z*V+C.z*H;return new Xt(W,j,X)}static Lerp(v,T,A){const C=new Xt(0,0,0);return Xt.LerpToRef(v,T,A,C),C}static LerpToRef(v,T,A,C){C.x=v.x+(T.x-v.x)*A,C.y=v.y+(T.y-v.y)*A,C.z=v.z+(T.z-v.z)*A}static Dot(v,T){return v.x*T.x+v.y*T.y+v.z*T.z}static Cross(v,T){const A=Xt.Zero();return Xt.CrossToRef(v,T,A),A}static CrossToRef(v,T,A){const C=v.y*T.z-v.z*T.y,E=v.z*T.x-v.x*T.z,R=v.x*T.y-v.y*T.x;A.copyFromFloats(C,E,R)}static Normalize(v){const T=Xt.Zero();return Xt.NormalizeToRef(v,T),T}static NormalizeToRef(v,T){v.normalizeToRef(T)}static Minimize(v,T){const A=new Xt(v.x,v.y,v.z);return A.minimizeInPlace(T),A}static Maximize(v,T){const A=new Xt(v.x,v.y,v.z);return A.maximizeInPlace(T),A}static Distance(v,T){return Math.sqrt(Xt.DistanceSquared(v,T))}static DistanceSquared(v,T){const A=v.x-T.x,C=v.y-T.y,E=v.z-T.z;return A*A+C*C+E*E}static Center(v,T){const A=Xt.Add(v,T);return A.scaleInPlace(.5),A}static RotationFromAxis(v,T,A){const C=Xt.Zero();return Xt.RotationFromAxisToRef(v,T,A,C),C}static RotationFromAxisToRef(v,T,A,C){const E=ie.MathTmp.Quaternion[0];se.Quaternion.RotationQuaternionFromAxisToRef(v,T,A,E),C.copyFrom(E.eulerAngles)}toString(){return`(${this.x}, ${this.y}, ${this.z})`}getClassName(){return"Vector3"}getHashCode(){let v=this.x||0;return v=397*v^(this.y||0),v=397*v^(this.z||0),v}asArray(){const v=[];return this.toArray(v,0),v}toArray(v,T=0){return v[T]=this.x,v[T+1]=this.y,v[T+2]=this.z,this}toQuaternion(){return se.Quaternion.Identity.setEuler(this.y,this.x,this.z)}addInPlace(v){return this.addInPlaceFromFloats(v.x,v.y,v.z)}addInPlaceFromFloats(v,T,A){return this.x+=v,this.y+=T,this.z+=A,this}add(v){return new Xt(this.x+v.x,this.y+v.y,this.z+v.z)}addToRef(v,T){return T.copyFromFloats(this.x+v.x,this.y+v.y,this.z+v.z)}subtractInPlace(v){return this.x-=v.x,this.y-=v.y,this.z-=v.z,this}subtract(v){return new Xt(this.x-v.x,this.y-v.y,this.z-v.z)}subtractToRef(v,T){return this.subtractFromFloatsToRef(v.x,v.y,v.z,T)}subtractFromFloats(v,T,A){return new Xt(this.x-v,this.y-T,this.z-A)}subtractFromFloatsToRef(v,T,A,C){return C.copyFromFloats(this.x-v,this.y-T,this.z-A)}applyMatrix4(v){this.applyMatrix4ToRef(v,this)}applyMatrix4ToRef(v,T){const{x:A,y:C,z:E}=this,{m:R}=v,O=1/(R[3]*A+R[7]*C+R[11]*E+R[15]);return T.x=(R[0]*A+R[4]*C+R[8]*E+R[12])*O,T.y=(R[1]*A+R[5]*C+R[9]*E+R[13])*O,T.z=(R[2]*A+R[6]*C+R[10]*E+R[14])*O,T}rotate(v){return this.rotateToRef(v,this)}rotateToRef(v,T){const{x:A,y:C,z:E}=this,{x:R,y:O,z:z,w:M}=v,V=M*A+O*E-z*C,H=M*C+z*A-R*E,W=M*E+R*C-O*A,j=-R*A-O*C-z*E;return T.x=V*M+j*-R+H*-z-W*-O,T.y=H*M+j*-O+W*-R-V*-z,T.z=W*M+j*-z+V*-O-H*-R,T}negate(){return new Xt(-this.x,-this.y,-this.z)}scaleInPlace(v){return this.x*=v,this.y*=v,this.z*=v,this}scale(v){return new Xt(this.x*v,this.y*v,this.z*v)}scaleToRef(v,T){return T.copyFromFloats(this.x*v,this.y*v,this.z*v)}scaleAndAddToRef(v,T){return T.addInPlaceFromFloats(this.x*v,this.y*v,this.z*v)}equals(v){return v&&this.x===v.x&&this.y===v.y&&this.z===v.z}equalsWithEpsilon(v,T=oe.Epsilon){return v&&ae.Scalar.WithinEpsilon(this.x,v.x,T)&&ae.Scalar.WithinEpsilon(this.y,v.y,T)&&ae.Scalar.WithinEpsilon(this.z,v.z,T)}equalsToFloats(v,T,A){return this.x===v&&this.y===T&&this.z===A}multiplyInPlace(v){return this.x*=v.x,this.y*=v.y,this.z*=v.z,this}multiply(v){return this.multiplyByFloats(v.x,v.y,v.z)}multiplyToRef(v,T){return T.copyFromFloats(this.x*v.x,this.y*v.y,this.z*v.z)}multiplyByFloats(v,T,A){return new Xt(this.x*v,this.y*T,this.z*A)}divide(v){return new Xt(this.x/v.x,this.y/v.y,this.z/v.z)}divideToRef(v,T){return T.copyFromFloats(this.x/v.x,this.y/v.y,this.z/v.z)}divideInPlace(v){return this.divideToRef(v,this)}minimizeInPlace(v){return this.minimizeInPlaceFromFloats(v.x,v.y,v.z)}maximizeInPlace(v){return this.maximizeInPlaceFromFloats(v.x,v.y,v.z)}minimizeInPlaceFromFloats(v,T,A){return v<this.x&&(this.x=v),T<this.y&&(this.y=T),A<this.z&&(this.z=A),this}maximizeInPlaceFromFloats(v,T,A){return v>this.x&&(this.x=v),T>this.y&&(this.y=T),A>this.z&&(this.z=A),this}floor(){return new Xt(Math.floor(this.x),Math.floor(this.y),Math.floor(this.z))}fract(){return new Xt(this.x-Math.floor(this.x),this.y-Math.floor(this.y),this.z-Math.floor(this.z))}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}lengthSquared(){return this.x*this.x+this.y*this.y+this.z*this.z}normalize(){return this.normalizeFromLength(this.length())}normalizeFromLength(v){return 0===v||1===v?this:this.scaleInPlace(1/v)}normalizeToNew(){const v=new Xt(0,0,0);return this.normalizeToRef(v),v}normalizeToRef(v){const T=this.length();return 0===T||1===T?v.copyFromFloats(this.x,this.y,this.z):this.scaleToRef(1/T,v)}clone(){return new Xt(this.x,this.y,this.z)}copyFrom(v){return this.copyFromFloats(v.x,v.y,v.z)}copyFromFloats(v,T,A){return this.x=v,this.y=T,this.z=A,this}set(v,T,A){return this.copyFromFloats(v,T,A)}setAll(v){return this.x=this.y=this.z=v,this}}Ft.Vector3=Xt,Object.defineProperty(zt,"__esModule",{value:!0}),zt.MathTmp=void 0;const ce=Lt,le=Ft,ue=Bt,he=kt;zt.MathTmp={Vector3:(0,ce.buildArray)(6,le.Vector3.Zero),Matrix:(0,ce.buildArray)(2,he.Matrix.Identity),Quaternion:(0,ce.buildArray)(3,ue.Quaternion.Zero),staticUp:le.Vector3.Up(),tmpMatrix:he.Matrix.Zero()};var de={};Object.defineProperty(de,"__esModule",{value:!0}),de.Angle=void 0;class te{constructor(v){this._radians=v,this._radians<0&&(this._radians+=2*Math.PI)}static BetweenTwoPoints(v,T){const A=T.subtract(v),C=Math.atan2(A.y,A.x);return new te(C)}static FromRadians(v){return new te(v)}static FromDegrees(v){return new te(v*Math.PI/180)}degrees(){return 180*this._radians/Math.PI}radians(){return this._radians}}de.Angle=te;var fe={},ye={};Object.defineProperty(ye,"__esModule",{value:!0}),ye.Vector2=void 0;const me=Nt,ve=Vt;class re{constructor(v=0,T=0){this.x=v,this.y=T}static Zero(){return new re(0,0)}static One(){return new re(1,1)}static Add(v,T){return new re(v.x,v.y).addInPlace(T)}static FromArray(v,T=0){return new re(v[T],v[T+1])}static FromArrayToRef(v,T,A){A.x=v[T],A.y=v[T+1]}static CatmullRom(v,T,A,C,E){const R=E*E,O=E*R,z=.5*(2*T.x+(-v.x+A.x)*E+(2*v.x-5*T.x+4*A.x-C.x)*R+(-v.x+3*T.x-3*A.x+C.x)*O),M=.5*(2*T.y+(-v.y+A.y)*E+(2*v.y-5*T.y+4*A.y-C.y)*R+(-v.y+3*T.y-3*A.y+C.y)*O);return new re(z,M)}static Clamp(v,T,A){let C=v.x;C=C>A.x?A.x:C,C=C<T.x?T.x:C;let E=v.y;return E=E>A.y?A.y:E,E=E<T.y?T.y:E,new re(C,E)}static Hermite(v,T,A,C,E){const R=E*E,O=E*R,z=2*O-3*R+1,M=-2*O+3*R,V=O-2*R+E,H=O-R,W=v.x*z+A.x*M+T.x*V+C.x*H,j=v.y*z+A.y*M+T.y*V+C.y*H;return new re(W,j)}static Lerp(v,T,A){const C=v.x+(T.x-v.x)*A,E=v.y+(T.y-v.y)*A;return new re(C,E)}static Dot(v,T){return v.x*T.x+v.y*T.y}static Normalize(v){const T=new re(v.x,v.y);return T.normalize(),T}static Minimize(v,T){const A=v.x<T.x?v.x:T.x,C=v.y<T.y?v.y:T.y;return new re(A,C)}static Maximize(v,T){const A=v.x>T.x?v.x:T.x,C=v.y>T.y?v.y:T.y;return new re(A,C)}static Transform(v,T){const A=re.Zero();return re.TransformToRef(v,T,A),A}static TransformToRef(v,T,A){const C=T.m,E=v.x*C[0]+v.y*C[4]+C[12],R=v.x*C[1]+v.y*C[5]+C[13];A.x=E,A.y=R}static PointInTriangle(v,T,A,C){const E=.5*(-A.y*C.x+T.y*(-A.x+C.x)+T.x*(A.y-C.y)+A.x*C.y),R=E<0?-1:1,O=(T.y*C.x-T.x*C.y+(C.y-T.y)*v.x+(T.x-C.x)*v.y)*R,z=(T.x*A.y-T.y*A.x+(T.y-A.y)*v.x+(A.x-T.x)*v.y)*R;return O>0&&z>0&&O+z<2*E*R}static Distance(v,T){return Math.sqrt(re.DistanceSquared(v,T))}static DistanceSquared(v,T){const A=v.x-T.x,C=v.y-T.y;return A*A+C*C}static Center(v,T){const A=re.Add(v,T);return A.scaleInPlace(.5),A}static DistanceOfPointFromSegment(v,T,A){const C=re.DistanceSquared(T,A);if(0===C)return re.Distance(v,T);const E=A.subtract(T),R=Math.max(0,Math.min(1,re.Dot(v.subtract(T),E)/C)),O=T.add(E.multiplyByFloats(R,R));return re.Distance(v,O)}toString(){return"{X: "+this.x+" Y:"+this.y+"}"}getClassName(){return"Vector2"}getHashCode(){let v=this.x||0;return v=397*v^(this.y||0),v}toArray(v,T=0){return v[T]=this.x,v[T+1]=this.y,this}asArray(){const v=new Array;return this.toArray(v,0),v}copyFrom(v){return this.x=v.x,this.y=v.y,this}copyFromFloats(v,T){return this.x=v,this.y=T,this}set(v,T){return this.copyFromFloats(v,T)}add(v){return new re(this.x+v.x,this.y+v.y)}addToRef(v,T){return T.x=this.x+v.x,T.y=this.y+v.y,this}addInPlace(v){return this.x+=v.x,this.y+=v.y,this}addVector3(v){return new re(this.x+v.x,this.y+v.y)}subtract(v){return new re(this.x-v.x,this.y-v.y)}subtractToRef(v,T){return T.x=this.x-v.x,T.y=this.y-v.y,this}subtractInPlace(v){return this.x-=v.x,this.y-=v.y,this}multiplyInPlace(v){return this.x*=v.x,this.y*=v.y,this}multiply(v){return new re(this.x*v.x,this.y*v.y)}multiplyToRef(v,T){return T.x=this.x*v.x,T.y=this.y*v.y,this}multiplyByFloats(v,T){return new re(this.x*v,this.y*T)}divide(v){return new re(this.x/v.x,this.y/v.y)}divideToRef(v,T){return T.x=this.x/v.x,T.y=this.y/v.y,this}divideInPlace(v){return this.divideToRef(v,this)}negate(){return new re(-this.x,-this.y)}scaleInPlace(v){return this.x*=v,this.y*=v,this}scale(v){const T=new re(0,0);return this.scaleToRef(v,T),T}scaleToRef(v,T){return T.x=this.x*v,T.y=this.y*v,this}scaleAndAddToRef(v,T){return T.x+=this.x*v,T.y+=this.y*v,this}equals(v){return v&&this.x===v.x&&this.y===v.y}equalsWithEpsilon(v,T=me.Epsilon){return v&&ve.Scalar.WithinEpsilon(this.x,v.x,T)&&ve.Scalar.WithinEpsilon(this.y,v.y,T)}floor(){return new re(Math.floor(this.x),Math.floor(this.y))}fract(){return new re(this.x-Math.floor(this.x),this.y-Math.floor(this.y))}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}lengthSquared(){return this.x*this.x+this.y*this.y}normalize(){const v=this.length();if(0===v)return this;const T=1/v;return this.x*=T,this.y*=T,this}clone(){return new re(this.x,this.y)}}ye.Vector2=re,Object.defineProperty(fe,"__esModule",{value:!0}),fe.Arc2=void 0;const be=de,Te=ye,we=Nt;fe.Arc2=class{constructor(v,T,A){this.startPoint=v,this.midPoint=T,this.endPoint=A;const C=Math.pow(T.x,2)+Math.pow(T.y,2),E=(Math.pow(v.x,2)+Math.pow(v.y,2)-C)/2,R=(C-Math.pow(A.x,2)-Math.pow(A.y,2))/2,O=(v.x-T.x)*(T.y-A.y)-(T.x-A.x)*(v.y-T.y);this.centerPoint=new Te.Vector2((E*(T.y-A.y)-R*(v.y-T.y))/O,((v.x-T.x)*R-(T.x-A.x)*E)/O),this.radius=this.centerPoint.subtract(this.startPoint).length(),this.startAngle=be.Angle.BetweenTwoPoints(this.centerPoint,this.startPoint);const z=this.startAngle.degrees();let M=be.Angle.BetweenTwoPoints(this.centerPoint,this.midPoint).degrees(),V=be.Angle.BetweenTwoPoints(this.centerPoint,this.endPoint).degrees();M-z>180&&(M-=360),M-z<-180&&(M+=360),V-M>180&&(V-=360),V-M<-180&&(V+=360),this.orientation=M-z<0?we.Orientation.CW:we.Orientation.CCW,this.angle=be.Angle.FromDegrees(this.orientation===we.Orientation.CW?z-V:V-z)}};var Se={};Object.defineProperty(Se,"__esModule",{value:!0}),Se.Axis=void 0;const _e=Ft;class pe{}Se.Axis=pe,pe.X=new _e.Vector3(1,0,0),pe.Y=new _e.Vector3(0,1,0),pe.Z=new _e.Vector3(0,0,1);var Ce={};Object.defineProperty(Ce,"__esModule",{value:!0}),Ce.BezierCurve=void 0,Ce.BezierCurve=class{static Interpolate(v,T,A,C,E){const R=1-3*C+3*T,O=3*C-6*T,z=3*T;let M=v;for(let T=0;T<5;T++){const T=M*M;M-=1/(3*R*T+2*O*M+z)*(R*(T*M)+O*T+z*M-v),M=Math.min(1,Math.max(0,M))}return 3*Math.pow(1-M,2)*M*A+3*(1-M)*Math.pow(M,2)*E+Math.pow(M,3)}};var Ee={},Ie={};Object.defineProperty(Ie,"__esModule",{value:!0}),Ie.Color4=void 0;const Re=Vt,Oe=Nt;class ge{constructor(v=0,T=0,A=0,C=1){this.r=v,this.g=T,this.b=A,this.a=C}static FromHexString(v){if("#"!==v.substring(0,1)||9!==v.length)return new ge(0,0,0,0);const T=parseInt(v.substring(1,3),16),A=parseInt(v.substring(3,5),16),C=parseInt(v.substring(5,7),16),E=parseInt(v.substring(7,9),16);return ge.FromInts(T,A,C,E)}static Lerp(v,T,A){const C=new ge(0,0,0,0);return ge.LerpToRef(v,T,A,C),C}static LerpToRef(v,T,A,C){C.r=v.r+(T.r-v.r)*A,C.g=v.g+(T.g-v.g)*A,C.b=v.b+(T.b-v.b)*A,C.a=v.a+(T.a-v.a)*A}static Red(){return new ge(1,0,0,1)}static Green(){return new ge(0,1,0,1)}static Blue(){return new ge(0,0,1,1)}static Black(){return new ge(0,0,0,1)}static White(){return new ge(1,1,1,1)}static Purple(){return new ge(.5,0,.5,1)}static Magenta(){return new ge(1,0,1,1)}static Yellow(){return new ge(1,1,0,1)}static Gray(){return new ge(.5,.5,.5,1)}static Teal(){return new ge(0,1,1,1)}static Clear(){return new ge(0,0,0,0)}static FromColor3(v,T=1){return new ge(v.r,v.g,v.b,T)}static FromArray(v,T=0){return new ge(v[T],v[T+1],v[T+2],v[T+3])}static FromInts(v,T,A,C){return new ge(v/255,T/255,A/255,C/255)}static CheckColors4(v,T){if(v.length===3*T){const T=[];for(let A=0;A<v.length;A+=3){const C=A/3*4;T[C]=v[A],T[C+1]=v[A+1],T[C+2]=v[A+2],T[C+3]=1}return T}return v}addInPlace(v){return this.r+=v.r,this.g+=v.g,this.b+=v.b,this.a+=v.a,this}asArray(){const v=new Array;return this.toArray(v,0),v}toArray(v,T=0){return v[T]=this.r,v[T+1]=this.g,v[T+2]=this.b,v[T+3]=this.a,this}add(v){return new ge(this.r+v.r,this.g+v.g,this.b+v.b,this.a+v.a)}subtract(v){return new ge(this.r-v.r,this.g-v.g,this.b-v.b,this.a-v.a)}subtractToRef(v,T){return T.r=this.r-v.r,T.g=this.g-v.g,T.b=this.b-v.b,T.a=this.a-v.a,this}scale(v){return new ge(this.r*v,this.g*v,this.b*v,this.a*v)}scaleToRef(v,T){return T.r=this.r*v,T.g=this.g*v,T.b=this.b*v,T.a=this.a*v,this}scaleAndAddToRef(v,T){return T.r+=this.r*v,T.g+=this.g*v,T.b+=this.b*v,T.a+=this.a*v,this}clampToRef(v=0,T=1,A){return A.r=Re.Scalar.Clamp(this.r,v,T),A.g=Re.Scalar.Clamp(this.g,v,T),A.b=Re.Scalar.Clamp(this.b,v,T),A.a=Re.Scalar.Clamp(this.a,v,T),this}multiply(v){return new ge(this.r*v.r,this.g*v.g,this.b*v.b,this.a*v.a)}multiplyToRef(v,T){return T.r=this.r*v.r,T.g=this.g*v.g,T.b=this.b*v.b,T.a=this.a*v.a,T}toString(){return"{R: "+this.r+" G:"+this.g+" B:"+this.b+" A:"+this.a+"}"}getClassName(){return"Color4"}getHashCode(){let v=this.r||0;return v=397*v^(this.g||0),v=397*v^(this.b||0),v=397*v^(this.a||0),v}clone(){return new ge(this.r,this.g,this.b,this.a)}copyFrom(v){return this.r=v.r,this.g=v.g,this.b=v.b,this.a=v.a,this}copyFromFloats(v,T,A,C){return this.r=v,this.g=T,this.b=A,this.a=C,this}set(v,T,A,C){return this.copyFromFloats(v,T,A,C)}toHexString(){const v=255*this.r|0,T=255*this.g|0,A=255*this.b|0,C=255*this.a|0;return"#"+Re.Scalar.ToHex(v)+Re.Scalar.ToHex(T)+Re.Scalar.ToHex(A)+Re.Scalar.ToHex(C)}toLinearSpace(){const v=new ge;return this.toLinearSpaceToRef(v),v}toLinearSpaceToRef(v){return v.r=Math.pow(this.r,Oe.ToLinearSpace),v.g=Math.pow(this.g,Oe.ToLinearSpace),v.b=Math.pow(this.b,Oe.ToLinearSpace),v.a=this.a,this}toGammaSpace(){const v=new ge;return this.toGammaSpaceToRef(v),v}toGammaSpaceToRef(v){return v.r=Math.pow(this.r,Oe.ToGammaSpace),v.g=Math.pow(this.g,Oe.ToGammaSpace),v.b=Math.pow(this.b,Oe.ToGammaSpace),v.a=this.a,this}}Ie.Color4=ge,Object.defineProperty(Ee,"__esModule",{value:!0}),Ee.Color3=void 0;const Pe=Nt,Ne=Ie,Le=Vt;class xe{constructor(v=0,T=0,A=0){this.r=v,this.g=T,this.b=A}static FromHexString(v){if("#"!==v.substring(0,1)||7!==v.length)return new xe(0,0,0);const T=parseInt(v.substring(1,3),16),A=parseInt(v.substring(3,5),16),C=parseInt(v.substring(5,7),16);return xe.FromInts(T,A,C)}static FromArray(v,T=0){return new xe(v[T],v[T+1],v[T+2])}static FromInts(v,T,A){return new xe(v/255,T/255,A/255)}static Lerp(v,T,A){const C=new xe(0,0,0);return xe.LerpToRef(v,T,A,C),C}static LerpToRef(v,T,A,C){C.r=v.r+(T.r-v.r)*A,C.g=v.g+(T.g-v.g)*A,C.b=v.b+(T.b-v.b)*A}static Red(){return new xe(1,0,0)}static Green(){return new xe(0,1,0)}static Blue(){return new xe(0,0,1)}static Black(){return new xe(0,0,0)}static White(){return new xe(1,1,1)}static Purple(){return new xe(.5,0,.5)}static Magenta(){return new xe(1,0,1)}static Yellow(){return new xe(1,1,0)}static Gray(){return new xe(.5,.5,.5)}static Teal(){return new xe(0,1,1)}static Random(){return new xe(Math.random(),Math.random(),Math.random())}toString(){return"{R: "+this.r+" G:"+this.g+" B:"+this.b+"}"}getClassName(){return"Color3"}getHashCode(){let v=this.r||0;return v=397*v^(this.g||0),v=397*v^(this.b||0),v}toArray(v,T=0){return v[T]=this.r,v[T+1]=this.g,v[T+2]=this.b,this}toColor4(v=1){return new Ne.Color4(this.r,this.g,this.b,v)}asArray(){const v=new Array;return this.toArray(v,0),v}toLuminance(){return.3*this.r+.59*this.g+.11*this.b}multiply(v){return new xe(this.r*v.r,this.g*v.g,this.b*v.b)}multiplyToRef(v,T){return T.r=this.r*v.r,T.g=this.g*v.g,T.b=this.b*v.b,this}equals(v){return v&&this.r===v.r&&this.g===v.g&&this.b===v.b}equalsFloats(v,T,A){return this.r===v&&this.g===T&&this.b===A}scale(v){return new xe(this.r*v,this.g*v,this.b*v)}scaleToRef(v,T){return T.r=this.r*v,T.g=this.g*v,T.b=this.b*v,this}scaleAndAddToRef(v,T){return T.r+=this.r*v,T.g+=this.g*v,T.b+=this.b*v,this}clampToRef(v=0,T=1,A){return A.r=Le.Scalar.Clamp(this.r,v,T),A.g=Le.Scalar.Clamp(this.g,v,T),A.b=Le.Scalar.Clamp(this.b,v,T),this}add(v){return new xe(this.r+v.r,this.g+v.g,this.b+v.b)}addToRef(v,T){return T.r=this.r+v.r,T.g=this.g+v.g,T.b=this.b+v.b,this}subtract(v){return new xe(this.r-v.r,this.g-v.g,this.b-v.b)}subtractToRef(v,T){return T.r=this.r-v.r,T.g=this.g-v.g,T.b=this.b-v.b,this}clone(){return new xe(this.r,this.g,this.b)}copyFrom(v){return this.r=v.r,this.g=v.g,this.b=v.b,this}copyFromFloats(v,T,A){return this.r=v,this.g=T,this.b=A,this}set(v,T,A){return this.copyFromFloats(v,T,A)}toHexString(){const v=255*this.r|0,T=255*this.g|0,A=255*this.b|0;return"#"+Le.Scalar.ToHex(v)+Le.Scalar.ToHex(T)+Le.Scalar.ToHex(A)}toLinearSpace(){const v=new xe;return this.toLinearSpaceToRef(v),v}toLinearSpaceToRef(v){return v.r=Math.pow(this.r,Pe.ToLinearSpace),v.g=Math.pow(this.g,Pe.ToLinearSpace),v.b=Math.pow(this.b,Pe.ToLinearSpace),this}toGammaSpace(){const v=new xe;return this.toGammaSpaceToRef(v),v}toGammaSpaceToRef(v){return v.r=Math.pow(this.r,Pe.ToGammaSpace),v.g=Math.pow(this.g,Pe.ToGammaSpace),v.b=Math.pow(this.b,Pe.ToGammaSpace),this}toJSON(){return{r:this.r,g:this.g,b:this.b}}}Ee.Color3=xe;var Fe={};Object.defineProperty(Fe,"__esModule",{value:!0}),Fe.Curve3=void 0;const Be=Ft;class Ae{constructor(v){this._length=0,this._points=v,this._length=this._computeLength(v)}static CreateQuadraticBezier(v,T,A,C){C=C>2?C:3;const E=new Array,r=(v,T,A,C)=>(1-v)*(1-v)*T+2*v*(1-v)*A+v*v*C;for(let R=0;R<=C;R++)E.push(new Be.Vector3(r(R/C,v.x,T.x,A.x),r(R/C,v.y,T.y,A.y),r(R/C,v.z,T.z,A.z)));return new Ae(E)}static CreateCubicBezier(v,T,A,C,E){E=E>3?E:4;const R=new Array,s=(v,T,A,C,E)=>(1-v)*(1-v)*(1-v)*T+3*v*(1-v)*(1-v)*A+3*v*v*(1-v)*C+v*v*v*E;for(let O=0;O<=E;O++)R.push(new Be.Vector3(s(O/E,v.x,T.x,A.x,C.x),s(O/E,v.y,T.y,A.y,C.y),s(O/E,v.z,T.z,A.z,C.z)));return new Ae(R)}static CreateHermiteSpline(v,T,A,C,E){const R=new Array,O=1/E;for(let z=0;z<=E;z++)R.push(Be.Vector3.Hermite(v,T,A,C,z*O));return new Ae(R)}static CreateCatmullRomSpline(v,T,A){const C=new Array,E=1/T;let R=0;if(A){const A=v.length;for(let O=0;O<A;O++){R=0;for(let z=0;z<T;z++)C.push(Be.Vector3.CatmullRom(v[O%A],v[(O+1)%A],v[(O+2)%A],v[(O+3)%A],R)),R+=E}C.push(C[0])}else{const A=new Array;A.push(v[0].clone()),Array.prototype.push.apply(A,v),A.push(v[v.length-1].clone());let O=0;for(O=0;O<A.length-3;O++){R=0;for(let v=0;v<T;v++)C.push(Be.Vector3.CatmullRom(A[O],A[O+1],A[O+2],A[O+3],R)),R+=E}O--,C.push(Be.Vector3.CatmullRom(A[O],A[O+1],A[O+2],A[O+3],R))}return new Ae(C)}getPoints(){return this._points}length(){return this._length}continue(v){const T=this._points[this._points.length-1],A=this._points.slice(),C=v.getPoints();for(let v=1;v<C.length;v++)A.push(C[v].subtract(C[0]).add(T));return new Ae(A)}_computeLength(v){let T=0;for(let A=1;A<v.length;A++)T+=v[A].subtract(v[A-1]).length();return T}}Fe.Curve3=Ae;var ke={},Ue={};Object.defineProperty(Ue,"__esModule",{value:!0}),Ue.Plane=void 0;const Ve=Ft,He=kt,We=zt;class ze{constructor(v,T,A,C){this.normal=new Ve.Vector3(v,T,A),this.d=C}static FromArray(v){return new ze(v[0],v[1],v[2],v[3])}static FromPoints(v,T,A){const C=new ze(0,0,0,0);return C.copyFromPoints(v,T,A),C}static FromPositionAndNormal(v,T){const A=new ze(0,0,0,0);return T.normalize(),A.normal=T,A.d=-(T.x*v.x+T.y*v.y+T.z*v.z),A}static SignedDistanceToPlaneFromPositionAndNormal(v,T,A){const C=-(T.x*v.x+T.y*v.y+T.z*v.z);return Ve.Vector3.Dot(A,T)+C}asArray(){return[this.normal.x,this.normal.y,this.normal.z,this.d]}clone(){return new ze(this.normal.x,this.normal.y,this.normal.z,this.d)}getClassName(){return"Plane"}getHashCode(){let v=this.normal.getHashCode();return v=397*v^(this.d||0),v}normalize(){const v=Math.sqrt(this.normal.x*this.normal.x+this.normal.y*this.normal.y+this.normal.z*this.normal.z);let T=0;return 0!==v&&(T=1/v),this.normal.x*=T,this.normal.y*=T,this.normal.z*=T,this.d*=T,this}transform(v){const T=We.MathTmp.Matrix[0];He.Matrix.TransposeToRef(v,T);const A=T.m,C=this.normal.x,E=this.normal.y,R=this.normal.z,O=this.d,z=C*A[0]+E*A[1]+R*A[2]+O*A[3],M=C*A[4]+E*A[5]+R*A[6]+O*A[7],V=C*A[8]+E*A[9]+R*A[10]+O*A[11],H=C*A[12]+E*A[13]+R*A[14]+O*A[15];return new ze(z,M,V,H)}dotCoordinate(v){return this.normal.x*v.x+this.normal.y*v.y+this.normal.z*v.z+this.d}copyFromPoints(v,T,A){const C=T.x-v.x,E=T.y-v.y,R=T.z-v.z,O=A.x-v.x,z=A.y-v.y,M=A.z-v.z,V=E*M-R*z,H=R*O-C*M,W=C*z-E*O,j=Math.sqrt(V*V+H*H+W*W);let X;return X=0!==j?1/j:0,this.normal.x=V*X,this.normal.y=H*X,this.normal.z=W*X,this.d=-(this.normal.x*v.x+this.normal.y*v.y+this.normal.z*v.z),this}isFrontFacingTo(v,T){return Ve.Vector3.Dot(this.normal,v)<=T}signedDistanceTo(v){return Ve.Vector3.Dot(v,this.normal)+this.d}}Ue.Plane=ze,Object.defineProperty(ke,"__esModule",{value:!0}),ke.Frustum=void 0;const qe=Ue;class Me{static GetPlanes(v){const T=[];for(let v=0;v<6;v++)T.push(new qe.Plane(0,0,0,0));return Me.GetPlanesToRef(v,T),T}static GetNearPlaneToRef(v,T){const A=v.m;T.normal.x=A[3]+A[2],T.normal.y=A[7]+A[6],T.normal.z=A[11]+A[10],T.d=A[15]+A[14],T.normalize()}static GetFarPlaneToRef(v,T){const A=v.m;T.normal.x=A[3]-A[2],T.normal.y=A[7]-A[6],T.normal.z=A[11]-A[10],T.d=A[15]-A[14],T.normalize()}static GetLeftPlaneToRef(v,T){const A=v.m;T.normal.x=A[3]+A[0],T.normal.y=A[7]+A[4],T.normal.z=A[11]+A[8],T.d=A[15]+A[12],T.normalize()}static GetRightPlaneToRef(v,T){const A=v.m;T.normal.x=A[3]-A[0],T.normal.y=A[7]-A[4],T.normal.z=A[11]-A[8],T.d=A[15]-A[12],T.normalize()}static GetTopPlaneToRef(v,T){const A=v.m;T.normal.x=A[3]-A[1],T.normal.y=A[7]-A[5],T.normal.z=A[11]-A[9],T.d=A[15]-A[13],T.normalize()}static GetBottomPlaneToRef(v,T){const A=v.m;T.normal.x=A[3]+A[1],T.normal.y=A[7]+A[5],T.normal.z=A[11]+A[9],T.d=A[15]+A[13],T.normalize()}static GetPlanesToRef(v,T){Me.GetNearPlaneToRef(v,T[0]),Me.GetFarPlaneToRef(v,T[1]),Me.GetLeftPlaneToRef(v,T[2]),Me.GetRightPlaneToRef(v,T[3]),Me.GetTopPlaneToRef(v,T[4]),Me.GetBottomPlaneToRef(v,T[5])}}ke.Frustum=Me;var Ge={};Object.defineProperty(Ge,"__esModule",{value:!0}),Ge.Path2=void 0;const Xe=ye,Ye=fe,Qe=Nt;class De{constructor(v,T){this.closed=!1,this._points=new Array,this._length=0,this._points.push(new Xe.Vector2(v,T))}static StartingAt(v,T){return new De(v,T)}addLineTo(v,T){if(this.closed)return this;const A=new Xe.Vector2(v,T),C=this._points[this._points.length-1];return this._points.push(A),this._length+=A.subtract(C).length(),this}addArcTo(v,T,A,C,E=36){if(this.closed)return this;const R=this._points[this._points.length-1],O=new Xe.Vector2(v,T),z=new Xe.Vector2(A,C),M=new Ye.Arc2(R,O,z);let V=M.angle.radians()/E;M.orientation===Qe.Orientation.CW&&(V*=-1);let H=M.startAngle.radians()+V;for(let v=0;v<E;v++){const v=Math.cos(H)*M.radius+M.centerPoint.x,T=Math.sin(H)*M.radius+M.centerPoint.y;this.addLineTo(v,T),H+=V}return this}close(){return this.closed=!0,this}length(){let v=this._length;if(!this.closed){const T=this._points[this._points.length-1];v+=this._points[0].subtract(T).length()}return v}getPoints(){return this._points}getPointAtLengthPosition(v){if(v<0||v>1)return Xe.Vector2.Zero();const T=v*this.length();let A=0;for(let v=0;v<this._points.length;v++){const C=(v+1)%this._points.length,E=this._points[v],R=this._points[C].subtract(E),O=R.length()+A;if(T>=A&&T<=O){const v=R.normalize(),C=T-A;return new Xe.Vector2(E.x+v.x*C,E.y+v.y*C)}A=O}return Xe.Vector2.Zero()}}Ge.Path2=De;var Ze={};Object.defineProperty(Ze,"__esModule",{value:!0}),Ze.Path3D=void 0;const Je=Ft,$e=Nt,tn=Vt;Ze.Path3D=class{constructor(v,T=null,A){this.path=v,this._curve=new Array,this._distances=new Array,this._tangents=new Array,this._normals=new Array,this._binormals=new Array;for(let T=0;T<v.length;T++)this._curve[T]=v[T].clone();this._raw=A||!1,this._compute(T)}getCurve(){return this._curve}getTangents(){return this._tangents}getNormals(){return this._normals}getBinormals(){return this._binormals}getDistances(){return this._distances}update(v,T=null){for(let T=0;T<v.length;T++)this._curve[T].x=v[T].x,this._curve[T].y=v[T].y,this._curve[T].z=v[T].z;return this._compute(T),this}_compute(v){const T=this._curve.length;this._tangents[0]=this._getFirstNonNullVector(0),this._raw||this._tangents[0].normalize(),this._tangents[T-1]=this._curve[T-1].subtract(this._curve[T-2]),this._raw||this._tangents[T-1].normalize();const A=this._tangents[0],C=this._normalVector(this._curve[0],A,v);let E,R,O,z;this._normals[0]=C,this._raw||this._normals[0].normalize(),this._binormals[0]=Je.Vector3.Cross(A,this._normals[0]),this._raw||this._binormals[0].normalize(),this._distances[0]=0;for(let v=1;v<T;v++)E=this._getLastNonNullVector(v),v<T-1&&(R=this._getFirstNonNullVector(v),this._tangents[v]=E.add(R),this._tangents[v].normalize()),this._distances[v]=this._distances[v-1]+E.length(),O=this._tangents[v],z=this._binormals[v-1],this._normals[v]=Je.Vector3.Cross(z,O),this._raw||this._normals[v].normalize(),this._binormals[v]=Je.Vector3.Cross(O,this._normals[v]),this._raw||this._binormals[v].normalize()}_getFirstNonNullVector(v){let T=1,A=this._curve[v+T].subtract(this._curve[v]);for(;0===A.length()&&v+T+1<this._curve.length;)T++,A=this._curve[v+T].subtract(this._curve[v]);return A}_getLastNonNullVector(v){let T=1,A=this._curve[v].subtract(this._curve[v-T]);for(;0===A.length()&&v>T+1;)T++,A=this._curve[v].subtract(this._curve[v-T]);return A}_normalVector(v,T,A){let C,E=T.length();if(0===E&&(E=1),null==A){let v;v=tn.Scalar.WithinEpsilon(Math.abs(T.y)/E,1,$e.Epsilon)?tn.Scalar.WithinEpsilon(Math.abs(T.x)/E,1,$e.Epsilon)?tn.Scalar.WithinEpsilon(Math.abs(T.z)/E,1,$e.Epsilon)?Je.Vector3.Zero():new Je.Vector3(0,0,1):new Je.Vector3(1,0,0):new Je.Vector3(0,-1,0),C=Je.Vector3.Cross(T,v)}else C=Je.Vector3.Cross(T,A),Je.Vector3.CrossToRef(C,T,C);return C.normalize(),C}};var nn={};Object.defineProperty(nn,"__esModule",{value:!0}),nn.Size=void 0;class je{constructor(v,T){this.width=v,this.height=T}get surface(){return this.width*this.height}static Zero(){return new je(0,0)}static Lerp(v,T,A){const C=v.width+(T.width-v.width)*A,E=v.height+(T.height-v.height)*A;return new je(C,E)}toString(){return`{W: ${this.width}, H: ${this.height}}`}getClassName(){return"Size"}getHashCode(){let v=this.width||0;return v=397*v^(this.height||0),v}copyFrom(v){this.width=v.width,this.height=v.height}copyFromFloats(v,T){return this.width=v,this.height=T,this}set(v,T){return this.copyFromFloats(v,T)}multiplyByFloats(v,T){return new je(this.width*v,this.height*T)}clone(){return new je(this.width,this.height)}equals(v){return!!v&&this.width===v.width&&this.height===v.height}add(v){return new je(this.width+v.width,this.height+v.height)}subtract(v){return new je(this.width-v.width,this.height-v.height)}}nn.Size=je,function(v){var T=Ot&&Ot.__createBinding||(Object.create?function(v,T,A,C){void 0===C&&(C=A),Object.defineProperty(v,C,{enumerable:!0,get:function(){return T[A]}})}:function(v,T,A,C){void 0===C&&(C=A),v[C]=T[A]}),A=Ot&&Ot.__exportStar||function(v,A){for(var C in v)"default"===C||Object.prototype.hasOwnProperty.call(A,C)||T(A,v,C)};Object.defineProperty(v,"__esModule",{value:!0}),A(Nt,v),A(zt,v),A(de,v),A(fe,v),A(Se,v),A(Ce,v),A(Ee,v),A(Ie,v),A(Fe,v),A(ke,v),A(kt,v),A(Ge,v),A(Ze,v),A(Ue,v),A(Bt,v),A(Vt,v),A(nn,v),A(ye,v),A(Ft,v),A(Ut,v),A(Pt,v)}(Pt);var on,rn,sn,an,cn={looping:!0,speed:1,weight:1,layer:0},ln=function(v){function e(T,A){void 0===A&&(A=cn);var C=v.call(this)||this;return C.isAnimationClip=!0,C.looping=cn.looping,C.weight=cn.weight,C.playing=!1,C.shouldReset=!1,C.speed=cn.speed,C.name=f("AnimClip"),C.layer=cn.layer,C.clip=T,C.setParams(o({},A)),C}return i(e,v),e.prototype.setParams=function(v){return this.looping=void 0!==v.looping?v.looping:this.looping,this.speed=v.speed||this.speed,this.weight=v.weight||this.weight,this.layer=v.layer||this.layer,this},e.prototype.toJSON=function(){var T=JSON.parse(JSON.stringify(v.prototype.toJSON.call(this)));return this.shouldReset&&(this.shouldReset=!1),T},e.prototype.play=function(v){var T;void 0===v&&(v=!1),null===(T=this.owner)||void 0===T||T.play(this,v)},e.prototype.pause=function(){var v;null===(v=this.owner)||void 0===v||v.pause(this)},e.prototype.reset=function(){this.shouldReset=!0},e.prototype.stop=function(){var v;null===(v=this.owner)||void 0===v||v.stop(this)},r([J.readonly,s("design:type",String)],e.prototype,"clip",void 0),r([J.field,s("design:type",Boolean)],e.prototype,"looping",void 0),r([J.field,s("design:type",Number)],e.prototype,"weight",void 0),r([J.field,s("design:type",Boolean)],e.prototype,"playing",void 0),r([J.field,s("design:type",Boolean)],e.prototype,"shouldReset",void 0),r([J.field,s("design:type",Number)],e.prototype,"speed",void 0),r([J.readonly,s("design:type",String)],e.prototype,"name",void 0),e}(J);v.InputEventType=void 0,(on=v.InputEventType||(v.InputEventType={}))[on.DOWN=0]="DOWN",on[on.UP=1]="UP",v.CameraMode=void 0,(rn=v.CameraMode||(v.CameraMode={}))[rn.FirstPerson=0]="FirstPerson",rn[rn.ThirdPerson=1]="ThirdPerson",rn[rn.BuildingToolGodMode=2]="BuildingToolGodMode",v.LandRole=void 0,(sn=v.LandRole||(v.LandRole={})).OWNER="owner",sn.OPERATOR="operator",v.ActionButton=void 0,(an=v.ActionButton||(v.ActionButton={})).POINTER="POINTER",an.PRIMARY="PRIMARY",an.SECONDARY="SECONDARY",an.ANY="ANY",an.FORWARD="FORWARD",an.BACKWARD="BACKWARD",an.RIGHT="RIGHT",an.LEFT="LEFT",an.JUMP="JUMP",an.WALK="WALK",an.ACTION_3="ACTION_3",an.ACTION_4="ACTION_4",an.ACTION_5="ACTION_5",an.ACTION_6="ACTION_6";var un,hn,Ke=function(v){if(this.callback=v,!v||!("apply"in v)||!("call"in v))throw new Error("Callback is not a function");fn.ensureInstance()},pn=function(v){function e(){return null!==v&&v.apply(this,arguments)||this}return i(e,v),r([P("pointerDown")],e)}(Ke),dn=function(v){function e(){return null!==v&&v.apply(this,arguments)||this}return i(e,v),r([P("pointerUp")],e)}(Ke),en=function(v,T){this.fn=v,this.useRaycast=T},fn=function(){function e(){this.buttonIdMapping=[v.ActionButton.POINTER,v.ActionButton.PRIMARY,v.ActionButton.SECONDARY,v.ActionButton.ANY,v.ActionButton.FORWARD,v.ActionButton.BACKWARD,v.ActionButton.RIGHT,v.ActionButton.LEFT,v.ActionButton.JUMP,v.ActionButton.WALK,v.ActionButton.ACTION_3,v.ActionButton.ACTION_4,v.ActionButton.ACTION_5,v.ActionButton.ACTION_6],this.subscriptions=this.buttonIdMapping.reduce((function(v,T){var A;return o(o({},v),((A={})[T]={BUTTON_DOWN:[],BUTTON_UP:[]},A))}),{}),this.internalState=this.buttonIdMapping.reduce((function(v,T){var A;return o(o({},v),((A={})[T]={BUTTON_DOWN:!1},A))}),{})}return Object.defineProperty(e,"instance",{get:function(){return e.ensureInstance(),e._instance},enumerable:!1,configurable:!0}),e.ensureInstance=function(){e._instance||(e._instance=new e)},e.prototype.isButtonPressed=function(v){return this.internalState[v]},e.prototype.subscribe=function(v,T,A,C){var E=this;return this.subscriptions[T][v].push(new en(C,A)),function(){E.unsubscribe(v,T,C)}},e.prototype.unsubscribe=function(v,T,A){var C=this.getSubscriptionId(v,T,A);return C>-1&&this.subscriptions[T][v].splice(C,1)},e.prototype.handlePointerEvent=function(T){var A=this.getPointerById(T.buttonId);if(A){var C=o(o({},T),{button:A,direction:(new Pt.Vector3).copyFrom(T.direction),origin:(new Pt.Vector3).copyFrom(T.origin),hit:void 0}),E=T.hit?o(o({},T.hit),{hitPoint:(new Pt.Vector3).copyFrom(T.hit.hitPoint),normal:(new Pt.Vector3).copyFrom(T.hit.normal),worldNormal:(new Pt.Vector3).copyFrom(T.hit.worldNormal)}):void 0;if(T.type===v.InputEventType.DOWN){this.internalState[A].BUTTON_DOWN=!0;for(var R=0;R<this.subscriptions[A].BUTTON_DOWN.length;R++)(O=this.subscriptions[A].BUTTON_DOWN[R]).useRaycast?C.hit=E:C.hit=void 0,O.fn(C);E&&E.entityId&&N.engine&&(M=(z=N.engine.entities[E.entityId])&&z.getComponentOrNull(pn))&&(C.hit=E,M.callback(C))}else{for(this.internalState[A].BUTTON_DOWN=!1,R=0;R<this.subscriptions[A].BUTTON_UP.length;R++){var O;(O=this.subscriptions[A].BUTTON_UP[R]).useRaycast?C.hit=E:C.hit=void 0,O.fn(C)}var z,M;E&&E.entityId&&N.engine&&(M=(z=N.engine.entities[E.entityId])&&z.getComponentOrNull(dn))&&(C.hit=E,M.callback(C))}}},e.prototype.getSubscriptionId=function(v,T,A){for(var C=0;C<this.subscriptions[T][v].length;C++)if(this.subscriptions[T][v][C].fn===A)return C;return-1},e.prototype.getPointerById=function(T){if(T<0||T>=this.buttonIdMapping.length)return null;var A=this.buttonIdMapping[T];return A===v.ActionButton.ANY?null:A},e}();v.CLASS_ID=void 0,(un=v.CLASS_ID||(v.CLASS_ID={}))[un.TRANSFORM=1]="TRANSFORM",un[un.UUID_CALLBACK=8]="UUID_CALLBACK",un[un.BOX_SHAPE=16]="BOX_SHAPE",un[un.SPHERE_SHAPE=17]="SPHERE_SHAPE",un[un.PLANE_SHAPE=18]="PLANE_SHAPE",un[un.CONE_SHAPE=19]="CONE_SHAPE",un[un.CYLINDER_SHAPE=20]="CYLINDER_SHAPE",un[un.TEXT_SHAPE=21]="TEXT_SHAPE",un[un.NFT_SHAPE=22]="NFT_SHAPE",un[un.UI_WORLD_SPACE_SHAPE=23]="UI_WORLD_SPACE_SHAPE",un[un.UI_SCREEN_SPACE_SHAPE=24]="UI_SCREEN_SPACE_SHAPE",un[un.UI_CONTAINER_RECT=25]="UI_CONTAINER_RECT",un[un.UI_CONTAINER_STACK=26]="UI_CONTAINER_STACK",un[un.UI_TEXT_SHAPE=27]="UI_TEXT_SHAPE",un[un.UI_INPUT_TEXT_SHAPE=28]="UI_INPUT_TEXT_SHAPE",un[un.UI_IMAGE_SHAPE=29]="UI_IMAGE_SHAPE",un[un.UI_SLIDER_SHAPE=30]="UI_SLIDER_SHAPE",un[un.CIRCLE_SHAPE=31]="CIRCLE_SHAPE",un[un.BILLBOARD=32]="BILLBOARD",un[un.ANIMATION=33]="ANIMATION",un[un.FONT=34]="FONT",un[un.UI_FULLSCREEN_SHAPE=40]="UI_FULLSCREEN_SHAPE",un[un.UI_BUTTON_SHAPE=41]="UI_BUTTON_SHAPE",un[un.GLTF_SHAPE=54]="GLTF_SHAPE",un[un.OBJ_SHAPE=55]="OBJ_SHAPE",un[un.AVATAR_SHAPE=56]="AVATAR_SHAPE",un[un.BASIC_MATERIAL=64]="BASIC_MATERIAL",un[un.PBR_MATERIAL=65]="PBR_MATERIAL",un[un.HIGHLIGHT_ENTITY=66]="HIGHLIGHT_ENTITY",un[un.SOUND=67]="SOUND",un[un.TEXTURE=68]="TEXTURE",un[un.VIDEO_CLIP=70]="VIDEO_CLIP",un[un.VIDEO_TEXTURE=71]="VIDEO_TEXTURE",un[un.AVATAR_TEXTURE=72]="AVATAR_TEXTURE",un[un.AUDIO_CLIP=200]="AUDIO_CLIP",un[un.AUDIO_SOURCE=201]="AUDIO_SOURCE",un[un.AUDIO_STREAM=202]="AUDIO_STREAM",un[un.GIZMOS=203]="GIZMOS",un[un.SMART_ITEM=204]="SMART_ITEM",un[un.AVATAR_MODIFIER_AREA=205]="AVATAR_MODIFIER_AREA",un[un.AVATAR_ATTACH=206]="AVATAR_ATTACH",un[un.CAMERA_MODE_AREA=207]="CAMERA_MODE_AREA",un[un.NAME=300]="NAME",un[un.LOCKED_ON_EDIT=301]="LOCKED_ON_EDIT",un[un.VISIBLE_ON_EDIT=302]="VISIBLE_ON_EDIT",v.AvatarModifiers=void 0,(hn=v.AvatarModifiers||(v.AvatarModifiers={})).HIDE_AVATARS="HIDE_AVATARS",hn.DISABLE_PASSPORTS="DISABLE_PASSPORTS";var yn,gn=function(T){function n(v){var A=T.call(this)||this;return A.area=v.area,A.modifiers=v.modifiers,A.excludeIds=v.excludeIds,A}return i(n,T),r([J.field,s("design:type",Object)],n.prototype,"area",void 0),r([J.field,s("design:type",Array)],n.prototype,"modifiers",void 0),r([J.field,s("design:type",Array)],n.prototype,"excludeIds",void 0),r([P("engine.avatarModifierArea",v.CLASS_ID.AVATAR_MODIFIER_AREA),s("design:paramtypes",[Object])],n)}(J),mn=function(T){function n(v){void 0===v&&(v={});var A=T.call(this)||this;return A.position=v.position||Pt.Vector3.Zero(),A.rotation=v.rotation||Pt.Quaternion.Identity,A.scale=v.scale||new Pt.Vector3(1,1,1),A}return i(n,T),Object.defineProperty(n.prototype,"eulerAngles",{get:function(){return this.rotation.eulerAngles},enumerable:!1,configurable:!0}),n.prototype.lookAt=function(v,T){void 0===T&&(T=Pt.MathTmp.staticUp);var A=new Pt.Matrix;return Pt.Matrix.LookAtLHToRef(this.position,v,T,A),A.invert(),Pt.Quaternion.FromRotationMatrixToRef(A,this.rotation),this},n.prototype.rotate=function(v,T){return this.rotation.multiplyInPlace(this.rotation.angleAxis(T,v)),this},n.prototype.translate=function(v){return this.position.addInPlace(v),this},r([J.field,s("design:type",Pt.Vector3)],n.prototype,"position",void 0),r([J.field,s("design:type",Pt.Quaternion)],n.prototype,"rotation",void 0),r([J.field,s("design:type",Pt.Vector3)],n.prototype,"scale",void 0),r([P("engine.transform",v.CLASS_ID.TRANSFORM),s("design:paramtypes",[Object])],n)}(J);v.AttachToAvatarAnchorPointId=void 0,(yn=v.AttachToAvatarAnchorPointId||(v.AttachToAvatarAnchorPointId={}))[yn.Position=0]="Position",yn[yn.NameTag=1]="NameTag",yn[yn.LeftHand=2]="LeftHand",yn[yn.RightHand=3]="RightHand";var vn,bn=function(T){function n(A){void 0===A&&(A={});var C=T.call(this)||this;return C.avatarId=A.avatarId||"",C.anchorPointId=A.anchorPointId||v.AttachToAvatarAnchorPointId.Position,C}return i(n,T),r([J.field,s("design:type",String)],n.prototype,"avatarId",void 0),r([J.field,s("design:type",Number)],n.prototype,"anchorPointId",void 0),r([J.field,s("design:type",String)],n.prototype,"avatarSceneId",void 0),r([P("engine.transform",v.CLASS_ID.AVATAR_ATTACH),s("design:paramtypes",[Object])],n)}(J),Tn=function(T){function n(v,A,C){void 0===v&&(v=!0),void 0===A&&(A=!0),void 0===C&&(C=!0);var E=T.call(this)||this;return E.x=!0,E.y=!0,E.z=!0,E.x=v,E.y=A,E.z=C,E}return i(n,T),r([J.field,s("design:type",Boolean)],n.prototype,"x",void 0),r([J.field,s("design:type",Boolean)],n.prototype,"y",void 0),r([J.field,s("design:type",Boolean)],n.prototype,"z",void 0),r([P("engine.billboard",v.CLASS_ID.BILLBOARD),s("design:paramtypes",[Boolean,Boolean,Boolean])],n)}(J),wn=function(v){function e(){var T=null!==v&&v.apply(this,arguments)||this;return T.withCollisions=!0,T.isPointerBlocker=!0,T.visible=!0,T}return i(e,v),r([J.field,s("design:type",Boolean)],e.prototype,"withCollisions",void 0),r([J.field,s("design:type",Boolean)],e.prototype,"isPointerBlocker",void 0),r([J.field,s("design:type",Boolean)],e.prototype,"visible",void 0),e}(J),An=function(T){function n(){return null!==T&&T.apply(this,arguments)||this}return i(n,T),r([J.field,s("design:type",Array)],n.prototype,"uvs",void 0),r([N("engine.shape",v.CLASS_ID.BOX_SHAPE)],n)}(wn),xn=function(T){function n(){return null!==T&&T.apply(this,arguments)||this}return i(n,T),r([N("engine.shape",v.CLASS_ID.SPHERE_SHAPE)],n)}(wn),Sn=function(T){function n(){return null!==T&&T.apply(this,arguments)||this}return i(n,T),r([J.field,s("design:type",Number)],n.prototype,"segments",void 0),r([J.field,s("design:type",Number)],n.prototype,"arc",void 0),r([N("engine.shape",v.CLASS_ID.CIRCLE_SHAPE)],n)}(wn),_n=function(T){function n(){var v=null!==T&&T.apply(this,arguments)||this;return v.width=1,v.height=1,v}return i(n,T),r([J.field,s("design:type",Number)],n.prototype,"width",void 0),r([J.field,s("design:type",Number)],n.prototype,"height",void 0),r([J.field,s("design:type",Array)],n.prototype,"uvs",void 0),r([N("engine.shape",v.CLASS_ID.PLANE_SHAPE)],n)}(wn),Cn=function(T){function n(){var v=null!==T&&T.apply(this,arguments)||this;return v.radiusTop=0,v.radiusBottom=1,v.segmentsHeight=1,v.segmentsRadial=36,v.openEnded=!1,v.radius=null,v.arc=360,v}return i(n,T),r([J.field,s("design:type",Number)],n.prototype,"radiusTop",void 0),r([J.field,s("design:type",Number)],n.prototype,"radiusBottom",void 0),r([J.field,s("design:type",Number)],n.prototype,"segmentsHeight",void 0),r([J.field,s("design:type",Number)],n.prototype,"segmentsRadial",void 0),r([J.field,s("design:type",Boolean)],n.prototype,"openEnded",void 0),r([J.field,s("design:type",Object)],n.prototype,"radius",void 0),r([J.field,s("design:type",Number)],n.prototype,"arc",void 0),r([N("engine.shape",v.CLASS_ID.CONE_SHAPE)],n)}(wn),En=function(T){function n(){var v=null!==T&&T.apply(this,arguments)||this;return v.radiusTop=1,v.radiusBottom=1,v.segmentsHeight=1,v.segmentsRadial=36,v.openEnded=!1,v.radius=null,v.arc=360,v}return i(n,T),r([J.field,s("design:type",Number)],n.prototype,"radiusTop",void 0),r([J.field,s("design:type",Number)],n.prototype,"radiusBottom",void 0),r([J.field,s("design:type",Number)],n.prototype,"segmentsHeight",void 0),r([J.field,s("design:type",Number)],n.prototype,"segmentsRadial",void 0),r([J.field,s("design:type",Boolean)],n.prototype,"openEnded",void 0),r([J.field,s("design:type",Object)],n.prototype,"radius",void 0),r([J.field,s("design:type",Number)],n.prototype,"arc",void 0),r([N("engine.shape",v.CLASS_ID.CYLINDER_SHAPE)],n)}(wn),In=function(T){function n(v){var A=T.call(this)||this;return A.src=v,A}return i(n,T),r([wn.readonly,s("design:type",String)],n.prototype,"src",void 0),r([N("engine.shape",v.CLASS_ID.GLTF_SHAPE),s("design:paramtypes",[String])],n)}(wn);v.PictureFrameStyle=void 0,(vn=v.PictureFrameStyle||(v.PictureFrameStyle={}))[vn.Classic=0]="Classic",vn[vn.Baroque_Ornament=1]="Baroque_Ornament",vn[vn.Diamond_Ornament=2]="Diamond_Ornament",vn[vn.Minimal_Wide=3]="Minimal_Wide",vn[vn.Minimal_Grey=4]="Minimal_Grey",vn[vn.Blocky=5]="Blocky",vn[vn.Gold_Edges=6]="Gold_Edges",vn[vn.Gold_Carved=7]="Gold_Carved",vn[vn.Gold_Wide=8]="Gold_Wide",vn[vn.Gold_Rounded=9]="Gold_Rounded",vn[vn.Metal_Medium=10]="Metal_Medium",vn[vn.Metal_Wide=11]="Metal_Wide",vn[vn.Metal_Slim=12]="Metal_Slim",vn[vn.Metal_Rounded=13]="Metal_Rounded",vn[vn.Pins=14]="Pins",vn[vn.Minimal_Black=15]="Minimal_Black",vn[vn.Minimal_White=16]="Minimal_White",vn[vn.Tape=17]="Tape",vn[vn.Wood_Slim=18]="Wood_Slim",vn[vn.Wood_Wide=19]="Wood_Wide",vn[vn.Wood_Twigs=20]="Wood_Twigs",vn[vn.Canvas=21]="Canvas",vn[vn.None=22]="None";var Rn,On=function(T){function n(A,C){void 0===C&&(C={});var E=T.call(this)||this;E.src=A;var R=new Pt.Color3(.6404918,.611472,.8584906),O=v.PictureFrameStyle.Classic;return"r"in C?R=C:null!==C&&(C.color&&(R=C.color),C.style&&(O=C.style)),E.color=R,E.style=O,E}return i(n,T),r([wn.readonly,s("design:type",String)],n.prototype,"src",void 0),r([wn.readonly,s("design:type",Number)],n.prototype,"style",void 0),r([J.field,s("design:type",Pt.Color3)],n.prototype,"color",void 0),r([N("engine.shape",v.CLASS_ID.NFT_SHAPE),s("design:paramtypes",[String,Object])],n)}(wn),Pn=function(T){function n(v,A){var C=T.call(this)||this,E=new RegExp("data:[a-z-]+/[a-z-]+;base64");if((v.length>2048||E.test(v))&&c(" Base64 textures will be deprecated in version 7 of decentraland-ecs"),C.src=v,A)for(var R in A)C[R]=A[R];return C}return i(n,T),r([J.readonly,s("design:type",String)],n.prototype,"src",void 0),r([J.readonly,s("design:type",Number)],n.prototype,"samplingMode",void 0),r([J.readonly,s("design:type",Number)],n.prototype,"wrap",void 0),r([J.readonly,s("design:type",Boolean)],n.prototype,"hasAlpha",void 0),r([N("engine.texture",v.CLASS_ID.TEXTURE),s("design:paramtypes",[String,Object])],n)}(J),Dn=function(T){function n(){var v=null!==T&&T.apply(this,arguments)||this;return v.states=[],v}return i(n,T),n.prototype.addClip=function(v){var T=this;return this.states.push(v),v.onChange((function(){T.dirty=!0})),v.owner=this,this},n.prototype.getClip=function(v){for(var T=0;T<this.states.length;T++){var A=this.states[T];if(A.clip===v)return A}var C=new ln(v);return this.addClip(C),C},n.prototype.stop=function(v){if(v)v.playing=!1,v.shouldReset=!0;else for(var T=0;T<this.states.length;T++){var A=this.states[T];this.stop(A)}},n.prototype.play=function(v,T){void 0===T&&(T=!1);for(var A=0;A<this.states.length;A++){var C=this.states[A];C.layer===v.layer&&v!==C&&this.pause(C)}T&&(v.shouldReset=!0),v.playing=!0,v.dirty=!0,v.data.nonce=Math.random()},n.prototype.pause=function(v){if(v)v.playing=!1;else for(var T=0;T<this.states.length;T++){var A=this.states[T];this.pause(A)}},r([J.readonly,s("design:type",Array)],n.prototype,"states",void 0),r([P("engine.animator",v.CLASS_ID.ANIMATION)],n)}(wn),Nn=function(T){function n(v){var A=T.call(this)||this;return A.src=v,A}return i(n,T),r([J.readonly,s("design:type",String)],n.prototype,"src",void 0),r([N("engine.shape",v.CLASS_ID.OBJ_SHAPE),s("design:paramtypes",[String])],n)}(wn),zn=function(T){function n(v){void 0===v&&(v="");var A=T.call(this)||this;return A.src=v,A}return i(n,T),r([J.readonly,s("design:type",String)],n.prototype,"src",void 0),r([N("engine.font",v.CLASS_ID.FONT),s("design:paramtypes",[String])],n)}(J);v.Fonts=void 0,(Rn=v.Fonts||(v.Fonts={})).SanFrancisco="builtin:SF-UI-Text-Regular SDF",Rn.SanFrancisco_Heavy="builtin:SF-UI-Text-Heavy SDF",Rn.SanFrancisco_Semibold="builtin:SF-UI-Text-Semibold SDF",Rn.LiberationSans="builtin:LiberationSans SDF",Rn.SansSerif="SansSerif",Rn.SansSerif_Heavy="SansSerif_Heavy",Rn.SansSerif_Bold="SansSerif_Bold",Rn.SansSerif_SemiBold="SansSerif_SemiBold";var Ln,Mn=function(T){function n(v){var A=T.call(this)||this;return A.outlineWidth=0,A.outlineColor=new Pt.Color3(1,1,1),A.color=new Pt.Color3(1,1,1),A.fontSize=10,A.opacity=1,A.value="",A.lineSpacing="0px",A.lineCount=0,A.textWrapping=!1,A.shadowBlur=0,A.shadowOffsetX=0,A.shadowOffsetY=0,A.shadowColor=new Pt.Color3(1,1,1),A.hTextAlign="center",A.vTextAlign="center",A.width=1,A.height=1,A.paddingTop=0,A.paddingRight=0,A.paddingBottom=0,A.paddingLeft=0,A.billboard=!1,A.visible=!0,v&&(A.value=v),A}return i(n,T),r([J.field,s("design:type",Number)],n.prototype,"outlineWidth",void 0),r([J.field,s("design:type",Pt.Color3)],n.prototype,"outlineColor",void 0),r([J.field,s("design:type",Pt.Color3)],n.prototype,"color",void 0),r([J.field,s("design:type",Number)],n.prototype,"fontSize",void 0),r([J.component,s("design:type",zn)],n.prototype,"font",void 0),r([J.field,s("design:type",Number)],n.prototype,"opacity",void 0),r([J.field,s("design:type",String)],n.prototype,"value",void 0),r([J.field,s("design:type",String)],n.prototype,"lineSpacing",void 0),r([J.field,s("design:type",Number)],n.prototype,"lineCount",void 0),r([J.field,s("design:type",Boolean)],n.prototype,"textWrapping",void 0),r([J.field,s("design:type",Number)],n.prototype,"shadowBlur",void 0),r([J.field,s("design:type",Number)],n.prototype,"shadowOffsetX",void 0),r([J.field,s("design:type",Number)],n.prototype,"shadowOffsetY",void 0),r([J.field,s("design:type",Pt.Color3)],n.prototype,"shadowColor",void 0),r([J.field,s("design:type",String)],n.prototype,"hTextAlign",void 0),r([J.field,s("design:type",String)],n.prototype,"vTextAlign",void 0),r([J.field,s("design:type",Number)],n.prototype,"width",void 0),r([J.field,s("design:type",Number)],n.prototype,"height",void 0),r([J.field,s("design:type",Number)],n.prototype,"paddingTop",void 0),r([J.field,s("design:type",Number)],n.prototype,"paddingRight",void 0),r([J.field,s("design:type",Number)],n.prototype,"paddingBottom",void 0),r([J.field,s("design:type",Number)],n.prototype,"paddingLeft",void 0),r([J.field,s("design:type",Boolean)],n.prototype,"billboard",void 0),r([J.field,s("design:type",Boolean)],n.prototype,"visible",void 0),r([P("engine.text",v.CLASS_ID.TEXT_SHAPE),s("design:paramtypes",[String])],n)}(J);v.TransparencyMode=void 0,(Ln=v.TransparencyMode||(v.TransparencyMode={}))[Ln.OPAQUE=0]="OPAQUE",Ln[Ln.ALPHA_TEST=1]="ALPHA_TEST",Ln[Ln.ALPHA_BLEND=2]="ALPHA_BLEND",Ln[Ln.ALPHA_TEST_AND_BLEND=3]="ALPHA_TEST_AND_BLEND",Ln[Ln.AUTO=4]="AUTO";var Fn,Bn=function(T){function n(){var A=null!==T&&T.apply(this,arguments)||this;return A.alphaTest=.5,A.castShadows=!0,A.transparencyMode=v.TransparencyMode.AUTO,A}return i(n,T),r([J.field,s("design:type",Number)],n.prototype,"alphaTest",void 0),r([J.field,s("design:type",Object)],n.prototype,"albedoColor",void 0),r([J.field,s("design:type",Pt.Color3)],n.prototype,"emissiveColor",void 0),r([J.field,s("design:type",Number)],n.prototype,"metallic",void 0),r([J.field,s("design:type",Number)],n.prototype,"roughness",void 0),r([J.field,s("design:type",Pt.Color3)],n.prototype,"reflectivityColor",void 0),r([J.field,s("design:type",Number)],n.prototype,"directIntensity",void 0),r([J.field,s("design:type",Number)],n.prototype,"microSurface",void 0),r([J.field,s("design:type",Number)],n.prototype,"emissiveIntensity",void 0),r([J.field,s("design:type",Number)],n.prototype,"specularIntensity",void 0),r([J.component,s("design:type",Object)],n.prototype,"albedoTexture",void 0),r([J.component,s("design:type",Object)],n.prototype,"alphaTexture",void 0),r([J.component,s("design:type",Object)],n.prototype,"emissiveTexture",void 0),r([J.component,s("design:type",Object)],n.prototype,"bumpTexture",void 0),r([J.field,s("design:type",Boolean)],n.prototype,"castShadows",void 0),r([J.field,s("design:type",Number)],n.prototype,"transparencyMode",void 0),r([N("engine.material",v.CLASS_ID.PBR_MATERIAL)],n)}(J),kn=function(T){function n(){var v=null!==T&&T.apply(this,arguments)||this;return v.alphaTest=.5,v.castShadows=!0,v}return i(n,T),r([J.component,s("design:type",Object)],n.prototype,"texture",void 0),r([J.field,s("design:type",Number)],n.prototype,"alphaTest",void 0),r([J.field,s("design:type",Boolean)],n.prototype,"castShadows",void 0),r([N("engine.material",v.CLASS_ID.BASIC_MATERIAL)],n)}(J),Un=function(v){function e(T){var A=v.call(this)||this;if(A.uuid=f("UUID"),!T||!("apply"in T)||!("call"in T))throw new Error("Callback is not a function");return A.callback=T,A}return i(e,v),e.uuidEvent=function(v,T){if(delete v[T]){var A=T+"_"+Math.random();v[A]=void 0,Object.defineProperty(v,A,o(o({},Object.getOwnPropertyDescriptor(v,A)),{enumerable:!1})),Object.defineProperty(v,T.toString(),{get:function(){return this[A]},set:function(v){var C=this[A];if(v){if(!(v instanceof e))throw new Error("value is not an OnUUIDEvent");this.data[T]=v.uuid}else this.data[T]=null;if(this[A]=v,v!==C){this.dirty=!0;for(var E=0;E<this.subscriptions.length;E++)this.subscriptions[E](T,v,C)}},enumerable:!0})}},e.prototype.toJSON=function(){return{uuid:this.uuid,type:this.type}},r([J.field,s("design:type",Function)],e.prototype,"callback",void 0),e}(J),Vn=function(T){function n(){var A=null!==T&&T.apply(this,arguments)||this;return A.button=v.ActionButton.ANY,A.hoverText="Interact",A.distance=10,A.showFeedback=!0,A}return i(n,T),n.prototype.toJSON=function(){return{uuid:this.uuid,type:this.type,button:this.button,hoverText:this.hoverText,distance:this.distance,showFeedback:this.showFeedback}},r([J.field,s("design:type",String)],n.prototype,"button",void 0),r([J.field,s("design:type",String)],n.prototype,"hoverText",void 0),r([J.field,s("design:type",Number)],n.prototype,"distance",void 0),r([J.field,s("design:type",Boolean)],n.prototype,"showFeedback",void 0),n}(Un),Hn=function(T){function n(){var v=null!==T&&T.apply(this,arguments)||this;return v.type="onPointerLock",v}return i(n,T),r([J.readonly,s("design:type",String)],n.prototype,"type",void 0),r([P("engine.onPointerLock",v.CLASS_ID.UUID_CALLBACK)],n)}(Un),Wn=function(T){function n(){var v=null!==T&&T.apply(this,arguments)||this;return v.type="onAnimationEnd",v}return i(n,T),r([J.readonly,s("design:type",String)],n.prototype,"type",void 0),r([P("engine.onAnimationEnd",v.CLASS_ID.UUID_CALLBACK)],n)}(Un),jn=function(T){function n(){return null!==T&&T.apply(this,arguments)||this}return i(n,T),r([P("engine.smartItem",v.CLASS_ID.SMART_ITEM)],n)}(J),qn=function(T){function n(v){var A=T.call(this)||this;return A.url=v,A}return i(n,T),r([J.readonly,s("design:type",String)],n.prototype,"url",void 0),r([N("engine.VideoClip",v.CLASS_ID.VIDEO_CLIP),s("design:paramtypes",[String])],n)}(J);v.VideoStatus=void 0,(Fn=v.VideoStatus||(v.VideoStatus={}))[Fn.NONE=0]="NONE",Fn[Fn.ERROR=1]="ERROR",Fn[Fn.LOADING=2]="LOADING",Fn[Fn.READY=3]="READY",Fn[Fn.PLAYING=4]="PLAYING",Fn[Fn.BUFFERING=5]="BUFFERING";var Gn,Xn=function(T){function n(A,C){var E=T.call(this)||this;if(E.volume=1,E.playbackRate=1,E.loop=!1,E.seek=-1,E._position=-1,E._videoLength=-1,E._status=v.VideoStatus.NONE,E.playing=!1,!(A instanceof qn))throw new Error("Trying to create VideoTexture(VideoClip) with an invalid VideoClip");if(E.videoClipId=D(A),C)for(var R in C)E[R]=C[R];return E}return i(n,T),n.prototype.play=function(){this.playing=!0},n.prototype.pause=function(){this.playing=!1},n.prototype.reset=function(){this.seekTime(0),this.pause()},n.prototype.seekTime=function(v){this.seek=v,this.dirty=!0,this.data.nonce=Math.random()},n.prototype.toJSON=function(){if(this.seek>=0){var v=JSON.parse(JSON.stringify(T.prototype.toJSON.call(this)));return this.seek=-1,v}return T.prototype.toJSON.call(this)},n.prototype.update=function(T){T.videoClipId===this.videoClipId&&(this._status=T.videoStatus||v.VideoStatus.NONE,this._videoLength=T.totalVideoLength,this._position=T.currentOffset)},Object.defineProperty(n.prototype,"position",{get:function(){return this._position},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"videoLength",{get:function(){return this._videoLength},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"status",{get:function(){return this._status},enumerable:!1,configurable:!0}),r([J.readonly,s("design:type",String)],n.prototype,"videoClipId",void 0),r([J.readonly,s("design:type",Number)],n.prototype,"samplingMode",void 0),r([J.readonly,s("design:type",Number)],n.prototype,"wrap",void 0),r([J.field,s("design:type",Number)],n.prototype,"volume",void 0),r([J.field,s("design:type",Number)],n.prototype,"playbackRate",void 0),r([J.field,s("design:type",Boolean)],n.prototype,"loop",void 0),r([J.field,s("design:type",Number)],n.prototype,"seek",void 0),r([J.field,s("design:type",Boolean)],n.prototype,"playing",void 0),r([N("engine.VideoTexture",v.CLASS_ID.VIDEO_TEXTURE),s("design:paramtypes",[qn,Object])],n)}(J),Yn=function(T){function n(v){var A=T.call(this)||this;return A.area=v.area,A.cameraMode=v.cameraMode,A}return i(n,T),r([J.field,s("design:type",Object)],n.prototype,"area",void 0),r([J.field,s("design:type",Number)],n.prototype,"cameraMode",void 0),r([P("engine.cameraModeArea",v.CLASS_ID.CAMERA_MODE_AREA),s("design:paramtypes",[Object])],n)}(J),Qn=function(T){function n(v,A){var C=T.call(this)||this;if(C.userId=v,A)for(var E in A)C[E]=A[E];return C}return i(n,T),r([J.readonly,s("design:type",String)],n.prototype,"userId",void 0),r([J.readonly,s("design:type",Number)],n.prototype,"samplingMode",void 0),r([J.readonly,s("design:type",Number)],n.prototype,"wrap",void 0),r([J.readonly,s("design:type",Boolean)],n.prototype,"hasAlpha",void 0),r([N("engine.texture",v.CLASS_ID.AVATAR_TEXTURE),s("design:paramtypes",[String,Object])],n)}(J),Kn=function(){function e(){var T=this;this.position=new Pt.Vector3,this.rotation=new Pt.Quaternion,this.feetPosition=new Pt.Vector3,this.worldPosition=new Pt.Vector3,this.lastEventPosition={x:0,y:0,z:0},this.lastEventWorldPosition={x:0,y:0,z:0},this.lastEventRotation={x:0,y:0,z:0,w:1},this._playerHeight=1.6,this._cameraMode=v.CameraMode.ThirdPerson,"undefined"!=typeof dcl&&(dcl.subscribe("positionChanged"),dcl.subscribe("rotationChanged"),dcl.subscribe("cameraModeChanged"),dcl.onEvent((function(v){switch(v.type){case"positionChanged":T.positionChanged(v.data);break;case"rotationChanged":T.rotationChanged(v.data);break;case"cameraModeChanged":T.cameraModeChanged(v.data)}}))),Object.defineProperty(this.position,"x",{get:function(){return T.lastEventPosition.x}}),Object.defineProperty(this.position,"y",{get:function(){return T.lastEventPosition.y}}),Object.defineProperty(this.position,"z",{get:function(){return T.lastEventPosition.z}}),Object.defineProperty(this.worldPosition,"x",{get:function(){return T.lastEventWorldPosition.x}}),Object.defineProperty(this.worldPosition,"y",{get:function(){return T.lastEventWorldPosition.y}}),Object.defineProperty(this.worldPosition,"z",{get:function(){return T.lastEventWorldPosition.z}}),Object.defineProperty(this.feetPosition,"x",{get:function(){return T.lastEventPosition.x}}),Object.defineProperty(this.feetPosition,"y",{get:function(){return T.lastEventPosition.y-T.playerHeight}}),Object.defineProperty(this.feetPosition,"z",{get:function(){return T.lastEventPosition.z}}),Object.defineProperty(this.rotation,"x",{get:function(){return T.lastEventRotation.x}}),Object.defineProperty(this.rotation,"y",{get:function(){return T.lastEventRotation.y}}),Object.defineProperty(this.rotation,"z",{get:function(){return T.lastEventRotation.z}}),Object.defineProperty(this.rotation,"w",{get:function(){return T.lastEventRotation.w}})}return Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e),e._instance},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"playerHeight",{get:function(){return this._playerHeight},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cameraMode",{get:function(){return this._cameraMode},enumerable:!1,configurable:!0}),e.prototype.positionChanged=function(v){this.lastEventPosition=v.position,this.lastEventWorldPosition=v.cameraPosition,this._playerHeight=v.playerHeight},e.prototype.rotationChanged=function(v){this.lastEventRotation=v.quaternion},e.prototype.cameraModeChanged=function(v){this._cameraMode=v.cameraMode},e}();!function(v){v.HitFirst="rqhf",v.HitAll="rqha"}(Gn||(Gn={}));var Zn,Jn=function(){function t(){this.queries={}}return Object.defineProperty(t,"instance",{get:function(){return t.ensureInstance(),t._instance},enumerable:!1,configurable:!0}),t.ensureInstance=function(){t._instance||(t._instance=new t)},t.prototype.getRayFromCamera=function(v){var T=Kn.instance.rotation,A=Pt.Matrix.Identity();T.toRotationMatrix(A);var C=Pt.Vector3.TransformCoordinates(Pt.Vector3.Forward(),A);return{origin:Kn.instance.position,direction:C,distance:v}},t.prototype.getRayFromPositions=function(v,T){var A=T.subtract(v),C=A.length();return{origin:v,direction:A.normalize(),distance:C}},t.prototype.hitFirst=function(v,T,A){var C="number"==typeof A?Gn.HitFirst+A:m();this.queries[C]=T,"undefined"!=typeof dcl&&dcl.query("raycast",{queryId:C,queryType:"HitFirst",ray:v})},t.prototype.hitAll=function(v,T,A){var C="number"==typeof A?Gn.HitAll+A:m();this.queries[C]=T,"undefined"!=typeof dcl&&dcl.query("raycast",{queryId:C,queryType:"HitAll",ray:v})},t.prototype.hitFirstAvatar=function(v,T){c("not implemented yet")},t.prototype.hitAllAvatars=function(v,T){c("not implemented yet")},t.prototype.handleRaycastHitFirstResponse=function(v){this.queries[v.payload.queryId](v.payload.payload),delete this.queries[v.payload.queryId]},t.prototype.handleRaycastHitAllResponse=function(v){this.queries[v.payload.queryId](v.payload.payload),delete this.queries[v.payload.queryId]},t}(),$n=function(){function t(){}return t.prototype.activate=function(v){v.eventManager.addListener(ut,this,(function(v){"HitFirst"===v.payload.queryType?Jn.instance.handleRaycastHitFirstResponse(v):"HitAll"===v.payload.queryType&&Jn.instance.handleRaycastHitAllResponse(v)})),"undefined"!=typeof dcl&&dcl.subscribe("raycastResponse")},t.prototype.deactivate=function(){"undefined"!=typeof dcl&&dcl.unsubscribe("raycastResponse")},t}(),ti=function(){function t(){}return t.prototype.activate=function(v){v.eventManager.addListener(ht,this,(function(v){fn.instance.handlePointerEvent(v.payload)})),"undefined"!=typeof dcl&&(dcl.subscribe("pointerUp"),dcl.subscribe("pointerDown"),dcl.subscribe("actionButtonEvent"))},t.prototype.deactivate=function(){"undefined"!=typeof dcl&&(dcl.unsubscribe("pointerUp"),dcl.unsubscribe("pointerDown"),dcl.unsubscribe("actionButtonEvent"))},t}(),ei=function(){function t(){this.handlerMap={}}return t.prototype.activate=function(v){v.eventManager.addListener(lt,this,this.handleEvent),v.eventManager.addListener(z,this,this.componentAdded),v.eventManager.addListener(O,this,this.componentRemoved),"undefined"!=typeof dcl&&dcl.subscribe("uuidEvent")},t.prototype.deactivate=function(){"undefined"!=typeof dcl&&dcl.unsubscribe("uuidEvent")},t.prototype.onAddEntity=function(v){for(var T in v.components){var A=v.components[T];A instanceof Un&&(this.handlerMap[A.uuid]=A)}},t.prototype.onRemoveEntity=function(v){for(var T in v.components){var A=v.components[T];A instanceof Un&&delete this.handlerMap[A.uuid]}},t.prototype.componentAdded=function(v){if(v.entity.isAddedToEngine()){var T=v.entity.components[v.componentName];T instanceof Un&&(this.handlerMap[T.uuid]=T)}},t.prototype.componentRemoved=function(v){v.entity.isAddedToEngine()&&v.component instanceof Un&&delete this.handlerMap[v.component.uuid]},t.prototype.handleEvent=function(v){if(v.uuid in this.handlerMap){var T=this.handlerMap[v.uuid];T&&T.callback&&"call"in T.callback&&T.callback(v.payload)}},t}(),ni=new $n,ii=new ti,oi=new ei,ri=function(T){function n(v){var A=T.call(this)||this;return A.loop=!1,A.volume=1,A.url=v,A}return i(n,T),r([J.readonly,s("design:type",String)],n.prototype,"url",void 0),r([J.field,s("design:type",Boolean)],n.prototype,"loop",void 0),r([J.field,s("design:type",String)],n.prototype,"loadingCompleteEventId",void 0),r([J.field,s("design:type",Number)],n.prototype,"volume",void 0),r([N("engine.AudioClip",v.CLASS_ID.AUDIO_CLIP),s("design:paramtypes",[String])],n)}(J),si=function(T){function n(v){var A=T.call(this)||this;if(A.audioClip=v,A.loop=!1,A.volume=1,A.playing=!1,A.pitch=1,A.playedAtTimestamp=Date.now(),!(v instanceof ri))throw new Error("Trying to create AudioSource(AudioClip) with an invalid AudioClip");return A.audioClipId=D(v),A}return i(n,T),n.prototype.playOnce=function(){return this.playing=!0,this.dirty=!0,this.playedAtTimestamp=Date.now(),this.data.nonce=Math.random(),this},r([J.readonly,s("design:type",String)],n.prototype,"audioClipId",void 0),r([J.field,s("design:type",Boolean)],n.prototype,"loop",void 0),r([J.field,s("design:type",Number)],n.prototype,"volume",void 0),r([J.field,s("design:type",Boolean)],n.prototype,"playing",void 0),r([J.field,s("design:type",Number)],n.prototype,"pitch",void 0),r([J.field,s("design:type",Number)],n.prototype,"playedAtTimestamp",void 0),r([P("engine.AudioSource",v.CLASS_ID.AUDIO_SOURCE),s("design:paramtypes",[ri])],n)}(J),ai=function(T){function n(v){var A=T.call(this)||this;return A.playing=!1,A.volume=1,A.url=v,A.playing=!0,A}return i(n,T),r([J.readonly,s("design:type",String)],n.prototype,"url",void 0),r([J.field,s("design:type",Boolean)],n.prototype,"playing",void 0),r([J.field,s("design:type",Number)],n.prototype,"volume",void 0),r([P("engine.AudioStream",v.CLASS_ID.AUDIO_STREAM),s("design:paramtypes",[String])],n)}(J);v.Gizmo=void 0,(Zn=v.Gizmo||(v.Gizmo={})).MOVE="MOVE",Zn.ROTATE="ROTATE",Zn.SCALE="SCALE",Zn.NONE="NONE";var ci,li=function(T){function n(){var v=null!==T&&T.apply(this,arguments)||this;return v.type="gizmoEvent",v}return i(n,T),r([J.readonly,s("design:type",String)],n.prototype,"type",void 0),r([P("engine.gizmoEvent",v.CLASS_ID.UUID_CALLBACK)],n)}(Un),ui=function(T){function n(){var v=null!==T&&T.apply(this,arguments)||this;return v.position=!0,v.rotation=!0,v.scale=!0,v.cycle=!0,v.localReference=!1,v}return i(n,T),r([J.field,s("design:type",Boolean)],n.prototype,"position",void 0),r([J.field,s("design:type",Boolean)],n.prototype,"rotation",void 0),r([J.field,s("design:type",Boolean)],n.prototype,"scale",void 0),r([J.field,s("design:type",Boolean)],n.prototype,"cycle",void 0),r([J.field,s("design:type",String)],n.prototype,"selectedGizmo",void 0),r([J.field,s("design:type",Boolean)],n.prototype,"localReference",void 0),r([P("engine.gizmos",v.CLASS_ID.GIZMOS)],n)}(J),hi=function(T){function n(v){var A=T.call(this,v)||this;return A.type="onFocus",oi.handlerMap[A.uuid]=A,A}return i(n,T),r([J.readonly,s("design:type",String)],n.prototype,"type",void 0),r([P("engine.onFocus",v.CLASS_ID.UUID_CALLBACK),s("design:paramtypes",[Function])],n)}(Un),pi=function(T){function n(v){var A=T.call(this,v)||this;return A.type="onTextSubmit",oi.handlerMap[A.uuid]=A,A}return i(n,T),r([J.readonly,s("design:type",String)],n.prototype,"type",void 0),r([P("engine.onTextSubmit",v.CLASS_ID.UUID_CALLBACK),s("design:paramtypes",[Function])],n)}(Un),di=function(T){function n(v){var A=T.call(this,v)||this;return A.type="onBlur",oi.handlerMap[A.uuid]=A,A}return i(n,T),r([J.readonly,s("design:type",String)],n.prototype,"type",void 0),r([P("engine.onBlur",v.CLASS_ID.UUID_CALLBACK),s("design:paramtypes",[Function])],n)}(Un),fi=function(T){function n(v){var A=T.call(this,v)||this;return A.type="onEnter",oi.handlerMap[A.uuid]=A,A}return i(n,T),r([J.readonly,s("design:type",String)],n.prototype,"type",void 0),r([P("engine.onEnter",v.CLASS_ID.UUID_CALLBACK),s("design:paramtypes",[Function])],n)}(Un),yi=function(T){function n(v){var A=T.call(this,v)||this;return A.type="onChange",oi.handlerMap[A.uuid]=A,A}return i(n,T),r([J.readonly,s("design:type",String)],n.prototype,"type",void 0),r([P("engine.onChange",v.CLASS_ID.UUID_CALLBACK),s("design:paramtypes",[Function])],n)}(Un),gi=function(T){function n(v,A){var C=T.call(this,v)||this;return C.type="onClick",oi.handlerMap[C.uuid]=C,A&&(C.showFeedback=!(!1===A.showFeedback),A.button&&(C.button=A.button),A.hoverText&&(C.hoverText=A.hoverText),A.distance&&(C.distance=A.distance)),C}return i(n,T),r([J.readonly,s("design:type",String)],n.prototype,"type",void 0),r([P("engine.onClick",v.CLASS_ID.UUID_CALLBACK),s("design:paramtypes",[Function,Object])],n)}(Vn),mi=function(T){function n(v,A){var C=T.call(this,v)||this;return C.type="pointerDown",oi.handlerMap[C.uuid]=C,A&&(C.showFeedback=!(!1===A.showFeedback),A.button&&(C.button=A.button),A.hoverText&&(C.hoverText=A.hoverText),A.distance&&(C.distance=A.distance)),C}return i(n,T),r([J.readonly,s("design:type",String)],n.prototype,"type",void 0),r([P("engine.pointerDown",v.CLASS_ID.UUID_CALLBACK),s("design:paramtypes",[Function,Object])],n)}(Vn),vi=function(T){function n(v,A){var C=T.call(this,v)||this;return C.type="pointerUp",oi.handlerMap[C.uuid]=C,A&&(C.showFeedback=!(!1===A.showFeedback),A.button&&(C.button=A.button),A.hoverText&&(C.hoverText=A.hoverText),A.distance&&(C.distance=A.distance)),C}return i(n,T),r([J.readonly,s("design:type",String)],n.prototype,"type",void 0),r([P("engine.pointerUp",v.CLASS_ID.UUID_CALLBACK),s("design:paramtypes",[Function,Object])],n)}(Vn),bi=function(T){function n(v,A){var C=T.call(this,v)||this;return C.type="pointerHoverEnter",oi.handlerMap[C.uuid]=C,A&&A.distance&&(C.distance=A.distance),C}return i(n,T),r([J.readonly,s("design:type",String)],n.prototype,"type",void 0),r([P("engine.pointerHoverEnter",v.CLASS_ID.UUID_CALLBACK),s("design:paramtypes",[Function,Object])],n)}(Vn),Ti=function(T){function n(v){var A=T.call(this,v)||this;return A.type="pointerHoverExit",oi.handlerMap[A.uuid]=A,A.distance=160,A}return i(n,T),r([J.readonly,s("design:type",String)],n.prototype,"type",void 0),r([P("engine.pointerHoverExit",v.CLASS_ID.UUID_CALLBACK),s("design:paramtypes",[Function])],n)}(Vn),wi=function(v){function e(T){var A=v.call(this)||this;return A.name=null,A.visible=!0,A.opacity=1,A.hAlign="center",A.vAlign="center",A.width="100px",A.height="50px",A.positionX="0px",A.positionY="0px",A.isPointerBlocker=!0,T&&(A._parent=T,A.data.parentComponent=D(T)),A}return i(e,v),Object.defineProperty(e.prototype,"parent",{get:function(){return this._parent},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parentComponent",{get:function(){return this.data.parentComponent},enumerable:!1,configurable:!0}),r([J.field,s("design:type",Object)],e.prototype,"name",void 0),r([J.field,s("design:type",Boolean)],e.prototype,"visible",void 0),r([J.field,s("design:type",Number)],e.prototype,"opacity",void 0),r([J.field,s("design:type",String)],e.prototype,"hAlign",void 0),r([J.field,s("design:type",String)],e.prototype,"vAlign",void 0),r([J.uiValue,s("design:type",Object)],e.prototype,"width",void 0),r([J.uiValue,s("design:type",Object)],e.prototype,"height",void 0),r([J.uiValue,s("design:type",Object)],e.prototype,"positionX",void 0),r([J.uiValue,s("design:type",Object)],e.prototype,"positionY",void 0),r([J.field,s("design:type",Boolean)],e.prototype,"isPointerBlocker",void 0),e}(J),Ai=function(T){function n(){return T.call(this,null)||this}return i(n,T),r([N("engine.shape",v.CLASS_ID.UI_FULLSCREEN_SHAPE),s("design:paramtypes",[])],n)}(wi),xi=function(T){function n(){return T.call(this,null)||this}return i(n,T),r([N("engine.shape",v.CLASS_ID.UI_WORLD_SPACE_SHAPE),s("design:paramtypes",[])],n)}(wi),Si=function(T){function n(){return T.call(this,null)||this}return i(n,T),r([N("engine.shape",v.CLASS_ID.UI_SCREEN_SPACE_SHAPE),s("design:paramtypes",[])],n)}(wi),_i=function(T){function n(){var v=null!==T&&T.apply(this,arguments)||this;return v.thickness=0,v.color=Pt.Color4.Clear(),v.alignmentUsesSize=!0,v}return i(n,T),r([J.field,s("design:type",Number)],n.prototype,"thickness",void 0),r([J.field,s("design:type",Pt.Color4)],n.prototype,"color",void 0),r([J.field,s("design:type",Boolean)],n.prototype,"alignmentUsesSize",void 0),r([N("engine.shape",v.CLASS_ID.UI_CONTAINER_RECT)],n)}(wi);v.UIStackOrientation=void 0,(ci=v.UIStackOrientation||(v.UIStackOrientation={}))[ci.VERTICAL=0]="VERTICAL",ci[ci.HORIZONTAL=1]="HORIZONTAL";var Ci=function(T){function n(){var A=null!==T&&T.apply(this,arguments)||this;return A.adaptWidth=!0,A.adaptHeight=!0,A.color=Pt.Color4.Clear(),A.stackOrientation=v.UIStackOrientation.VERTICAL,A.spacing=0,A}return i(n,T),r([J.field,s("design:type",Boolean)],n.prototype,"adaptWidth",void 0),r([J.field,s("design:type",Boolean)],n.prototype,"adaptHeight",void 0),r([J.field,s("design:type",Pt.Color4)],n.prototype,"color",void 0),r([J.field,s("design:type",Number)],n.prototype,"stackOrientation",void 0),r([J.field,s("design:type",Number)],n.prototype,"spacing",void 0),r([N("engine.shape",v.CLASS_ID.UI_CONTAINER_STACK)],n)}(wi),Ei=function(T){function n(){var v=null!==T&&T.apply(this,arguments)||this;return v.fontSize=10,v.fontWeight="normal",v.thickness=0,v.cornerRadius=0,v.color=Pt.Color4.White(),v.background=Pt.Color4.White(),v.paddingTop=0,v.paddingRight=0,v.paddingBottom=0,v.paddingLeft=0,v.shadowBlur=0,v.shadowOffsetX=0,v.shadowOffsetY=0,v.shadowColor=Pt.Color4.Black(),v.text="button",v}return i(n,T),r([J.field,s("design:type",Number)],n.prototype,"fontSize",void 0),r([J.field,s("design:type",String)],n.prototype,"fontWeight",void 0),r([J.field,s("design:type",Number)],n.prototype,"thickness",void 0),r([J.field,s("design:type",Number)],n.prototype,"cornerRadius",void 0),r([J.field,s("design:type",Pt.Color4)],n.prototype,"color",void 0),r([J.field,s("design:type",Pt.Color4)],n.prototype,"background",void 0),r([J.field,s("design:type",Number)],n.prototype,"paddingTop",void 0),r([J.field,s("design:type",Number)],n.prototype,"paddingRight",void 0),r([J.field,s("design:type",Number)],n.prototype,"paddingBottom",void 0),r([J.field,s("design:type",Number)],n.prototype,"paddingLeft",void 0),r([J.field,s("design:type",Number)],n.prototype,"shadowBlur",void 0),r([J.field,s("design:type",Number)],n.prototype,"shadowOffsetX",void 0),r([J.field,s("design:type",Number)],n.prototype,"shadowOffsetY",void 0),r([J.field,s("design:type",Pt.Color4)],n.prototype,"shadowColor",void 0),r([J.field,s("design:type",String)],n.prototype,"text",void 0),r([N("engine.shape",v.CLASS_ID.UI_BUTTON_SHAPE)],n)}(wi),Ii=function(T){function n(){var v=null!==T&&T.apply(this,arguments)||this;return v.outlineWidth=0,v.outlineColor=Pt.Color4.White(),v.color=Pt.Color4.White(),v.fontSize=10,v.fontAutoSize=!1,v.value="",v.lineSpacing=0,v.lineCount=0,v.adaptWidth=!1,v.adaptHeight=!1,v.textWrapping=!1,v.shadowBlur=0,v.shadowOffsetX=0,v.shadowOffsetY=0,v.shadowColor=Pt.Color4.Black(),v.hTextAlign="left",v.vTextAlign="bottom",v.paddingTop=0,v.paddingRight=0,v.paddingBottom=0,v.paddingLeft=0,v}return i(n,T),r([J.field,s("design:type",Number)],n.prototype,"outlineWidth",void 0),r([J.field,s("design:type",Pt.Color4)],n.prototype,"outlineColor",void 0),r([J.field,s("design:type",Pt.Color4)],n.prototype,"color",void 0),r([J.field,s("design:type",Number)],n.prototype,"fontSize",void 0),r([J.field,s("design:type",Boolean)],n.prototype,"fontAutoSize",void 0),r([J.component,s("design:type",zn)],n.prototype,"font",void 0),r([J.field,s("design:type",String)],n.prototype,"value",void 0),r([J.field,s("design:type",Number)],n.prototype,"lineSpacing",void 0),r([J.field,s("design:type",Number)],n.prototype,"lineCount",void 0),r([J.field,s("design:type",Boolean)],n.prototype,"adaptWidth",void 0),r([J.field,s("design:type",Boolean)],n.prototype,"adaptHeight",void 0),r([J.field,s("design:type",Boolean)],n.prototype,"textWrapping",void 0),r([J.field,s("design:type",Number)],n.prototype,"shadowBlur",void 0),r([J.field,s("design:type",Number)],n.prototype,"shadowOffsetX",void 0),r([J.field,s("design:type",Number)],n.prototype,"shadowOffsetY",void 0),r([J.field,s("design:type",Pt.Color4)],n.prototype,"shadowColor",void 0),r([J.field,s("design:type",String)],n.prototype,"hTextAlign",void 0),r([J.field,s("design:type",String)],n.prototype,"vTextAlign",void 0),r([J.field,s("design:type",Number)],n.prototype,"paddingTop",void 0),r([J.field,s("design:type",Number)],n.prototype,"paddingRight",void 0),r([J.field,s("design:type",Number)],n.prototype,"paddingBottom",void 0),r([J.field,s("design:type",Number)],n.prototype,"paddingLeft",void 0),r([N("engine.shape",v.CLASS_ID.UI_TEXT_SHAPE)],n)}(wi),Oi=function(T){function n(v){var A=T.call(this,v)||this;return A.outlineWidth=0,A.outlineColor=Pt.Color4.Black(),A.color=Pt.Color4.Clear(),A.fontSize=10,A.value="",A.placeholder="",A.margin=10,A.hTextAlign="left",A.vTextAlign="bottom",A.focusedBackground=Pt.Color4.Black(),A.textWrapping=!1,A.shadowBlur=0,A.shadowOffsetX=0,A.shadowOffsetY=0,A.shadowColor=Pt.Color4.White(),A.paddingTop=0,A.paddingRight=0,A.paddingBottom=0,A.paddingLeft=0,A.onTextSubmit=null,A.onChanged=null,A.onFocus=null,A.onBlur=null,A.onTextChanged=new yi((function(v){var T=v.value,C=T.value,E=T.isSubmit,R=A.dirty;if(A.value=C,A.dirty=R,E&&A.onTextSubmit){var O={text:C};A.onTextSubmit.callback(O)}else if(!E&&A.onChanged){var z={value:C,pointerId:v.pointerId};A.onChanged.callback(z)}})),A}return i(n,T),r([J.field,s("design:type",Number)],n.prototype,"outlineWidth",void 0),r([J.field,s("design:type",Pt.Color4)],n.prototype,"outlineColor",void 0),r([J.field,s("design:type",Pt.Color4)],n.prototype,"color",void 0),r([J.field,s("design:type",Number)],n.prototype,"fontSize",void 0),r([J.component,s("design:type",zn)],n.prototype,"font",void 0),r([J.field,s("design:type",String)],n.prototype,"value",void 0),r([J.field,s("design:type",String)],n.prototype,"placeholder",void 0),r([J.field,s("design:type",Number)],n.prototype,"margin",void 0),r([J.field,s("design:type",String)],n.prototype,"hTextAlign",void 0),r([J.field,s("design:type",String)],n.prototype,"vTextAlign",void 0),r([J.field,s("design:type",Pt.Color4)],n.prototype,"focusedBackground",void 0),r([J.field,s("design:type",Boolean)],n.prototype,"textWrapping",void 0),r([J.field,s("design:type",Number)],n.prototype,"shadowBlur",void 0),r([J.field,s("design:type",Number)],n.prototype,"shadowOffsetX",void 0),r([J.field,s("design:type",Number)],n.prototype,"shadowOffsetY",void 0),r([J.field,s("design:type",Pt.Color4)],n.prototype,"shadowColor",void 0),r([J.field,s("design:type",Number)],n.prototype,"paddingTop",void 0),r([J.field,s("design:type",Number)],n.prototype,"paddingRight",void 0),r([J.field,s("design:type",Number)],n.prototype,"paddingBottom",void 0),r([J.field,s("design:type",Number)],n.prototype,"paddingLeft",void 0),r([Un.uuidEvent,s("design:type",yi)],n.prototype,"onTextChanged",void 0),r([Un.uuidEvent,s("design:type",Object)],n.prototype,"onFocus",void 0),r([Un.uuidEvent,s("design:type",Object)],n.prototype,"onBlur",void 0),r([N("engine.shape",v.CLASS_ID.UI_INPUT_TEXT_SHAPE),s("design:paramtypes",[Object])],n)}(wi),Pi=function(T){function n(v,A){var C=T.call(this,v)||this;return C.sourceLeft=0,C.sourceTop=0,C.sourceWidth=1,C.sourceHeight=1,C.paddingTop=0,C.paddingRight=0,C.paddingBottom=0,C.paddingLeft=0,C.sizeInPixels=!0,C.onClick=null,C.source=A,C}return i(n,T),r([J.field,s("design:type",Number)],n.prototype,"sourceLeft",void 0),r([J.field,s("design:type",Number)],n.prototype,"sourceTop",void 0),r([J.field,s("design:type",Number)],n.prototype,"sourceWidth",void 0),r([J.field,s("design:type",Number)],n.prototype,"sourceHeight",void 0),r([J.component,s("design:type",Object)],n.prototype,"source",void 0),r([J.field,s("design:type",Number)],n.prototype,"paddingTop",void 0),r([J.field,s("design:type",Number)],n.prototype,"paddingRight",void 0),r([J.field,s("design:type",Number)],n.prototype,"paddingBottom",void 0),r([J.field,s("design:type",Number)],n.prototype,"paddingLeft",void 0),r([J.field,s("design:type",Boolean)],n.prototype,"sizeInPixels",void 0),r([Un.uuidEvent,s("design:type",Object)],n.prototype,"onClick",void 0),r([N("engine.shape",v.CLASS_ID.UI_IMAGE_SHAPE),s("design:paramtypes",[wi,Object])],n)}(wi),Di=function(T){function n(){var v=null!==T&&T.apply(this,arguments)||this;return v.valueX=0,v.valueY=0,v.backgroundColor=Pt.Color4.Clear(),v.isHorizontal=!1,v.isVertical=!1,v.paddingTop=0,v.paddingRight=0,v.paddingBottom=0,v.paddingLeft=0,v.onChanged=null,v}return i(n,T),r([J.field,s("design:type",Number)],n.prototype,"valueX",void 0),r([J.field,s("design:type",Number)],n.prototype,"valueY",void 0),r([J.field,s("design:type",Pt.Color4)],n.prototype,"backgroundColor",void 0),r([J.field,s("design:type",Boolean)],n.prototype,"isHorizontal",void 0),r([J.field,s("design:type",Boolean)],n.prototype,"isVertical",void 0),r([J.field,s("design:type",Number)],n.prototype,"paddingTop",void 0),r([J.field,s("design:type",Number)],n.prototype,"paddingRight",void 0),r([J.field,s("design:type",Number)],n.prototype,"paddingBottom",void 0),r([J.field,s("design:type",Number)],n.prototype,"paddingLeft",void 0),r([Un.uuidEvent,s("design:type",Object)],n.prototype,"onChanged",void 0),r([N("engine.shape",v.CLASS_ID.UI_SLIDER_SHAPE)],n)}(wi),Ni=function(T){function n(){var v=null!==T&&T.apply(this,arguments)||this;return v.useDummyModel=!1,v.talking=!1,v}var A;return i(n,T),A=n,n.Dummy=function(){var v=new A;return v.useDummyModel=!0,v},r([J.field,s("design:type",String)],n.prototype,"id",void 0),r([J.field,s("design:type",String)],n.prototype,"name",void 0),r([J.field,s("design:type",String)],n.prototype,"expressionTriggerId",void 0),r([J.field,s("design:type",Number)],n.prototype,"expressionTriggerTimestamp",void 0),r([J.field,s("design:type",String)],n.prototype,"bodyShape",void 0),r([J.field,s("design:type",Array)],n.prototype,"wearables",void 0),r([J.field,s("design:type",Object)],n.prototype,"skinColor",void 0),r([J.field,s("design:type",Object)],n.prototype,"hairColor",void 0),r([J.field,s("design:type",Object)],n.prototype,"eyeColor",void 0),r([J.field,s("design:type",Boolean)],n.prototype,"useDummyModel",void 0),r([J.field,s("design:type",Boolean)],n.prototype,"talking",void 0),A=r([P("engine.avatarShape",v.CLASS_ID.AVATAR_SHAPE)],n)}(J),zi=null,Li=null,Mi=null;function Ri(){return Mi||(Mi=new ct),Mi}var Fi=function(){function t(){var v=this;this.messageQueue=[],this.connected=!1,this.flushing=!1,function(){if(!Li){(Li=dcl.loadModule("@decentraland/CommunicationsController",{})).then((function(v){zi=v}));var v=Ri();dcl.subscribe("comms"),dcl.onEvent((function(T){"comms"===T.type&&v.notifyObservers(T.data)}))}return Li}().then((function(){v.connected=!0,v.flush()}))}return t.prototype.on=function(v,T){return Ri().add((function(A){try{var C=JSON.parse(A.message);C.message===v&&T(C.payload,A.sender)}catch(A){dcl.error("Error parsing comms message "+(A.message||""),A)}}))},t.prototype.sendRaw=function(v){this.messageQueue.push(v),this.connected&&this.flush()},t.prototype.emit=function(v,T){var A=JSON.stringify({message:v,payload:T});this.sendRaw(A),Ri().notifyObservers({message:A,sender:"self"})},t.prototype.flush=function(){var v=this;if(0!==this.messageQueue.length&&this.connected&&zi&&!this.flushing){var T=this.messageQueue.shift();this.flushing=!0,dcl.callRpc(zi.rpcHandle,"send",[T]).then((function(T){v.flushing=!1,v.flush()}),(function(T){v.flushing=!1,y("Error flushing MessageBus",T)}))}},t}(),Bi=new et("scene");Bi.uuid="0";var ki=new nt(Bi);N.engine=ki,"undefined"!=typeof dcl&&(ki.addSystem(new Rt(dcl),1/0),mt(dcl)),ki.addSystem(oi),ki.addSystem(ii),ki.addSystem(ni),v.AVATAR_OBSERVABLE="AVATAR_OBSERVABLE",v.Angle=Pt.Angle,v.AnimationState=ln,v.Animator=Dn,v.Arc2=Pt.Arc2,v.AttachToAvatar=bn,v.Attachable=T,v.AudioClip=ri,v.AudioSource=si,v.AudioStream=ai,v.AvatarModifierArea=gn,v.AvatarShape=Ni,v.AvatarTexture=Qn,v.Axis=Pt.Axis,v.BasicMaterial=kn,v.BezierCurve=Pt.BezierCurve,v.Billboard=Tn,v.BoxShape=An,v.Camera=Kn,v.CameraModeArea=Yn,v.CircleShape=Sn,v.Color3=Pt.Color3,v.Color4=Pt.Color4,v.Component=P,v.ComponentAdded=z,v.ComponentGroup=$,v.ComponentRemoved=O,v.ConeShape=Cn,v.Curve3=Pt.Curve3,v.CylinderShape=En,v.DEG2RAD=Pt.DEG2RAD,v.DisposableComponent=N,v.DisposableComponentCreated=X,v.DisposableComponentRemoved=K,v.DisposableComponentUpdated=Z,v.Engine=nt,v.Entity=et,v.Epsilon=Pt.Epsilon,v.EventConstructor=x,v.EventManager=E,v.Font=zn,v.Frustum=Pt.Frustum,v.GLTFShape=In,v.Gizmos=ui,v.GlobalPointerDown=pn,v.GlobalPointerUp=dn,v.Input=fn,v.Material=Bn,v.Matrix=Pt.Matrix,v.MessageBus=Fi,v.MultiObserver=at,v.NFTShape=On,v.OBJShape=Nn,v.Observable=ct,v.ObservableComponent=J,v.Observer=Y,v.ObserverEventState=st,v.OnAnimationEnd=Wn,v.OnBlur=di,v.OnChanged=yi,v.OnClick=gi,v.OnEnter=fi,v.OnFocus=hi,v.OnGizmoEvent=li,v.OnPointerDown=mi,v.OnPointerHoverEnter=bi,v.OnPointerHoverExit=Ti,v.OnPointerLock=Hn,v.OnPointerUUIDEvent=Vn,v.OnPointerUp=vi,v.OnTextSubmit=pi,v.OnUUIDEvent=Un,v.Orientation=Pt.Orientation,v.ParentChanged=M,v.Path2=Pt.Path2,v.Path3D=Pt.Path3D,v.PhysicsCast=Jn,v.Plane=Pt.Plane,v.PlaneShape=_n,v.PointerEvent=ht,v.PointerEventComponent=Ke,v.PointerEventSystem=ti,v.Quaternion=Pt.Quaternion,v.RAD2DEG=Pt.RAD2DEG,v.RaycastEventSystem=$n,v.RaycastResponse=ut,v.Scalar=Pt.Scalar,v.Shape=wn,v.Size=Pt.Size,v.SmartItem=jn,v.Space=Pt.Space,v.SphereShape=xn,v.Subscription=en,v.TextShape=Mn,v.Texture=Pn,v.ToGammaSpace=Pt.ToGammaSpace,v.ToLinearSpace=Pt.ToLinearSpace,v.Transform=mn,v.UIButton=Ei,v.UICanvas=Si,v.UIContainerRect=_i,v.UIContainerStack=Ci,v.UIFullScreen=Ai,v.UIImage=Pi,v.UIInputText=Oi,v.UIScrollRect=Di,v.UIShape=wi,v.UIText=Ii,v.UIValue=V,v.UIWorldSpace=xi,v.UUIDEvent=lt,v.UUIDEventSystem=ei,v.Vector2=Pt.Vector2,v.Vector3=Pt.Vector3,v.Vector4=Pt.Vector4,v.VideoClip=qn,v.VideoTexture=Xn,v._initEventObservables=mt,v.buildArray=function(v,T){for(var A=[],C=0;C<v;++C)A.push(T());return A},v.engine=ki,v.error=y,v.executeTask=G,v.getComponentClassId=L,v.getComponentId=D,v.getComponentName=F,v.getMessageObserver=Ri,v.isDisposableComponent=U,v.log=c,v.newId=f,v.onCameraModeChangedObservable=pt,v.onEnterScene=yt,v.onEnterSceneObservable=ft,v.onIdleStateChangedObservable=dt,v.onLeaveScene=vt,v.onLeaveSceneObservable=gt,v.onPlayerClickedObservable=It,v.onPlayerConnectedObservable=St,v.onPlayerDisconnectedObservable=_t,v.onPlayerExpressionObservable=Tt,v.onPointerLockedStateChange=wt,v.onProfileChanged=xt,v.onRealmChangedObservable=Ct,v.onSceneReadyObservable=bt,v.onVideoEvent=At,v.openExternalURL=function(v){"undefined"!=typeof dcl?dcl.openExternalUrl(v):y("ERROR: openExternalURL dcl is undefined")},v.openNFTDialog=function(v,T){if(void 0===T&&(T=null),"undefined"!=typeof dcl){var A=v.match(/ethereum:\/\/(.+)\/(.+)/);if(!A||A.length<3)return;dcl.openNFTDialog(A[1],A[2],T)}else y("ERROR: openNFTDialog dcl is undefined")},v.pointerEventSystem=ii,v.raycastEventSystem=ni,v.teleportTo=function(v){var T;T=[v],void 0===ot&&"undefined"!=typeof dcl&&(ot=dcl.loadModule("@decentraland/UserActionModule",{})),void 0!==ot&&"undefined"!=typeof dcl&&ot.then((function(v){dcl.callRpc(v.rpcHandle,"requestTeleport",T)}))},v.uuid=m,v.uuidEventSystem=oi,Object.defineProperty(v,"__esModule",{value:!0})}(this.self=this.self||{}),define("@dcl/ecs-scene-utils",["exports","@decentraland/EnvironmentAPI"],(function(v,T){
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */
var n=function(v,T){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,T){v.__proto__=T}||function(v,T){for(var A in T)Object.prototype.hasOwnProperty.call(T,A)&&(v[A]=T[A])})(v,T)};function i(v,T){function i(){this.constructor=v}n(v,T),v.prototype=null===T?Object.create(T):(i.prototype=T.prototype,new i)}function r(v,T,A,C){var E,R=arguments.length,O=R<3?T:null===C?C=Object.getOwnPropertyDescriptor(T,A):C;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)O=Reflect.decorate(v,T,A,C);else for(var z=v.length-1;z>=0;z--)(E=v[z])&&(O=(R<3?E(O):R>3?E(T,A,O):E(T,A))||O);return R>3&&O&&Object.defineProperty(T,A,O),O}function o(v,T,A,C){return new(A||(A=Promise))((function(E,R){function a(v){try{u(C.next(v))}catch(v){R(v)}}function s(v){try{u(C.throw(v))}catch(v){R(v)}}function u(v){var T;v.done?E(v.value):(T=v.value,T instanceof A?T:new A((function(v){v(T)}))).then(a,s)}u((C=C.apply(v,T||[])).next())}))}function a(v,T){var A,C,E,R,O={label:0,sent:function(){if(1&E[0])throw E[1];return E[1]},trys:[],ops:[]};return R={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(R[Symbol.iterator]=function(){return this}),R;function s(R){return function(z){return function(R){if(A)throw new TypeError("Generator is already executing.");for(;O;)try{if(A=1,C&&(E=2&R[0]?C.return:R[0]?C.throw||((E=C.return)&&E.call(C),0):C.next)&&!(E=E.call(C,R[1])).done)return E;switch(C=0,E&&(R=[2&R[0],E.value]),R[0]){case 0:case 1:E=R;break;case 4:return O.label++,{value:R[1],done:!1};case 5:O.label++,C=R[1],R=[0];continue;case 7:R=O.ops.pop(),O.trys.pop();continue;default:if(!((E=(E=O.trys).length>0&&E[E.length-1])||6!==R[0]&&2!==R[0])){O=0;continue}if(3===R[0]&&(!E||R[1]>E[0]&&R[1]<E[3])){O.label=R[1];break}if(6===R[0]&&O.label<E[1]){O.label=E[1],E=R;break}if(E&&O.label<E[2]){O.label=E[2],O.ops.push(R);break}E[2]&&O.ops.pop(),O.trys.pop();continue}R=T.call(v,O)}catch(v){R=[6,v],C=0}finally{A=E=0}if(5&R[0])throw R[1];return{value:R[0]?R[1]:void 0,done:!0}}([R,z])}}}function s(v){var T="function"==typeof Symbol&&Symbol.iterator,A=T&&v[T],C=0;if(A)return A.call(v);if(v&&"number"==typeof v.length)return{next:function(){return v&&C>=v.length&&(v=void 0),{value:v&&v[C++],done:!v}}};throw new TypeError(T?"Object is not iterable.":"Symbol.iterator is not defined.")}var A,C=function(){function e(){this._components=[],this._componentGroups=[],e._instance=this}return e.createAndAddToEngine=function(){return null==this._instance&&(this._instance=new e,engine.addSystem(this._instance)),this._instance},e.registerCustomComponent=function(v){this.createAndAddToEngine()._components.push(v)},e.prototype.addComponentType=function(v){var T,A;try{for(var C=s(this._components),E=C.next();!E.done;E=C.next())if(v==E.value)return}catch(v){T={error:v}}finally{try{E&&!E.done&&(A=C.return)&&A.call(C)}finally{if(T)throw T.error}}this._components.push(v),this._componentGroups.push(engine.getComponentGroup(v,Transform))},e.prototype.update=function(v){for(var T=0;T<this._components.length;T++)this.updateComponent(v,this._components[T],this._componentGroups[T])},e.prototype.updateComponent=function(v,T,A){A.entities.forEach((function(A){var C=A.getComponent(Transform),E=A.getComponent(T);E.update(v),E.assignValueToTransform(C),E.hasFinished()&&(A.removeComponent(E),null!=E.onFinishCallback&&E.onFinishCallback())}))},e._instance=null,e}();function h(T,A){switch(T){case v.InterpolationType.LINEAR:return A;case v.InterpolationType.EASEINQUAD:return function(v){return v*v}(A);case v.InterpolationType.EASEOUTQUAD:return function(v){return v*(2-v)}(A);case v.InterpolationType.EASEQUAD:return function(v){return v*v/(2*(v*v-v)+1)}(A);case v.InterpolationType.EASEINSINE:return function(v){return 1-Math.cos(v*Math.PI/2)}(A);case v.InterpolationType.EASEOUTSINE:return function(v){return Math.sin(v*Math.PI/2)}(A);case v.InterpolationType.EASESINE:return function(v){return-(Math.cos(Math.PI*v)-1)/2}(A);case v.InterpolationType.EASEINEXPO:return function(v){return 0===v?0:Math.pow(2,10*v-10)}(A);case v.InterpolationType.EASEOUTEXPO:return function(v){return 1===v?1:1-Math.pow(2,-10*v)}(A);case v.InterpolationType.EASEEXPO:return function(v){return 0===v?0:1===v?1:v<.5?Math.pow(2,20*v-10)/2:(2-Math.pow(2,-20*v+10))/2}(A);case v.InterpolationType.EASEINELASTIC:return function(v){var T=2*Math.PI/3;return 0===v?0:1===v?1:-Math.pow(2,10*v-10)*Math.sin((10*v-10.75)*T)}(A);case v.InterpolationType.EASEOUTELASTIC:return function(v){var T=2*Math.PI/3;return 0===v?0:1===v?1:Math.pow(2,-10*v)*Math.sin((10*v-.75)*T)+1}(A);case v.InterpolationType.EASEELASTIC:return function(v){var T=2*Math.PI/4.5;return 0===v?0:1===v?1:v<.5?-Math.pow(2,20*v-10)*Math.sin((20*v-11.125)*T)/2:Math.pow(2,-20*v+10)*Math.sin((20*v-11.125)*T)/2+1}(A);case v.InterpolationType.EASEINBOUNCE:return function(v){return 1-l(1-v)}(A);case v.InterpolationType.EASEOUTEBOUNCE:return function(v){return l(v)}(A);case v.InterpolationType.EASEBOUNCE:return function(v){return v<.5?(1-l(1-2*v))/2:(1+l(2*v-1))/2}(A);default:return A}}function l(v){var T=7.5625,A=2.75;return v<1/A?T*v*v:v<2/A?T*(v-=1.5/A)*v+.75:v<2.5/A?T*(v-=2.25/A)*v+.9375:T*(v-=2.625/A)*v+.984375}v.InterpolationType=void 0,(A=v.InterpolationType||(v.InterpolationType={}))[A.LINEAR=0]="LINEAR",A[A.EASEINQUAD=1]="EASEINQUAD",A[A.EASEOUTQUAD=2]="EASEOUTQUAD",A[A.EASEQUAD=3]="EASEQUAD",A.EASEINSINE="easeinsine",A.EASEOUTSINE="easeoutsine",A.EASESINE="easeinoutsine",A.EASEINEXPO="easeinexpo",A.EASEOUTEXPO="easeoutexpo",A.EASEEXPO="easeinoutexpo",A.EASEINELASTIC="easeinelastic",A.EASEOUTELASTIC="easeoutelastic",A.EASEELASTIC="easeinoutelastic",A.EASEINBOUNCE="easeinbounce",A.EASEOUTEBOUNCE="easeoutbounce",A.EASEBOUNCE="easeinoutbounce";var E,R=function(){function t(A,E,R,O,z){void 0===z&&(z=v.InterpolationType.LINEAR),this.start=A,this.end=E,this.normalizedTime=0,this.lerpTime=0,this.onFinishCallback=O,this.interpolationType=z,0!=R?this.speed=1/R:(this.speed=0,this.normalizedTime=1,this.lerpTime=1),C.createAndAddToEngine().addComponentType(T)}var T;return T=t,t.prototype.update=function(v){this.normalizedTime=Scalar.Clamp(this.normalizedTime+v*this.speed,0,1),this.lerpTime=h(this.interpolationType,this.normalizedTime)},t.prototype.hasFinished=function(){return this.normalizedTime>=1},t.prototype.assignValueToTransform=function(v){v.position=Vector3.Lerp(this.start,this.end,this.lerpTime)},T=r([Component("moveTransformComponent")],t)}(),O=function(){function t(A,E,R,O,z){void 0===z&&(z=v.InterpolationType.LINEAR),this.start=A,this.end=E,this.normalizedTime=0,this.lerpTime=0,this.onFinishCallback=O,this.interpolationType=z,0!=R?this.speed=1/R:(this.speed=0,this.normalizedTime=1,this.lerpTime=1),C.createAndAddToEngine().addComponentType(T)}var T;return T=t,t.prototype.update=function(v){this.normalizedTime=Scalar.Clamp(this.normalizedTime+v*this.speed,0,1),this.lerpTime=h(this.interpolationType,this.normalizedTime)},t.prototype.hasFinished=function(){return this.normalizedTime>=1},t.prototype.assignValueToTransform=function(v){v.rotation=Quaternion.Slerp(this.start,this.end,this.lerpTime)},T=r([Component("rotateTransformComponent")],t)}(),z=function(){function t(A,E,R,O,z){void 0===z&&(z=v.InterpolationType.LINEAR),this.start=A,this.end=E,this.normalizedTime=0,this.lerpTime=0,this.onFinishCallback=O,this.interpolationType=z,0!=R?this.speed=1/R:(this.speed=0,this.normalizedTime=1,this.lerpTime=1),C.createAndAddToEngine().addComponentType(T)}var T;return T=t,t.prototype.update=function(v){this.normalizedTime=Scalar.Clamp(this.normalizedTime+v*this.speed,0,1),this.lerpTime=h(this.interpolationType,this.normalizedTime)},t.prototype.hasFinished=function(){return this.normalizedTime>=1},t.prototype.assignValueToTransform=function(v){v.scale=Vector3.Lerp(this.start,this.end,this.lerpTime)},T=r([Component("scaleTransformComponent")],t)}(),M=function(){function e(T,A,E,R){if(this.speed=[],this.normalizedTime=0,this.currentIndex=0,this.points=T,this.onFinishCallback=E,this.onPointReachedCallback=R,T.length<2)throw new Error("At least 2 points are needed for FollowPathComponent.");if(A>0){for(var O=0,z=[],M=0;M<T.length-1;M++){var V=Vector3.Distance(T[M],T[M+1]);O+=V,z.push(V)}for(M=0;M<z.length;M++)this.speed.push(1/(z[M]/O*A))}else this.normalizedTime=1,this.currentIndex=T.length-2;C.createAndAddToEngine().addComponentType(v)}var v;return v=e,e.prototype.update=function(v){this.normalizedTime=Scalar.Clamp(this.normalizedTime+v*this.speed[this.currentIndex],0,1),this.normalizedTime>=1&&this.currentIndex<this.points.length-2&&(this.currentIndex++,this.normalizedTime=0,this.onPointReachedCallback&&this.currentIndex<this.points.length-1&&this.onPointReachedCallback(this.points[this.currentIndex],this.points[this.currentIndex+1]))},e.prototype.hasFinished=function(){return this.currentIndex>=this.points.length-2&&this.normalizedTime>=1},e.prototype.assignValueToTransform=function(v){v.position=Vector3.Lerp(this.points[this.currentIndex],this.points[this.currentIndex+1],this.normalizedTime)},v=r([Component("followPathComponent")],e)}(),V=function(){function e(T,A,E,R,O,z){if(this.speed=[],this.turnToFaceNext=!1,this.facingNext=!1,this.normalizedTime=0,this.currentIndex=0,this.points=Curve3.CreateCatmullRomSpline(T,E,!!O).getPoints(),this.onFinishCallback=z,this.turnToFaceNext=R||!1,this.points.length<2)throw new Error("At least 2 points are needed for FollowPathComponent.");if(A>0){for(var M=0,V=[],H=0;H<this.points.length-1;H++){var W=Vector3.Distance(this.points[H],this.points[H+1]);M+=W,V.push(W)}for(H=0;H<V.length;H++)this.speed.push(1/(V[H]/M*A))}else this.normalizedTime=1,this.currentIndex=T.length-2;C.createAndAddToEngine().addComponentType(v)}var v;return v=e,e.prototype.update=function(v){this.normalizedTime=Scalar.Clamp(this.normalizedTime+v*this.speed[this.currentIndex],0,1),this.normalizedTime>=1&&this.currentIndex<this.points.length-2&&(this.currentIndex++,this.normalizedTime=0,1==this.turnToFaceNext&&(this.facingNext=!1))},e.prototype.hasFinished=function(){return this.currentIndex>=this.points.length-2&&this.normalizedTime>=1},e.prototype.assignValueToTransform=function(v){v.position=Vector3.Lerp(this.points[this.currentIndex],this.points[this.currentIndex+1],this.normalizedTime),this.facingNext||(this.facingNext=!0,this.currentIndex<this.points.length-1?v.lookAt(this.points[this.currentIndex+1]):v.lookAt(this.points[0]))},v=r([Component("followCurvedPathComponent")],e)}(),H=function(){function e(T,A){this.rotationVelocity=T,this.onFinishCallback=A,this.rotation=Quaternion.Identity,this.finished=!1,C.createAndAddToEngine().addComponentType(v)}var v;return v=e,e.prototype.update=function(v){this.rotation=Quaternion.Slerp(Quaternion.Identity,this.rotationVelocity,v)},e.prototype.hasFinished=function(){return this.finished},e.prototype.assignValueToTransform=function(v){v.rotation=v.rotation.multiply(this.rotation)},e.prototype.stop=function(){this.finished=!0},v=r([Component("keepRotatingComponent")],e)}();v.ToggleState=void 0,(E=v.ToggleState||(v.ToggleState={}))[E.Off=0]="Off",E[E.On=1]="On";var W=function(){function t(T,A){void 0===T&&(T=v.ToggleState.On),this.enabled=!0,this.state=v.ToggleState.Off,this.set(T),A&&this.setCallback(A)}return t.prototype.set=function(v){this.state=v,this.onValueChangedCallback&&this.onValueChangedCallback(v)},t.prototype.toggle=function(){this.enabled&&this.set(1-this.state)},t.prototype.isOn=function(){return this.state==v.ToggleState.On},t.prototype.setCallback=function(v){this.onValueChangedCallback=v},r([Component("toggle")],t)}(),j=function(){function e(){this._components=[],e._instance=this}return e.createAndAddToEngine=function(){return null==this._instance&&(this._instance=new e,engine.addSystem(this._instance)),this._instance},e.registerCustomComponent=function(v){this.createAndAddToEngine()._components.push(v)},e.prototype.addComponentType=function(v){var T,A;try{for(var C=s(this._components),E=C.next();!E.done;E=C.next())if(v==E.value)return}catch(v){T={error:v}}finally{try{E&&!E.done&&(A=C.return)&&A.call(C)}finally{if(T)throw T.error}}this._components.push(v)},e.prototype.update=function(v){var T=this;this._components.forEach((function(A){T.updateComponent(v,A)}))},e.prototype.updateComponent=function(v,T){var A=engine.getEntitiesWithComponent(T);for(var C in A)if(A.hasOwnProperty(C)){var E=A[C],R=E.getComponent(T);R.elapsedTime+=v,R.elapsedTime>=R.targetTime&&R.onTargetTimeReached(E)}},e._instance=null,e}(),X=function(){function e(T,A){var C=this;j.createAndAddToEngine().addComponentType(v),this.elapsedTime=0,this.targetTime=T/1e3,this.onTimeReachedCallback=A,this.onTargetTimeReached=function(v){C.onTimeReachedCallback&&C.onTimeReachedCallback(),v.removeComponent(C)}}var v;return v=e,e.prototype.setCallback=function(v){this.onTimeReachedCallback=v},v=r([Component("timerDelay")],e)}(),K=function(){function e(T,A){var C=this;j.createAndAddToEngine().addComponentType(v),this.elapsedTime=0,this.targetTime=T/1e3,this.onTimeReachedCallback=A,this.onTargetTimeReached=function(v){C.onTimeReachedCallback&&C.onTimeReachedCallback(),v.removeComponent(C),engine.removeEntity(v)}}var v;return v=e,e.prototype.setCallback=function(v){this.onTimeReachedCallback=v},v=r([Component("timerExpireIn")],e)}(),Z=function(){function e(T,A){var C=this;j.createAndAddToEngine().addComponentType(v),this.elapsedTime=0,this.targetTime=T/1e3,this.onTimeReachedCallback=A,this.onTargetTimeReached=function(){C.elapsedTime=0,C.onTimeReachedCallback&&C.onTimeReachedCallback()}}var v;return v=e,e.prototype.setCallback=function(v){this.onTimeReachedCallback=v},v=r([Component("timerInterval")],e)}();function I(v,T,A,C,E,R){var O=new Entity;O.addComponent(new Transform(R||{position:new Vector3(0,1.5,0)})),O.setParent(T);var z=new TextShape(v);return z.fontSize=E||3,z.color=C||Color3.Black(),O.addComponent(z),A&&O.addComponent(new Billboard),engine.addEntity(O),O}var J,$,et=function(){function e(){this._triggers={},e._instance=this,this._cameraTriggerWrapper=new it(new P(new Vector3(.5,1.8,.5),new Vector3(0,.91,0))),this._componentGroup=engine.getComponentGroup(ot)}return Object.defineProperty(e,"instance",{get:function(){return this.createAndAddToEngine()},enumerable:!1,configurable:!0}),e.createAndAddToEngine=function(){return null==this._instance&&(this._instance=new e,engine.addSystem(this._instance)),this._instance},e.prototype.setCameraTriggerShape=function(v){this._cameraTriggerWrapper.setShape(v)},e.prototype.update=function(){var v=this,T=this._componentGroup.entities;for(var A in T.forEach((function(T){v.shouldWrapTriggerEntity(T)&&v.wrapTriggerEntity(T)})),this._triggers)if(this._triggers.hasOwnProperty(A)){var C=this._triggers[A];C.isDebugging()&&C.updateDebugEntity(),C.isInEngine()?null!=C.trigger&&C.trigger.enabled?(C.wasEnabled||C.isDebugging()&&C.addDebugEntity(),C.wasEnabled=!0,(C.trigger.onCameraEnter||C.trigger.onCameraExit)&&this.checkCollisionAgainstCamera(C),(C.trigger.onTriggerEnter||C.trigger.onTriggerExit)&&this.checkCollisionAgainstOtherTriggers(C)):C.wasEnabled&&(C.wasEnabled=!1,C.isDebugging()&&C.removeDebugEntity(),e.removeTriggerFromSystem(C)):(C.isDebugging()&&C.removeDebugEntity(),e.removeTriggerFromSystem(C),delete this._triggers[A])}},e.prototype.shouldWrapTriggerEntity=function(v){return null==this._triggers[v.uuid]||null==this._triggers[v.uuid]},e.prototype.wrapTriggerEntity=function(v){this._triggers[v.uuid]=new nt(v)},e.removeTriggerFromSystem=function(v){for(var T,A=v.getActiveCollisions(),C=0;C<A.length;C++)!(A[C]===(null===(T=e._instance)||void 0===T?void 0:T._cameraTriggerWrapper)||null==A[C].trigger)&&A[C].trigger.onTriggerExit&&v.entity&&A[C].trigger.onTriggerExit(v.entity),A[C].disengageActiveCollision(v),v.disengageActiveCollision(A[C])},e.disengageCollision=function(v,T){v.disengageActiveCollision(T),T.disengageActiveCollision(v),v.trigger.onTriggerExit&&T.entity&&v.trigger.onTriggerExit(T.entity),T.trigger.onTriggerExit&&v.entity&&T.trigger.onTriggerExit(v.entity)},e.engageCollision=function(v,T){v.engageCollision(T),T.engageCollision(v),v.trigger.onTriggerEnter&&T.entity&&v.trigger.onTriggerEnter(T.entity),T.trigger.onTriggerEnter&&v.entity&&T.trigger.onTriggerEnter(v.entity)},e.prototype.checkCollisionAgainstCamera=function(v){var T=v.hasActiveCollision(this._cameraTriggerWrapper),A=e.areColliding(v,this._cameraTriggerWrapper);T&&!A?(v.disengageActiveCollision(this._cameraTriggerWrapper),v.trigger.onCameraExit&&v.trigger.onCameraExit()):!T&&A&&(v.engageCollision(this._cameraTriggerWrapper),v.trigger.onCameraEnter&&v.trigger.onCameraEnter())},e.prototype.checkCollisionAgainstOtherTriggers=function(v){for(var T in this._triggers)if(this._triggers.hasOwnProperty(T)&&T!=v.uuid&&this._triggers[T].trigger.enabled&&e.canTriggersCollide(v,this._triggers[T])){var A=v.hasActiveCollision(this._triggers[T]),C=e.areColliding(v,this._triggers[T]);A&&!C?e.disengageCollision(v,this._triggers[T]):!A&&C&&e.engageCollision(v,this._triggers[T])}},e.canTriggersCollide=function(v,T){return 0==v.trigger.triggeredByLayer||0!=(T.trigger.layer&v.trigger.triggeredByLayer)},e.areColliding=function(v,T){return v.getShape()instanceof P&&T.getShape()instanceof P?e.areCollidingAABB(v.getGlobalPosition(),v.getShape(),T.getGlobalPosition(),T.getShape()):v.getShape()instanceof k&&T.getShape()instanceof k?e.areCollidingSphere(v.getGlobalPosition(),v.getShape(),T.getGlobalPosition(),T.getShape()):v.getShape()instanceof P&&T.getShape()instanceof k?e.areCollidingAABBSphere(v.getGlobalPosition(),v.getShape(),T.getGlobalPosition(),T.getShape()):v.getShape()instanceof k&&T.getShape()instanceof P&&e.areCollidingAABBSphere(T.getGlobalPosition(),T.getShape(),v.getGlobalPosition(),v.getShape())},e.areCollidingAABB=function(v,T,A,C){var E=e.getBoxShapeValues(v,T),R=e.getBoxShapeValues(A,C);return E.min.x<=R.max.x&&E.max.x>=R.min.x&&E.min.y<=R.max.y&&E.max.y>=R.min.y&&E.min.z<=R.max.z&&E.max.z>=R.min.z},e.areCollidingSphere=function(v,T,A,C){return Vector3.DistanceSquared(v.add(T.position),A.add(C.position))<T.radius*T.radius+C.radius*C.radius},e.areCollidingAABBSphere=function(v,T,A,C){var E=e.getBoxShapeValues(v,T),R=A.add(C.position),O=C.radius,z=0;return R.x<E.min.x&&(z+=(E.min.x-R.x)*(E.min.x-R.x)),R.x>E.max.x&&(z+=(R.x-E.max.x)*(R.x-E.max.x)),R.y<E.min.y&&(z+=(E.min.y-R.y)*(E.min.y-R.y)),R.y>E.max.y&&(z+=(R.y-E.max.y)*(R.y-E.max.y)),R.z<E.min.z&&(z+=(E.min.z-R.z)*(E.min.z-R.z)),R.z>E.max.z&&(z+=(R.z-E.max.z)*(R.z-E.max.z)),z<O*O},e.getBoxShapeValues=function(v,T){var A=v.add(T.position);return{center:A,min:A.subtract(T.size.scale(.5)),max:A.add(T.size.scale(.5))}},e._instance=null,e}(),nt=function(){function e(v){this.wasEnabled=!0,this._uuid="",this._collidingWith={},this._isDebug=!1,this._debugEntity=null,this._entity=v,v&&(this._trigger=v.getComponent(ot),this._uuid=v.uuid,this._isDebug=this._trigger.debugEnabled,this._isDebug&&this.addDebugEntity())}return Object.defineProperty(e.prototype,"entity",{get:function(){return this._entity},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"trigger",{get:function(){return this._trigger},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"uuid",{get:function(){return this._uuid},enumerable:!1,configurable:!0}),e.prototype.getGlobalPosition=function(){return this._entity?e.getEntityWorldPosition(this._entity):Vector3.Zero()},e.prototype.getShape=function(){return this._trigger.shape},e.prototype.isInEngine=function(){return null!=this._entity&&this._entity.isAddedToEngine()},e.prototype.getActiveCollisions=function(){var v=[];for(var T in this._collidingWith)this._collidingWith.hasOwnProperty(T)&&v.push(this._collidingWith[T]);return v},e.prototype.hasActiveCollision=function(v){return null!=this._collidingWith[v.uuid]&&null!=this._collidingWith[v.uuid]},e.prototype.disengageActiveCollision=function(v){delete this._collidingWith[v.uuid]},e.prototype.engageCollision=function(v){this._collidingWith[v.uuid]=v},e.prototype.isDebugging=function(){return this._isDebug},e.prototype.addDebugEntity=function(){return o(this,void 0,void 0,(function(){var v,A,C;return a(this,(function(E){switch(E.label){case 0:return[4,!T.isPreviewMode()];case 1:return E.sent()||(e._debugMaterial||(e._debugMaterial=new Material,e._debugMaterial.alphaTest=.5),null==this._debugEntity&&(this._debugEntity=new Entity,v=new Transform,this._debugEntity.addComponent(v),this._debugEntity.addComponent(e._debugMaterial),this.getShape()instanceof P&&((A=new BoxShape).withCollisions=!1,this._debugEntity.addComponent(A),v.scale=this.getShape().size),this.getShape()instanceof k&&((A=new SphereShape).withCollisions=!1,this._debugEntity.addComponent(A),C=this.getShape().radius,v.scale=new Vector3(C,C,C))),engine.addEntity(this._debugEntity)),[2]}}))}))},e.prototype.removeDebugEntity=function(){null!=this._debugEntity&&engine.removeEntity(this._debugEntity)},e.prototype.updateDebugEntity=function(){this._debugEntity&&(this._debugEntity.getComponent(Transform).position=this.getGlobalPosition().add(this.getShape().position))},e.getEntityWorldPosition=function(v){var T=v.hasComponent(Transform)?v.getComponent(Transform).position.clone():Vector3.Zero(),A=v.getParent();if(null!=A){var C=A.hasComponent(Transform)?A.getComponent(Transform).rotation:Quaternion.Identity;return this.getEntityWorldPosition(A).add(T.rotate(C))}return T},e._debugMaterial=null,e}(),it=function(v){function t(T){var A=v.call(this)||this;return A._shape=T,A._uuid="cameraTrigger",A}return i(t,v),t.prototype.getGlobalPosition=function(){return Camera.instance.position},t.prototype.getShape=function(){return this._shape},t.prototype.setShape=function(v){this._shape=v},t.prototype.isInEngine=function(){return!1},t.prototype.hasActiveCollision=function(v){return!1},t.prototype.disengageActiveCollision=function(v){},t.prototype.engageCollision=function(v){},t.prototype.isDebugging=function(){return!1},t}(nt),ot=function(){function e(v,T){this.enabled=!0,this.layer=0,this.triggeredByLayer=0,this._debugEnabled=!1,et.createAndAddToEngine(),this.shape=v,T&&(T.layer&&(this.layer=T.layer),T.triggeredByLayer&&(this.triggeredByLayer=T.triggeredByLayer),T.onTriggerEnter&&(this.onTriggerEnter=T.onTriggerEnter),T.onTriggerExit&&(this.onTriggerExit=T.onTriggerExit),T.onCameraEnter&&(this.onCameraEnter=T.onCameraEnter),T.onCameraExit&&(this.onCameraExit=T.onCameraExit),T.enableDebug&&(this._debugEnabled=T.enableDebug))}return Object.defineProperty(e.prototype,"debugEnabled",{get:function(){return this._debugEnabled},enumerable:!1,configurable:!0}),r([Component("triggerComponent")],e)}(),P=function(v,T){void 0===v&&(v=Vector3.One().scale(2)),void 0===T&&(T=Vector3.Zero()),this.size=v,this.position=T},k=function(v,T){void 0===v&&(v=2),void 0===T&&(T=Vector3.Zero()),this.radius=v,this.position=T};v.ActionsSequenceSystem=function(){function e(v){this.beginSequenceNode=null,this.currentSequenceNode=null,this.running=!1,this.started=!1,v&&this.startSequence(v)}return e.prototype.startSequence=function(v){this.beginSequenceNode=v.beginSequenceNode,this.currentSequenceNode=this.beginSequenceNode,this.running=!0,this.started=!1},e.prototype.setOnFinishCallback=function(v){this.onFinishCallback=v},e.prototype.isRunning=function(){return this.running},e.prototype.stop=function(){this.running=!1},e.prototype.resume=function(){null!=this.beginSequenceNode&&(this.running=!0)},e.prototype.reset=function(){this.currentSequenceNode=this.beginSequenceNode,this.running=!0,this.started=!1},e.prototype.getRunningAction=function(){var v=this.currentSequenceNode;if(this.currentSequenceNode instanceof st)do{v=v.currentInnerSequence}while(v instanceof st);return v.action},e.prototype.update=function(v){this.running&&(this.started?this.currentSequenceNode.hasFinish()?(this.currentSequenceNode.onFinish(),this.currentSequenceNode=this.currentSequenceNode.next,this.currentSequenceNode?this.currentSequenceNode.onStart():(this.running=!1,this.onFinishCallback&&this.onFinishCallback())):this.currentSequenceNode.update(v):(this.currentSequenceNode.onStart(),this.started=!0))},e}(),J=v.ActionsSequenceSystem||(v.ActionsSequenceSystem={}),$=function(){function e(){this.currentSequenceNode=null,this.beginSequenceNode=null,this.whileNodeStack=[]}return e.prototype.then=function(v){if(null==this.currentSequenceNode)this.currentSequenceNode=new rt,this.currentSequenceNode.action=v,this.beginSequenceNode=this.currentSequenceNode;else{var T=new rt;T.action=v,this.currentSequenceNode=this.currentSequenceNode.then(T)}return this},e.prototype.if=function(v){var T=new at(v);return null==this.currentSequenceNode?(this.currentSequenceNode=T,this.beginSequenceNode=T):this.currentSequenceNode=this.currentSequenceNode.then(T),this},e.prototype.else=function(){var v=this.currentSequenceNode.getSequence();if(!(v instanceof at))throw new Error("IF statement is needed to be called before ELSE statement.");v.closed=!0;var T=new ct(v);return this.currentSequenceNode=this.currentSequenceNode.then(T),this},e.prototype.endIf=function(){var v=this.currentSequenceNode.getSequence();if(!(v instanceof at||v instanceof ct))throw new Error("IF statement is needed to be called before ENDIF statement.");return v.closed=!0,this},e.prototype.while=function(v){var T=new lt(v);return null==this.currentSequenceNode?(this.currentSequenceNode=T,this.beginSequenceNode=T):this.currentSequenceNode=this.currentSequenceNode.then(T),this.whileNodeStack.push(T),this},e.prototype.endWhile=function(){var v=this.currentSequenceNode.getSequence();if(!(v instanceof lt))throw new Error("WHILE statement is needed to be called before ENDWHILE statement.");return v.closed=!0,this.whileNodeStack.length>0&&this.whileNodeStack.splice(this.whileNodeStack.length-1,1),this},e.prototype.breakWhile=function(){if(!(this.whileNodeStack.length>0))throw new Error("WHILE statement is needed to be called before BREAKWHILE statement.");return this.currentSequenceNode=this.currentSequenceNode.then(new ut(this.whileNodeStack[this.whileNodeStack.length-1])),this},e}(),J.SequenceBuilder=$;var rt=function(){function e(){this.action=null,this.next=null}return e.prototype.then=function(v){return this.next=v,v},e.prototype.onStart=function(){this.action&&this.action.onStart()},e.prototype.update=function(v){this.action&&this.action.update(v)},e.prototype.onFinish=function(){this.action&&this.action.onFinish()},e.prototype.hasFinish=function(){return!this.action||this.action.hasFinished},e.prototype.getSequence=function(){return this},e}(),st=function(v){function t(){var T=null!==v&&v.apply(this,arguments)||this;return T.currentInnerSequence=null,T.startingInnerSequence=null,T.closed=!1,T}return i(t,v),t.prototype.then=function(v){if(null==this.currentInnerSequence)this.currentInnerSequence=v,this.startingInnerSequence=v;else{if(this.closed)return this.next=v,v;this.currentInnerSequence=this.currentInnerSequence.then(v)}return this},t.prototype.onStart=function(){this.currentInnerSequence=this.startingInnerSequence,this.currentInnerSequence&&this.currentInnerSequence.onStart()},t.prototype.update=function(v){this.currentInnerSequence&&(this.currentInnerSequence.hasFinish()?(this.currentInnerSequence.onFinish(),this.currentInnerSequence=this.currentInnerSequence.next,this.currentInnerSequence&&this.currentInnerSequence.onStart()):this.currentInnerSequence.update(v))},t.prototype.onFinish=function(){this.currentInnerSequence&&this.currentInnerSequence.onFinish()},t.prototype.hasFinish=function(){return null==this.currentInnerSequence},t.prototype.getSequence=function(){if(this.currentInnerSequence){var v=this.currentInnerSequence.getSequence();if(v instanceof t&&!v.closed)return v}return this},t}(rt),at=function(v){function t(T){var A=v.call(this)||this;return A.result=!1,A.condition=T,A}return i(t,v),t.prototype.onStart=function(){this.result=this.condition(),this.result?v.prototype.onStart.call(this):this.currentInnerSequence=null},t}(st),ct=function(v){function t(T){var A=v.call(this)||this;return A.ifSequence=null,A.ifSequence=T,A}return i(t,v),t.prototype.onStart=function(){this.ifSequence&&!this.ifSequence.result?v.prototype.onStart.call(this):this.currentInnerSequence=null},t}(st),lt=function(v){function t(T){var A=v.call(this)||this;return A.breakWhile=!1,A.condition=T,A}return i(t,v),t.prototype.onStart=function(){this.breakWhile=!1,this.condition()?v.prototype.onStart.call(this):this.currentInnerSequence=null},t.prototype.update=function(v){this.currentInnerSequence&&(this.currentInnerSequence.hasFinish()?(this.currentInnerSequence.onFinish(),this.currentInnerSequence=this.currentInnerSequence.next,null==this.currentInnerSequence&&(this.currentInnerSequence=this.startingInnerSequence),this.currentInnerSequence&&this.currentInnerSequence.onStart()):this.currentInnerSequence.update(v))},t.prototype.hasFinish=function(){return this.breakWhile||!this.condition()},t}(st),ut=function(v){function t(T){var A=v.call(this)||this;return A.whileNode=T,A}return i(t,v),t.prototype.onStart=function(){this.whileNode.breakWhile=!0},t}(rt);v.Delay=X,v.ExpireIn=K,v.FollowCurvedPathComponent=V,v.FollowPathComponent=M,v.Interpolate=h,v.Interval=Z,v.KeepRotatingComponent=H,v.MoveTransformComponent=R,v.RotateTransformComponent=O,v.ScaleTransformComponent=z,v.SequenceNode=rt,v.ToggleComponent=W,v.TransformSystem=C,v.TriggerBoxShape=P,v.TriggerComponent=ot,v.TriggerSphereShape=k,v.TriggerSystem=et,v.addLabel=I,v.addOneTimeTrigger=function(v,T,A){var C=!1,E=!1,R=new Entity;R.addComponent(new Transform({}));var O={};return T.layer&&(O.layer=T.layer),T.triggeredByLayer&&(O.triggeredByLayer=T.triggeredByLayer),T.onCameraEnter&&(O.onCameraEnter=function(){C||(C=!0,T.onCameraEnter()),!C&&T.onCameraEnter||!E&&T.onCameraExit||engine.removeEntity(R)}),T.onCameraExit&&(O.onCameraExit=function(){E||(E=!0,T.onCameraExit()),!C&&T.onCameraEnter||!E&&T.onCameraExit||engine.removeEntity(R)}),T.enableDebug&&(O.enableDebug=T.enableDebug),R.addComponent(new ot(v,O)),A&&R.setParent(A),engine.addEntity(R),R},v.addTestCube=function(v,A,C,E,R,O,z){return o(this,void 0,void 0,(function(){var M,V,H;return a(this,(function(W){switch(W.label){case 0:return(M=!z)?[4,!T.isPreviewMode()]:[3,2];case 1:M=W.sent(),W.label=2;case 2:return M?[2]:((V=new Entity).addComponent(new Transform(v)),R?(V.addComponent(new SphereShape),V.getComponent(Transform).scale.setAll(.5)):V.addComponent(new BoxShape),engine.addEntity(V),V.addComponent(new OnPointerDown(A,{hoverText:C||"click",button:ActionButton.POINTER})),E&&((H=new Material).albedoColor=E,V.addComponent(H)),O&&(V.getComponent(BoxShape).withCollisions=!1),C&&I(C,V,!0),[2,V])}}))}))},v.clamp=function(v,T,A){var C=v;return v>A?C=A:v<T&&(C=T),C},v.getEntityWorldPosition=function e(v){var T=v.hasComponent(Transform)?v.getComponent(Transform).position.clone():Vector3.Zero(),A=v.getParent();if(null!=A&&"0"!=A.uuid){if("FirstPersonCameraEntityReference"==A.uuid){var C=Camera.instance.rotation.clone();return Camera.instance.position.clone().add(T.rotate(C))}if("AvatarEntityReference"==A.uuid){var E=Camera.instance.rotation;return C=Quaternion.Euler(0,E.eulerAngles.y,0),Camera.instance.position.clone().add(T.rotate(C)).add(new Vector3(0,-.875,0))}return C=A.hasComponent(Transform)?A.getComponent(Transform).rotation:Quaternion.Identity,e(A).add(T.rotate(C))}return T},v.getEntityWorldRotation=function e(v){var T=v.hasComponent(Transform)?v.getComponent(Transform).rotation.clone():Quaternion.Zero(),A=v.getParent();if(null!=A&&"0"!=A.uuid){if("FirstPersonCameraEntityReference"==A.uuid){var C=Camera.instance.rotation.clone();return T.multiply(C)}return"AvatarEntityReference"==A.uuid?(C=Quaternion.Euler(0,Camera.instance.rotation.eulerAngles.y,0),T.multiply(C)):(C=e(A),T.multiply(C))}return T},v.map=function(v,T,A,C,E){return(v-T)/(A-T)*(E-C)+C},v.sendRequest=function(v,T,A,C){return o(this,void 0,void 0,(function(){var E,R,O;return a(this,(function(z){switch(z.label){case 0:return z.trys.push([0,6,,7]),E={method:T||"GET"},A&&(E.headers=A),C&&(E.body=JSON.stringify(C)),[4,fetch(v,E)];case 1:R=z.sent(),z.label=2;case 2:return z.trys.push([2,4,,5]),[4,R.json()];case 3:return[2,z.sent()];case 4:return z.sent(),[2,R];case 5:return[3,7];case 6:return O=z.sent(),log("error fetching from ",v," : ",O),[3,7];case 7:return[2]}}))}))},v.setTimeout=function(v,T){var A=new Entity;return A.addComponent(new X(v,(function(){T(),engine.removeEntity(A)}))),engine.addEntity(A),A},Object.defineProperty(v,"__esModule",{value:!0})})),function(v,T){"object"==typeof exports&&"undefined"!=typeof module?T(exports):"function"==typeof define&&define.amd?define("@dcl/ui-scene-utils",["exports"],T):T((v="undefined"!=typeof globalThis?globalThis:v||self)["ui-utils"]={})}(this,(function(v){
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */
var e=function(v,T){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,T){v.__proto__=T}||function(v,T){for(var A in T)Object.prototype.hasOwnProperty.call(T,A)&&(v[A]=T[A])})(v,T)};function i(v,T){function o(){this.constructor=v}e(v,T),v.prototype=null===T?Object.create(T):(o.prototype=T.prototype,new o)}var o=function(){return(o=Object.assign||function(v){for(var T,A=1,C=arguments.length;A<C;A++)for(var E in T=arguments[A])Object.prototype.hasOwnProperty.call(T,E)&&(v[E]=T[E]);return v}).apply(this,arguments)};function n(v,T){var A={};for(var C in v)Object.prototype.hasOwnProperty.call(v,C)&&T.indexOf(C)<0&&(A[C]=v[C]);if(null!=v&&"function"==typeof Object.getOwnPropertySymbols){var E=0;for(C=Object.getOwnPropertySymbols(v);E<C.length;E++)T.indexOf(C[E])<0&&Object.prototype.propertyIsEnumerable.call(v,C[E])&&(A[C[E]]=v[C[E]])}return A}function r(v){var T="function"==typeof Symbol&&Symbol.iterator,A=T&&v[T],C=0;if(A)return A.call(v);if(v&&"number"==typeof v.length)return{next:function(){return v&&C>=v.length&&(v=void 0),{value:v&&v[C++],done:!v}}};throw new TypeError(T?"Object is not iterable.":"Symbol.iterator is not defined.")}var T=function(){function t(T,A){var E=this;C.createAndAddToEngine(),this.elapsedTime=0,this.targetTime=T,this.onTimeReachedCallback=A,this.onTargetTimeReached=function(T){E.onTimeReachedCallback(),T.removeComponent(v)}}var v;return v=t,t.prototype.setCallback=function(v){this.onTimeReachedCallback=v},v=function(v,T,A,C){var E,R=arguments.length,O=R<3?T:null===C?C=Object.getOwnPropertyDescriptor(T,A):C;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)O=Reflect.decorate(v,T,A,C);else for(var z=v.length-1;z>=0;z--)(E=v[z])&&(O=(R<3?E(O):R>3?E(T,A,O):E(T,A))||O);return R>3&&O&&Object.defineProperty(T,A,O),O}([Component("UItimerDelay")],t)}(),A=engine.getComponentGroup(T),C=function(){function t(){t._instance=this}return t.createAndAddToEngine=function(){return null==this._instance&&(this._instance=new t,engine.addSystem(this._instance)),this._instance},t.prototype.update=function(v){var C,E;try{for(var R=r(A.entities),O=R.next();!O.done;O=R.next()){var z=O.value,M=z.getComponent(T);M.elapsedTime+=v,M.elapsedTime>=M.targetTime&&M.onTargetTimeReached(z)}}catch(v){C={error:v}}finally{try{O&&!O.done&&(E=R.return)&&E.call(R)}finally{if(C)throw C.error}}},t._instance=null,t}(),E=new UICanvas;E.visible=!0;var R=new Font(Fonts.SanFrancisco),O=new Font(Fonts.SanFrancisco_Heavy),z=new Texture("https://decentraland.org/images/ui/light-atlas-v3.png"),M=new Texture("https://decentraland.org/images/ui/dark-atlas-v3.png"),V=new UIText(E);V.vAlign="center",V.hAlign="center",V.hTextAlign="center",V.vTextAlign="center",V.font=R,V.fontSize=60,V.color=new Color4(0,0,0,1),V.visible=!1,V.positionY=80;var H=new UIImage(E,z);H.hAlign="center",H.vAlign="center",H.width=400,H.height=250,H.visible=!1;var W,j,X,K,Z=function(v){function e(T,A,C,O,z,M,V){var H=v.call(this)||this;return H.canvas=E,H.valueAsNum=T,H.uiText=new UIText(E),H.fixedDigits=V||null,H.uiText.value=H.toFixedLengthString(T),H.uiText.hAlign="right",H.uiText.vAlign="bottom",H.uiText.positionX=A||0,H.uiText.positionY=C||0,H.uiText.fontSize=z||25,H.uiText.font=R,H.uiText.vTextAlign="center",H.uiText.hTextAlign="center",H.uiText.color=O||Color4.White(),H.uiText.outlineColor=Color4.Black(),H.uiText.outlineWidth=M?0:.1,H}return i(e,v),e.prototype.read=function(){return this.valueAsNum},e.prototype.increase=function(v){this.valueAsNum+=v||1,this.uiText.value=this.toFixedLengthString(this.valueAsNum)},e.prototype.decrease=function(v){this.valueAsNum-=v||1,this.uiText.value=this.toFixedLengthString(this.valueAsNum)},e.prototype.set=function(v){this.valueAsNum=v,this.uiText.value=this.toFixedLengthString(this.valueAsNum)},e.prototype.hide=function(){this.uiText.visible=!1},e.prototype.show=function(){this.uiText.visible=!0},e.prototype.toFixedLengthString=function(v){var T=v.toString();if(!this.fixedDigits)return T;for(var A=T.length-this.fixedDigits;A<0;)T="0".concat(T),A+=1;return A>0&&(T=v.toPrecision(this.fixedDigits)),T},e}(Entity);(W=v.PromptStyles||(v.PromptStyles={})).LIGHT="light",W.DARK="dark",W.LIGHTLARGE="lightlarge",W.DARKLARGE="darklarge",W.LIGHTSLANTED="lightslanted",W.DARKSLANTED="darkslanted",(j=v.BarStyles||(v.BarStyles={})).ROUNDBLACK="roundblack",j.ROUNDWHITE="roundwhite",j.ROUNDSILVER="roundsilver",j.ROUNDGOLD="roundgold",j.SQUAREBLACK="squareblack",j.SQUAREWHITE="squarewhite",j.SQUARESILVER="squaresilver",j.SQUAREGOLD="squaregold",(X=v.ButtonStyles||(v.ButtonStyles={})).E="e",X.F="f",X.DARK="dark",X.RED="red",X.ROUNDBLACK="roundblack",X.ROUNDWHITE="roundwhite",X.ROUNDSILVER="roundsilver",X.ROUNDGOLD="roundgold",X.SQUAREBLACK="squareblack",X.SQUAREWHITE="squarewhite",X.SQUARESILVER="squaresilver",X.SQUAREGOLD="squaregold",(K=v.SwitchStyles||(v.SwitchStyles={})).ROUNDGREEN="roundgreen",K.ROUNDRED="roundred",K.SQUAREGREEN="squaregreen",K.SQUARERED="squarered";var J={sourceWidth:174,sourceHeight:46,sourceLeft:512,sourceTop:662},$={sourceWidth:174,sourceHeight:46,sourceLeft:512,sourceTop:612},et={sourceWidth:174,sourceHeight:46,sourceLeft:512,sourceTop:662},nt={sourceWidth:174,sourceHeight:46,sourceLeft:512,sourceTop:612},it={sourceWidth:128,sourceHeight:32,sourceLeft:512,sourceTop:458},ot={sourceWidth:128,sourceHeight:32,sourceLeft:646,sourceTop:457},rt={sourceWidth:128,sourceHeight:32,sourceLeft:512,sourceTop:494},st={sourceWidth:128,sourceHeight:32,sourceLeft:646,sourceTop:493},at={sourceWidth:128,sourceHeight:32,sourceLeft:512,sourceTop:531},ct={sourceWidth:128,sourceHeight:32,sourceLeft:646,sourceTop:531},lt={sourceWidth:128,sourceHeight:32,sourceLeft:512,sourceTop:567},ut={sourceWidth:128,sourceHeight:32,sourceLeft:646,sourceTop:567},ht={sourceWidth:26,sourceHeight:26,sourceLeft:697,sourceTop:611},pt={sourceWidth:26,sourceHeight:26,sourceLeft:733,sourceTop:611},dt={sourceWidth:416,sourceHeight:352,sourceLeft:501,sourceTop:12},ft={sourceWidth:480,sourceHeight:384,sourceLeft:7,sourceTop:12},yt={sourceWidth:486,sourceHeight:326,sourceLeft:7,sourceTop:413},gt={closeW:{sourceWidth:32,sourceHeight:32,sourceLeft:942,sourceTop:306},closeD:{sourceWidth:32,sourceHeight:32,sourceLeft:986,sourceTop:306},closeWLarge:{sourceWidth:64,sourceHeight:64,sourceLeft:512,sourceTop:381},closeDLarge:{sourceWidth:64,sourceHeight:64,sourceLeft:583,sourceTop:381},closeWNoBack:{sourceWidth:24,sourceHeight:24,sourceLeft:946,sourceTop:252},closeDNoBack:{sourceWidth:24,sourceHeight:24,sourceLeft:946,sourceTop:214},closeWNoBackLarge:{sourceWidth:32,sourceHeight:32,sourceLeft:987,sourceTop:214},closeDNoBackLarge:{sourceWidth:32,sourceHeight:32,sourceLeft:987,sourceTop:260},FDark:{sourceWidth:32,sourceHeight:32,sourceLeft:950,sourceTop:4},FWhite:{sourceWidth:32,sourceHeight:32,sourceLeft:987,sourceTop:4},EDark:{sourceWidth:32,sourceHeight:32,sourceLeft:950,sourceTop:40},EWhite:{sourceWidth:32,sourceHeight:32,sourceLeft:987,sourceTop:40},Timer:{sourceWidth:24,sourceHeight:32.2,sourceLeft:718,sourceTop:388},TimerLarge:{sourceWidth:48,sourceHeight:68,sourceLeft:662,sourceTop:386},ClickWhite:{sourceWidth:32,sourceHeight:48,sourceLeft:799,sourceTop:389},ClickDark:{sourceWidth:32,sourceHeight:48,sourceLeft:757,sourceTop:389}},vt={sourceWidth:24,sourceHeight:24,sourceLeft:987,sourceTop:76},bt={sourceWidth:24,sourceHeight:24,sourceLeft:987,sourceTop:104},Tt={sourceWidth:24,sourceHeight:24,sourceLeft:958,sourceTop:76},wt={sourceWidth:24,sourceHeight:24,sourceLeft:958,sourceTop:104},At={sourceWidth:32,sourceHeight:32,sourceLeft:987,sourceTop:132},xt={sourceWidth:32,sourceHeight:32,sourceLeft:987,sourceTop:168},St={sourceWidth:32,sourceHeight:32,sourceLeft:950,sourceTop:132},_t={sourceWidth:32,sourceHeight:32,sourceLeft:950,sourceTop:168},Ct={sourceWidth:64,sourceHeight:32,sourceLeft:783,sourceTop:454},It={sourceWidth:64,sourceHeight:32,sourceLeft:853,sourceTop:454},Rt={sourceWidth:64,sourceHeight:32,sourceLeft:923,sourceTop:454},Ot={sourceWidth:64,sourceHeight:32,sourceLeft:783,sourceTop:501},Pt={sourceWidth:64,sourceHeight:32,sourceLeft:852,sourceTop:501},Nt={sourceWidth:64,sourceHeight:32,sourceLeft:921,sourceTop:501};function S(v,T){v.sourceWidth=T.sourceWidth,v.sourceHeight=T.sourceHeight,v.sourceLeft=T.sourceLeft?T.sourceLeft:0,v.sourceTop=T.sourceTop?T.sourceTop:0}function B(v){var T=-10-4*v;return T>-65?T:-65}var zt=function(T){function o(A,C,R,O,M,V,H){var W=T.call(this)||this;if(W.canvas=E,W.valueAsNum=A>1?1:A,W.fullWidth=V?128*V:128,W.background=new UIImage(E,z),W.background.width=V?128*V:128,W.background.height=V?32*V:32,W.background.hAlign="right",W.background.vAlign="bottom",W.background.positionX=C||0,W.background.positionY=R||0,M)switch(M){case v.BarStyles.ROUNDBLACK:S(W.background,it);break;case v.BarStyles.ROUNDWHITE:S(W.background,rt);break;case v.BarStyles.ROUNDSILVER:S(W.background,at);break;case v.BarStyles.ROUNDGOLD:S(W.background,lt);break;case v.BarStyles.SQUAREBLACK:S(W.background,ot);break;case v.BarStyles.SQUAREWHITE:S(W.background,st);break;case v.BarStyles.SQUARESILVER:S(W.background,ct);break;case v.BarStyles.SQUAREGOLD:S(W.background,ut)}else S(W.background,at);return W.background.sourceWidth=128,W.background.sourceHeight=32,W.background.visible=!0,W.bar=new UIContainerRect(W.background),W.bar.color=O||Color4.Red(),W.bar.thickness=0,W.bar.hAlign="left",W.bar.vAlign="center",W.bar.positionX=V?2.55*V:2.55,W.bar.positionY=0,W.bar.height=V?32*V-7.5*V:24.5,W.bar.width=V?W.fullWidth*W.valueAsNum-5.1*V:W.fullWidth*W.valueAsNum-5.1,H&&W.hide(),W}return i(o,T),o.prototype.read=function(){return this.valueAsNum},o.prototype.increase=function(v){this.valueAsNum+=v||.1,this.bar.width=this.fullWidth*this.valueAsNum-6},o.prototype.decrease=function(v){this.valueAsNum-=v||.1,this.bar.width=this.fullWidth*this.valueAsNum-6},o.prototype.set=function(v){this.valueAsNum=v,this.bar.width=this.fullWidth*this.valueAsNum-6},o.prototype.hide=function(){this.background.visible=!1,this.bar.visible=!1},o.prototype.show=function(){this.background.visible=!0,this.bar.visible=!0},o}(Entity),Lt=function(v){function e(T,A,C,R,O,z){var M=v.call(this)||this;M.canvas=E;var V=new Texture(T);return M.image=new UIImage(E,V),M.image.hAlign="right",M.image.vAlign="bottom",M.image.positionX=A||0,M.image.positionY=C||0,M.image.width=R||64,M.image.height=O||64,M.image.sourceLeft=z&&z.sourceLeft?z.sourceLeft:0,M.image.sourceTop=z&&z.sourceTop?z.sourceTop:0,M.image.sourceWidth=z&&z.sourceWidth?z.sourceWidth:R||64,M.image.sourceHeight=z&&z.sourceHeight?z.sourceHeight:O||64,M}return i(e,v),e.prototype.hide=function(){this.image.visible=!1},e.prototype.show=function(v){var A=this;if(this.image.visible=!0,v){var C=new Entity;engine.addEntity(C),C.addComponentOrReplace(new T(v,(function(){A.hide()})))}},e}(Entity),Ft=function(v){function e(T,A,C,R,O,z){var M=v.call(this)||this;M.canvas=E;var V=new Texture(T);return M.image=new UIImage(E,V),M.image.hAlign="right",M.image.vAlign="bottom",M.image.positionX=A||0,M.image.positionY=C||0,M.image.width=R||32,M.image.height=O||32,M.image.sourceLeft=z&&z.sourceLeft?z.sourceLeft:0,M.image.sourceTop=z&&z.sourceTop?z.sourceTop:0,M.image.sourceWidth=z?z.sourceWidth:R||32,M.image.sourceHeight=z?z.sourceHeight:O||32,M}return i(e,v),e.prototype.hide=function(){this.image.visible=!1},e.prototype.show=function(v){var A=this;if(this.image.visible=!0,v){var C=new Entity;engine.addEntity(C),C.addComponentOrReplace(new T(v,(function(){A.hide()})))}},e}(Entity),Bt=function(v){function e(T,A,C,R,O,z){var M=v.call(this)||this;M.canvas=E;var V=new Texture(T);return M.image=new UIImage(E,V),M.image.hAlign="right",M.image.vAlign="bottom",M.image.positionX=A||0,M.image.positionY=C||0,M.image.width=R||128,M.image.height=O||128,M.image.sourceLeft=z&&z.sourceLeft?z.sourceLeft:0,M.image.sourceTop=z&&z.sourceTop?z.sourceTop:0,M.image.sourceWidth=z?z.sourceWidth:R||128,M.image.sourceHeight=z?z.sourceHeight:O||128,M}return i(e,v),e.prototype.hide=function(){this.image.visible=!1},e.prototype.show=function(v){var A=this;if(this.image.visible=!0,v){var C=new Entity;engine.addEntity(C),C.addComponentOrReplace(new T(v,(function(){A.hide()})))}},e}(Entity),kt=function(v){function e(A,C,R,O,z,M,V,H){var W=v.call(this)||this;W.canvas=E;var j=new Texture(A);if(W.image=new UIImage(E,j),W.image.hAlign="center",W.image.vAlign="center",W.image.positionX=O||0,W.image.positionY=z||0,W.image.width=M||512,W.image.height=V||512,W.image.sourceLeft=H&&H.sourceLeft?H.sourceLeft:0,W.image.sourceTop=H&&H.sourceTop?H.sourceTop:0,W.image.sourceWidth=H?H.sourceWidth:M||512,W.image.sourceHeight=H?H.sourceHeight:V||512,W.image.visible=!R,-1!=C){var X=new Entity;engine.addEntity(X),X.addComponentOrReplace(new T(C||3,(function(){W.hide()})))}return W}return i(e,v),e.prototype.hide=function(){this.image.visible=!1},e.prototype.show=function(v){var A=this;if(this.image.visible=!0,v){var C=new Entity;engine.addEntity(C),C.addComponentOrReplace(new T(v,(function(){A.hide()})))}},e}(Entity),Ut=function(v){function e(T,A,C,O){var V=v.call(this)||this;V.canvas=E,V.background=H,V.UIOpenTime=+Date.now(),V.onAccept=A||null;var W=O?M:z;return H.source=W,H.width=400,H.height=250,H.positionY=0,S(H,dt),H.visible=!0,V.closeIcon=new UIImage(H,W),V.closeIcon.positionX=175,V.closeIcon.positionY=100,V.closeIcon.width=32,V.closeIcon.height=32,S(V.closeIcon,O?gt.closeW:gt.closeD),V.closeIcon.onClick=new OnClick((function(){V.close()})),V.text=new UIText(H),V.text.value=T,V.text.adaptWidth=!1,V.text.textWrapping=!0,V.text.width=380,V.text.hAlign="center",V.text.vAlign="top",V.text.positionX=0,V.text.positionY=-65,V.text.fontSize=24,V.text.font=R,V.text.vTextAlign="center",V.text.hTextAlign="center",V.text.color=O?Color4.White():Color4.Black(),V.button=new UIImage(H,W),V.button.positionX=0,V.button.positionY=-60,V.button.width=174,V.button.height=46,S(V.button,J),V.icon=new UIImage(V.button,1==O?M:z),V.icon.width=26,V.icon.height=26,V.icon.hAlign="center",V.icon.vAlign="center",V.icon.isPointerBlocker=!1,S(V.icon,ht),V.icon.positionX=B(C?C.length:2),V.buttonLabel=new UIText(V.button),V.buttonLabel.value=C||"Ok",V.buttonLabel.hTextAlign="center",V.buttonLabel.vTextAlign="center",V.buttonLabel.positionX=30,V.buttonLabel.fontSize=18,V.buttonLabel.font=R,V.buttonLabel.color=Color4.White(),V.buttonLabel.isPointerBlocker=!1,V.button.onClick=new OnClick((function(){V.accept()})),V.EButtonAction=Input.instance.subscribe("BUTTON_DOWN",ActionButton.PRIMARY,!1,(function(v){V.button.visible&&+Date.now()-V.UIOpenTime>100&&V.accept()})),V}return i(e,v),e.prototype.close=function(){H.visible=!1,this.closeIcon.visible=!1,this.button.visible=!1,this.text.visible=!1,this.buttonLabel.visible=!1},e.prototype.accept=function(){this.onAccept&&this.onAccept(),this.hide()},e.prototype.hide=function(){H.visible=!1,this.closeIcon.visible=!1,this.button.visible=!1,this.text.visible=!1,this.buttonLabel.visible=!1,Input.instance.unsubscribe("BUTTON_DOWN",ActionButton.PRIMARY,this.EButtonAction)},e.prototype.show=function(){H.visible=!0,this.closeIcon.visible=!0,this.button.visible=!0,this.text.visible=!0,this.buttonLabel.visible=!0,Input.instance.subscribe("BUTTON_DOWN",ActionButton.PRIMARY,!1,this.EButtonAction)},e}(Entity),Vt=function(v){function e(T,A,C,V,W,j,X){var K=v.call(this)||this;K.canvas=E,K.background=H,K.UIOpenTime=+Date.now(),K.onAccept=C,K.onReject=V||null;var Z=X?M:z;return H.source=Z,H.width=480,H.height=384,S(H,ft),H.visible=!0,K.closeIcon=new UIImage(H,Z),K.closeIcon.positionX=215,K.closeIcon.positionY=164,K.closeIcon.width=32,K.closeIcon.height=32,S(K.closeIcon,X?gt.closeW:gt.closeD),K.closeIcon.onClick=new OnClick((function(){K.close()})),K.title=new UIText(H),K.title.value=T,K.title.adaptWidth=!1,K.title.textWrapping=!0,K.title.width=380,K.title.hAlign="center",K.title.vAlign="top",K.title.positionX=0,K.title.positionY=-20,K.title.font=O,K.title.fontSize=24,K.title.vTextAlign="center",K.title.hTextAlign="center",K.title.color=X?Color4.White():Color4.Black(),K.text=new UIText(H),K.text.value=A,K.text.adaptWidth=!1,K.text.textWrapping=!0,K.text.width=380,K.text.hAlign="center",K.text.vAlign="top",K.text.positionX=0,K.text.positionY=-145,K.text.fontSize=24,K.text.font=R,K.text.vTextAlign="center",K.text.hTextAlign="center",K.text.color=X?Color4.White():Color4.Black(),K.buttonE=new UIImage(H,Z),K.buttonE.positionX=-100,K.buttonE.positionY=-120,K.buttonE.width=174,K.buttonE.height=46,S(K.buttonE,J),K.buttonEIcon=new UIImage(K.buttonE,1==X?M:z),K.buttonEIcon.width=26,K.buttonEIcon.height=26,K.buttonEIcon.hAlign="center",K.buttonEIcon.vAlign="center",K.buttonEIcon.isPointerBlocker=!1,S(K.buttonEIcon,ht),K.buttonEIcon.positionX=B(W?W.length:2),K.buttonELabel=new UIText(K.buttonE),K.buttonELabel.value=W||"Ok",K.buttonELabel.hTextAlign="center",K.buttonELabel.vTextAlign="center",K.buttonELabel.positionX=30,K.buttonELabel.fontSize=18,K.buttonELabel.font=R,K.buttonELabel.color=Color4.White(),K.buttonELabel.isPointerBlocker=!1,K.buttonE.onClick=new OnClick((function(){K.accept()})),K.EButtonAction=Input.instance.subscribe("BUTTON_DOWN",ActionButton.PRIMARY,!1,(function(v){K.buttonE.visible&&+Date.now()-K.UIOpenTime>100&&K.accept()})),K.buttonF=new UIImage(H,Z),K.buttonF.positionX=100,K.buttonF.positionY=-120,K.buttonF.width=174,K.buttonF.height=46,S(K.buttonF,$),K.buttonFIcon=new UIImage(K.buttonF,1==X?M:z),K.buttonFIcon.width=26,K.buttonFIcon.height=26,K.buttonFIcon.hAlign="center",K.buttonFIcon.vAlign="center",K.buttonFIcon.isPointerBlocker=!1,S(K.buttonFIcon,pt),K.buttonFIcon.positionX=B(j?j.length:6),K.buttonFLabel=new UIText(K.buttonF),K.buttonFLabel.value=j||"Cancel",K.buttonFLabel.hTextAlign="center",K.buttonFLabel.vTextAlign="center",K.buttonFLabel.positionX=30,K.buttonFLabel.fontSize=18,K.buttonFLabel.font=R,K.buttonFLabel.color=Color4.White(),K.buttonFLabel.isPointerBlocker=!1,K.buttonF.onClick=new OnClick((function(){K.reject()})),K.FButtonAction=Input.instance.subscribe("BUTTON_DOWN",ActionButton.SECONDARY,!1,(function(v){K.buttonF.visible&&+Date.now()-K.UIOpenTime>100&&K.reject()})),K}return i(e,v),e.prototype.close=function(){H.visible=!1,this.closeIcon.visible=!1,this.buttonE.visible=!1,this.buttonF.visible=!1,this.text.visible=!1,this.buttonELabel.visible=!1,this.buttonFLabel.visible=!1,this.title.visible=!1},e.prototype.accept=function(){this.onAccept&&this.onAccept(),this.hide()},e.prototype.reject=function(){this.onReject&&this.onReject(),this.hide()},e.prototype.hide=function(){H.visible=!1,this.closeIcon.visible=!1,this.buttonE.visible=!1,this.buttonF.visible=!1,this.text.visible=!1,this.buttonELabel.visible=!1,this.buttonFLabel.visible=!1,this.buttonEIcon.visible=!1,this.buttonFIcon.visible=!1,Input.instance.unsubscribe("BUTTON_DOWN",ActionButton.PRIMARY,this.EButtonAction),Input.instance.unsubscribe("BUTTON_DOWN",ActionButton.SECONDARY,this.FButtonAction)},e.prototype.show=function(){H.visible=!0,this.closeIcon.visible=!0,this.buttonE.visible=!0,this.buttonF.visible=!0,this.text.visible=!0,this.buttonELabel.visible=!0,this.buttonFLabel.visible=!0,this.buttonEIcon.visible=!0,this.buttonFIcon.visible=!0,Input.instance.subscribe("BUTTON_DOWN",ActionButton.PRIMARY,!1,this.EButtonAction),Input.instance.subscribe("BUTTON_DOWN",ActionButton.SECONDARY,!1,this.FButtonAction)},e}(Entity),Ht=function(v){function e(T,A,C,V,W){var j=v.call(this)||this;j.canvas=E,j.background=H,j.UIOpenTime=+Date.now(),j.onAccept=A;var X=W?M:z;H.source=X,H.width=400,H.height=250,S(H,dt),H.visible=!0,j.text=new UIText(H),j.text.value=T,j.text.adaptWidth=!1,j.text.textWrapping=!0,j.text.width=320,j.text.hAlign="center",j.text.vAlign="top",j.text.positionX=0,j.text.positionY=-20,j.text.fontSize=24,j.text.font=O,j.text.vTextAlign="center",j.text.hTextAlign="center",j.text.color=W?Color4.White():Color4.Black(),j.closeIcon=new UIImage(H,X),j.closeIcon.positionX=175,j.closeIcon.positionY=100,j.closeIcon.width=32,j.closeIcon.height=32,S(j.closeIcon,W?gt.closeW:gt.closeD),j.closeIcon.onClick=new OnClick((function(){j.hide()})),j.button=new UIImage(H,X),j.button.positionX=0,j.button.positionY=-60,j.button.width=174,j.button.height=46,S(j.button,J),j.icon=new UIImage(j.button,1==W?M:z),j.icon.width=26,j.icon.height=26,j.icon.hAlign="center",j.icon.vAlign="center",j.icon.isPointerBlocker=!1,S(j.icon,ht),j.icon.positionX=B(C?C.length:6),j.buttonLabel=new UIText(j.button),j.buttonLabel.value=C||"Submit",j.buttonLabel.hTextAlign="center",j.buttonLabel.vTextAlign="center",j.buttonLabel.positionX=30,j.buttonLabel.fontSize=18,j.buttonLabel.font=R,j.buttonLabel.color=Color4.White(),j.buttonLabel.isPointerBlocker=!1,j.fillInBox=new UIInputText(H),j.fillInBox.color=Color4.Black(),j.fillInBox.font=R,j.fillInBox.width=312,j.fillInBox.height=46,j.fillInBox.positionX=0,j.fillInBox.positionY=15,j.fillInBox.placeholder=V||"Fill in",j.fillInBox.hTextAlign="center",j.fillInBox.vTextAlign="center",j.fillInBox.fontSize=22;var K="";return j.fillInBox.onChanged=new OnChanged((function(v){K=v.value})),j.fillInBox.onTextSubmit=new OnTextSubmit((function(v){j.accept(K)})),j.button.onClick=new OnClick((function(){j.accept(K)})),j.EButtonAction=Input.instance.subscribe("BUTTON_DOWN",ActionButton.PRIMARY,!1,(function(v){j.button.visible&&+Date.now()-j.UIOpenTime>100&&j.accept(K)})),j}return i(e,v),e.prototype.close=function(){H.visible=!1,this.closeIcon.visible=!1,this.button.visible=!1,this.text.visible=!1,this.buttonLabel.visible=!1,this.fillInBox.visible=!1},e.prototype.accept=function(v){this.onAccept(v),this.hide()},e.prototype.hide=function(){H.visible=!1,this.closeIcon.visible=!1,this.button.visible=!1,this.text.visible=!1,this.buttonLabel.visible=!1,this.fillInBox.visible=!1,Input.instance.unsubscribe("BUTTON_DOWN",ActionButton.PRIMARY,this.EButtonAction)},e.prototype.show=function(){H.visible=!0,this.closeIcon.visible=!0,this.button.visible=!0,this.text.visible=!0,this.buttonLabel.visible=!0,this.fillInBox.visible=!0,Input.instance.subscribe("BUTTON_DOWN",ActionButton.PRIMARY,!1,this.EButtonAction)},e}(Entity),Wt=function(T){function o(A,C,R,O){var V=T.call(this)||this;switch(V.elements=[],V.texture=z,V.darkTheme=!1,V.UIOpenTime=0,V.canvas=E,V.UIOpenTime=+Date.now(),V.background=new UIImage(E,z),V.background.hAlign="center",V.background.vAlign="center",V.closeIcon=new UIImage(V.background,V.texture),A||(A=v.PromptStyles.LIGHT),A){case v.PromptStyles.LIGHT:V.texture=z,S(V.background,dt),S(V.closeIcon,gt.closeD),V.closeIcon.positionX=C?C/2-25:175,V.closeIcon.positionY=R?R/2-25:145;break;case v.PromptStyles.DARK:V.texture=M,V.darkTheme=!0,S(V.background,dt),S(V.closeIcon,gt.closeW),V.closeIcon.positionX=C?C/2-25:175,V.closeIcon.positionY=R?R/2-25:145;break;case v.PromptStyles.LIGHTLARGE:V.texture=z,S(V.background,ft),S(V.closeIcon,gt.closeD),V.closeIcon.positionX=C?C/2-25:215,V.closeIcon.positionY=R?R/2-25:165;break;case v.PromptStyles.DARKLARGE:V.texture=M,V.darkTheme=!0,S(V.background,ft),S(V.closeIcon,gt.closeW),V.closeIcon.positionX=C?C/2-25:215,V.closeIcon.positionY=R?R/2-25:165;break;case v.PromptStyles.LIGHTSLANTED:V.texture=z,S(V.background,yt),S(V.closeIcon,gt.closeD),V.closeIcon.positionX=C?C/2-25:215,V.closeIcon.positionY=R?R/2-25:138;break;case v.PromptStyles.DARKSLANTED:V.texture=M,V.darkTheme=!0,S(V.background,yt),S(V.closeIcon,gt.closeW),V.closeIcon.positionX=C?C/2-25:215,V.closeIcon.positionY=R?R/2-25:138;break;default:V.texture=new Texture(A),V.closeIcon.visible=!1}return V.background.source=V.texture,V.background.width=C||V.background.sourceWidth,V.background.height=R||V.background.sourceHeight,V.background.visible=!0,V.closeIcon.width=32,V.closeIcon.height=32,V.closeIcon.source=V.texture,V.closeIcon.onClick=new OnClick((function(){V.hide()})),O&&V.hide(),V}return i(o,T),o.prototype.hide=function(){var v,T;this.background.visible=!1,this.closeIcon.visible=!1;try{for(var A=r(this.elements),C=A.next();!C.done;C=A.next())C.value.hide()}catch(T){v={error:T}}finally{try{C&&!C.done&&(T=A.return)&&T.call(A)}finally{if(v)throw v.error}}},o.prototype.show=function(){var v,T;this.background.visible=!0,this.closeIcon.visible=!0;try{for(var A=r(this.elements),C=A.next();!C.done;C=A.next())C.value.show()}catch(T){v={error:T}}finally{try{C&&!C.done&&(T=A.return)&&T.call(A)}finally{if(v)throw v.error}}},o.prototype.addText=function(v,T,A,C,E){var R=new Kt(this,v,T,A,this.darkTheme,C||void 0,E||void 0);return this.elements.push(R),R},o.prototype.addButton=function(v,T,A,C,E){var R=new qt(this,this.texture,this.UIOpenTime,v,T,A,C,E||void 0);return this.elements.push(R),R},o.prototype.addCheckbox=function(v,T,A,C,E,R,O){var z=new Gt(this,this.texture,this.darkTheme,v,T,A,C||void 0,E||void 0,R||void 0,O||void 0);return this.elements.push(z),z},o.prototype.addSwitch=function(v,T,A,C,E,R,O){var z=new Yt(this,this.texture,this.darkTheme,v,T,A,C||void 0,E||void 0,R||void 0,O||void 0);return this.elements.push(z),z},o.prototype.addIcon=function(v,T,A,C,E,R){var O=new Texture(v),z=new Qt(this,O,T,A,C||void 0,E||void 0,R||void 0);return this.elements.push(z),z},o.prototype.addTextBox=function(v,T,A,C){var E=new Zt(this,v,T,A||void 0,C||void 0);return this.elements.push(E),E},o}(Entity),qt=function(T){function o(A,C,E,O,z,M,V,H){var W=T.call(this)||this;if(W.icon=null,W.image=new UIImage(A.background,C),W.image.positionX=z,W.image.positionY=M,W.image.width=174,W.image.height=46,W.label=new UIText(W.image),H)switch(H){case v.ButtonStyles.E:S(W.image,J),W.label.positionX=25,W.icon=new UIImage(W.image,C),W.icon.width=26,W.icon.height=26,W.icon.hAlign="center",W.icon.vAlign="center",W.icon.isPointerBlocker=!1,S(W.icon,ht),W.icon.positionX=B(O.length);break;case v.ButtonStyles.F:S(W.image,$),W.label.positionX=25,W.icon=new UIImage(W.image,C),W.icon.width=26,W.icon.height=26,W.icon.hAlign="center",W.icon.vAlign="center",W.icon.isPointerBlocker=!1,S(W.icon,pt),W.icon.positionX=B(O.length);break;case v.ButtonStyles.RED:S(W.image,et);break;case v.ButtonStyles.DARK:S(W.image,nt);break;case v.ButtonStyles.ROUNDBLACK:S(W.image,it);break;case v.ButtonStyles.ROUNDWHITE:S(W.image,rt);break;case v.ButtonStyles.ROUNDSILVER:S(W.image,at);break;case v.ButtonStyles.ROUNDGOLD:S(W.image,lt);break;case v.ButtonStyles.SQUAREBLACK:S(W.image,ot);break;case v.ButtonStyles.SQUAREWHITE:S(W.image,st);break;case v.ButtonStyles.SQUARESILVER:S(W.image,ct);break;case v.ButtonStyles.SQUAREGOLD:S(W.image,ut);break;default:S(W.image,at)}else S(W.image,at);return W.label.value=O,W.label.hTextAlign="center",W.label.vTextAlign="center",W.label.fontSize=20,W.label.font=R,W.label.color=H==v.ButtonStyles.ROUNDWHITE||H==v.ButtonStyles.SQUAREWHITE?Color4.Black():Color4.White(),W.label.isPointerBlocker=!1,W.image.onClick=new OnClick((function(){V()})),H==v.ButtonStyles.E?Input.instance.subscribe("BUTTON_DOWN",ActionButton.PRIMARY,!1,(function(v){W.image.visible&&+Date.now()-E>100&&V()})):H==v.ButtonStyles.F&&Input.instance.subscribe("BUTTON_DOWN",ActionButton.SECONDARY,!1,(function(v){W.image.visible&&+Date.now()-E>100&&V()})),W}return i(o,T),o.prototype.hide=function(){this.image.visible=!1},o.prototype.show=function(){this.image.visible=!0},o.prototype.grayOut=function(){this.label.color=Color4.Gray(),this.image.isPointerBlocker=!1,this.icon&&(this.icon.visible=!1)},o.prototype.enable=function(){this.label.color=Color4.White(),this.image.isPointerBlocker=!0,this.icon&&(this.icon.visible=!0)},o}(Entity),Gt=function(v){function e(T,A,C,E,O,z,M,V,H,W){var j=v.call(this)||this;return j.checked=!!W,j.darkTheme=C,j.large=H||!1,j.image=new UIImage(T.background,A),j.image.positionX=O,j.image.positionY=z,j.image.width=H?32:24,j.image.height=H?32:24,0==j.checked?j.uncheck():j.check(),j.label=new UIText(j.image),j.label.positionX=H?40:30,j.label.color=C?Color4.White():Color4.Black(),j.label.value=E,j.label.hTextAlign="left",j.label.vTextAlign="center",j.label.fontSize=20,j.label.font=R,j.label.isPointerBlocker=!1,j.image.onClick=new OnClick((function(){0==j.checked?j.check():j.uncheck(),j.checked?M&&M():V&&V()})),j}return i(e,v),e.prototype.hide=function(){this.image.visible=!1,this.label.visible=!1},e.prototype.show=function(){this.image.visible=!0,this.label.visible=!0},e.prototype.uncheck=function(){this.checked=!1,this.darkTheme?this.large?S(this.image,At):S(this.image,vt):this.large?S(this.image,St):S(this.image,Tt)},e.prototype.check=function(){this.checked=!0,this.darkTheme?this.large?S(this.image,xt):S(this.image,bt):this.large?S(this.image,_t):S(this.image,wt)},e}(Entity),Yt=function(T){function o(A,C,E,O,z,M,V,H,W,j){var X=T.call(this)||this;return X.checked=!!j,X.darkTheme=E,X.style=W||v.SwitchStyles.ROUNDGREEN,X.image=new UIImage(A.background,C),X.image.positionX=z,X.image.positionY=M,X.image.width=64,X.image.height=32,0==X.checked?X.check():X.uncheck(),X.label=new UIText(X.image),X.label.positionX=80,X.label.color=E?Color4.White():Color4.Black(),X.label.value=O,X.label.hTextAlign="left",X.label.vTextAlign="center",X.label.fontSize=20,X.label.font=R,X.label.isPointerBlocker=!1,X.image.onClick=new OnClick((function(){0==X.checked?X.check():X.uncheck(),X.checked?V&&V():H&&H()})),X}return i(o,T),o.prototype.hide=function(){this.image.visible=!1,this.label.visible=!1},o.prototype.show=function(){this.image.visible=!0,this.label.visible=!0},o.prototype.check=function(){switch(this.checked=!0,this.style){case v.SwitchStyles.ROUNDGREEN:S(this.image,Rt);break;case v.SwitchStyles.ROUNDRED:S(this.image,It);break;case v.SwitchStyles.SQUAREGREEN:S(this.image,Nt);break;case v.SwitchStyles.SQUARERED:S(this.image,Pt)}},o.prototype.uncheck=function(){this.checked=!1,this.style==v.SwitchStyles.ROUNDGREEN||this.style==v.SwitchStyles.ROUNDRED?S(this.image,Ct):S(this.image,Ot)},o}(Entity),Qt=function(v){function e(T,A,C,E,R,O,z){var M=v.call(this)||this;return M.image=new UIImage(T.background,A),M.image.positionX=C,M.image.positionY=E,M.image.width=R||128,M.image.height=O||128,M.image.sourceLeft=z&&z.sourceLeft?z.sourceLeft:0,M.image.sourceTop=z&&z.sourceTop?z.sourceTop:0,M.image.sourceWidth=z&&z.sourceWidth?z.sourceWidth:R||128,M.image.sourceHeight=z&&z.sourceHeight?z.sourceHeight:O||128,M}return i(e,v),e.prototype.hide=function(){this.image.visible=!1},e.prototype.show=function(){this.image.visible=!0},e}(Entity),Kt=function(v){function e(T,A,C,E,R,O,z){var M=v.call(this)||this;return M.text=new UIText(T.background),M.text.value=A,M.text.positionX=C||0,M.text.positionY=E||0,M.text.hTextAlign="center",M.text.color=O||(R?Color4.White():Color4.Black()),M.text.fontSize=z||15,M}return i(e,v),e.prototype.hide=function(){this.text.visible=!1},e.prototype.show=function(){this.text.visible=!0},e}(Entity),Zt=function(v){function e(T,A,C,E,O){var z=v.call(this)||this;return z.currentText="",z.fillInBox=new UIInputText(T.background),z.fillInBox.color=Color4.Black(),z.fillInBox.font=R,z.fillInBox.width=312,z.fillInBox.height=46,z.fillInBox.positionX=A,z.fillInBox.positionY=C,z.fillInBox.placeholder=E||"Fill in",z.fillInBox.hTextAlign="center",z.fillInBox.vTextAlign="center",z.fillInBox.fontSize=22,z.fillInBox.onChanged=new OnChanged((function(v){z.fillInBox&&!z.fillInBox.visible||(z.currentText=v.value,O&&O(z.currentText))})),z.fillInBox.onTextSubmit=new OnTextSubmit((function(v){z.fillInBox&&!z.fillInBox.visible||(z.currentText=v.text,O&&O(z.currentText))})),z}return i(e,v),e.prototype.hide=function(){this.fillInBox.visible=!1},e.prototype.show=function(){this.fillInBox.visible=!0},e}(Entity),Jt=function(v){function e(T,A,C,O,z,M){var V=v.call(this)||this;return V.canvas=E,V.uiText=new UIText(E),V.uiText.value=T,V.uiText.hAlign="right",V.uiText.vAlign="bottom",V.uiText.positionX=A||0,V.uiText.positionY=C||0,V.uiText.fontSize=z||25,V.uiText.font=R,V.uiText.vTextAlign="center",V.uiText.hTextAlign="center",V.uiText.color=O||Color4.White(),V.uiText.outlineColor=Color4.Black(),V.uiText.outlineWidth=M?0:.1,V}return i(e,v),e.prototype.hide=function(){this.uiText.visible=!1},e.prototype.show=function(){this.uiText.visible=!0},e.prototype.set=function(v){this.uiText.value=v,this.uiText.visible=!0},e}(Entity),$t=function(v){function e(A,C,R,O){var M=v.call(this)||this;if(M.canvas=E,M.image=new UIImage(E,z),M.image.hAlign="center",M.image.vAlign="center",M.image.positionX=C||0,M.image.positionY=R?R+80:80,M.image.width=O?48*O:48,M.image.height=O?64*O:64,S(M.image,gt.TimerLarge),A&&0!=A){var V=new Entity;engine.addEntity(V),V.addComponentOrReplace(new T(A||3,(function(){M.hide()})))}return M}return i(e,v),e.prototype.hide=function(){this.image.visible=!1},e.prototype.show=function(){this.image.visible=!0},e}(Entity);function Q(v){return v&&"object"==typeof v&&!Array.isArray(v)}function q(v,T){var A=o({},v);return Q(v)&&Q(T)&&Object.keys(T).forEach((function(C){var E,R;Q(T[C])?C in v?A[C]=q(v[C],T[C]):A=o(o({},A),((E={})[C]=T[C],E)):A=o(o({},A),((R={})[C]=T[C],R))})),A}var ee=function(){function t(v,T){this.shape=v,T&&this.setProperties(T)}return t.prototype.setProperties=function(v){var T,A;try{for(var C=r(Object.keys(v)),E=C.next();!E.done;E=C.next()){var R=E.value;this.shape[R]=v[R]}}catch(v){T={error:v}}finally{try{E&&!E.done&&(A=C.return)&&A.call(C)}finally{if(T)throw T.error}}},t.prototype.getProperty=function(v){return this.shape[v]},t}(),ne=function(v){function e(T,A){var C,E,R,O=v.call(this,new UIInputText(T),o(o({},A),{placeholder:null!==(C=null==A?void 0:A.placeholder)&&void 0!==C?C:null==A?void 0:A.value,onFocus:new OnFocus((function(){var v;O.isInputFocused=!0,null===(v=null==A?void 0:A.onFocus)||void 0===v||v.call(A)})),onBlur:new OnBlur((function(){var v,T;O.isInputFocused=!1,""===O.inputValue&&void 0!==O.placeholder?(O.setInputValue(O.placeholder),null===(v=null==A?void 0:A.onBlur)||void 0===v||v.call(A,!0)):null===(T=null==A?void 0:A.onBlur)||void 0===T||T.call(A,!1)})),onChanged:new OnChanged((function(v){var T,C=v.value;if(O.shape.visible&&(O.inputValue=C,C!==O.placeholder&&(""===C&&(O.shape.placeholder=""),O.isInputFocused||""===C))){var E=null!==(T=null==A?void 0:A.waitTime)&&void 0!==T?T:e.DEFAULT_WAIT_TIME;setTimeout((function(){var v;O.inputValue===C&&(null===(v=null==A?void 0:A.onChanged)||void 0===v||v.call(A,C))}),E)}})),onTextSubmit:new OnTextSubmit((function(v){var T=v.text,C=T.substr(0,T.length-1),E=null==A?void 0:A.onTextSubmit;E?E(C):setTimeout((function(){return O.shape.placeholder=C}),0)}))}))||this;return O.inputValue="",O.isInputFocused=!1,O.placeholder=O.shape.placeholder,O.inputValue=null!==(R=null!==(E=null==A?void 0:A.value)&&void 0!==E?E:null==A?void 0:A.placeholder)&&void 0!==R?R:"",O.isInputFocused=!1,O}return i(e,v),e.prototype.getValue=function(){return this.inputValue},e.prototype.isFocused=function(){return this.isInputFocused},e.prototype.setInputValue=function(v){var T=this.isInputFocused;this.isInputFocused=!1,this.shape.placeholder="",this.inputValue=this.shape.placeholder=v,this.isInputFocused=T},e.prototype.reset=function(){this.setInputValue(this.placeholder)},e.prototype.hide=function(){this.setProperties({visible:!1})},e.prototype.show=function(){this.setProperties({visible:!0}),this.setInputValue(this.inputValue)},e.DEFAULT_WAIT_TIME=650,e}(ee),ie=function(v){function e(T,A){var C=v.call(this,new UIContainerRect(T),o({isPointerBlocker:!0},A))||this,E=new UIImage(C.shape,new Texture("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII="));return E.width="100%",E.height="100%",E.sourceWidth=1,E.sourceHeight=1,E.isPointerBlocker=!0,C.image=E,(null==A?void 0:A.onClick)&&C.setOnClick(A.onClick),C}return i(e,v),e.prototype.performClick=function(){var v;null===(v=this.image.onClick)||void 0===v||v.callback({})},e.prototype.setOnClick=function(v){this.image.onClick=new OnClick(v)},e.prototype.clearOnClick=function(){this.image.onClick=null},e}(ee),oe=function(v){function e(T,A){var C=v.call(this,new UIContainerRect(T),o({width:"100%",vAlign:"top",visible:!1},A))||this;C.config=o(o({},e.DEFAULTS),A);var E=new ie(C.shape,{width:"100%",height:"100%",color:Color4.Clear()});C.clickableContainer=E;var R=new UIImage(E.shape,new Texture("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII="));R.width=R.height=C.config.imageSize,R.hAlign="left",R.positionX=10,R.vAlign="center",C.image=R;var O=new UIText(E.shape);O.vAlign="top",O.hAlign="left",O.vTextAlign="top",O.fontSize=C.config.topFontSize,O.color=C.config.topTextColor,O.positionX=55,O.positionY=-10,O.isPointerBlocker=!1,C.topLeftText=O;var z=new UIText(E.shape);z.vAlign="top",z.hAlign="right",z.vTextAlign="top",z.hTextAlign="right",z.fontSize=O.fontSize,z.color=O.color,z.isPointerBlocker=!1,z.positionX=-10,z.positionY=O.positionY,C.topRightText=z;var M=new UIText(E.shape);M.vAlign="bottom",M.hAlign="left",M.vTextAlign="bottom",M.fontSize=C.config.bottomFontSize,M.color=C.config.bottomTextColor,M.positionX=O.positionX,M.positionY=10,M.isPointerBlocker=!1,C.bottomLeftText=M;var V=new UIText(E.shape);return V.vAlign="bottom",V.hAlign="right",V.vTextAlign="bottom",V.hTextAlign="right",V.fontSize=M.fontSize,V.color=M.color,V.isPointerBlocker=!1,V.positionX=z.positionX,V.positionY=M.positionY,C.bottomRightText=V,C}return i(e,v),e.prototype.setOption=function(v,T){this.image.visible=!1,this.topRightText.visible=!1,this.bottomLeftText.visible=!1,this.bottomRightText.visible=!1,v.image?(this.image.source=new Texture(v.image.src),this.image.sourceWidth=v.image.sourceWidth,this.image.sourceHeight=v.image.sourceHeight,this.image.visible=!0,this.topLeftText.positionX=this.config.imageSize+20):this.topLeftText.positionX=10,"string"==typeof v.visualText?(this.topLeftText.value=v.visualText,this.topLeftText.vAlign=this.topLeftText.vTextAlign="center",this.topLeftText.positionY=0):"text"in v.visualText?(this.topLeftText.vAlign=this.topLeftText.vTextAlign="top",this.topLeftText.positionY=-10,this.topLeftText.value=v.visualText.text,this.bottomLeftText.value=v.visualText.subText,this.bottomLeftText.visible=!0,this.bottomLeftText.positionX=this.topLeftText.positionX):"bottomLeft"in v.visualText&&(this.topLeftText.vAlign=this.topLeftText.vTextAlign="top",this.topLeftText.positionY=-10,this.topLeftText.value=v.visualText.topLeft,this.topRightText.value=v.visualText.topRight,this.bottomLeftText.value=v.visualText.bottomLeft,this.bottomRightText.value=v.visualText.bottomRight,this.topRightText.visible=!0,this.bottomLeftText.visible=!0,this.bottomRightText.visible=!0,this.bottomLeftText.positionX=this.topLeftText.positionX),T?this.clickableContainer.setOnClick(T):this.clickableContainer.clearOnClick()},e.prototype.setProperties=function(T){v.prototype.setProperties.call(this,T)},e.prototype.getProperty=function(T){return v.prototype.getProperty.call(this,T)},e.prototype.performClick=function(){this.clickableContainer.performClick()},e.DEFAULTS={topFontSize:14,bottomFontSize:14,imageSize:36,topTextColor:Color4.FromInts(14,16,60,255),bottomTextColor:Color4.FromInts(117,120,181,255)},e}(ee),se=function(v){function e(T,A,C,E){var R=v.call(this,new UIContainerRect(T),o({},C))||this;R.onSuccessfulSelection=E,R.uiOptions=[],R.options={},C.visible,C.opacity,C.hAlign,C.vAlign,C.positionX,C.positionY;var O=n(C,["visible","opacity","hAlign","vAlign","positionX","positionY"]);R.config=q(e.DEFAULTS,O),R.setProperties({width:R.config.width,height:R.config.initialHeight,color:R.config.borderColor}),R.setItems(A.items,A.dropdownDefaultItemIds);var M=new UIContainerRect(R.shape);M.color=R.config.backgroundColor,M.width=R.config.width-2*R.config.borderSize,M.height=R.config.initialHeight-2*R.config.borderSize,R.insideContainer=M;var V=new ne(M,{vAlign:"top",hTextAlign:"left",vTextAlign:"center",width:"92%",fontSize:R.config.search.fontSize,placeholder:R.config.search.placeholder.defaultText,color:R.config.search.textColor,focusedBackground:Color4.Clear(),height:.95*R.config.initialHeight,onBlur:function(){return R.close()},onTextSubmit:function(){R.uiOptions[0].getProperty("visible")?R.uiOptions[0].performClick():R.close()},onChanged:function(v){if(R.hideAllOptions(),v===R.config.search.placeholder.defaultText||""===v)R.showDefaultOptions();else{var T=v.toLowerCase(),A=[];for(var C in R.options){var E=R.options[C];if(E.searchBy.toLowerCase().indexOf(T)>=0&&(A.push(E),A.length===R.config.options.maxVisibleOptions))break}A.length>0?R.showOptions(A):R.showErrorMessage("Sorry, we can't find \""+v+'"')}}});R.inputText=V;for(var H=0;H<R.config.options.maxVisibleOptions;H++){var W=new oe(M,o(o({},R.config.options),{height:R.config.initialHeight,positionY:-R.config.initialHeight-R.config.initialHeight*H,color:H%2==0?R.config.options.oddBackgroundColor:M.color}));R.uiOptions.push(W)}var j=new UIImage(M,z);j.onClick=new OnClick((function(){return R.close()})),j.sourceTop=305,j.sourceLeft=985,j.sourceWidth=j.sourceHeight=35,j.width=j.height=18,j.hAlign="right",j.vAlign="top",j.positionX=-12,j.positionY=-12,j.visible=j.isPointerBlocker=!0;var X=new UIText(M);return X.height=20,X.visible=!1,X.width="92%",X.hTextAlign="center",X.vAlign="bottom",X.positionY=20,X.fontSize=R.config.errorMessage.fontSize,X.color=R.config.errorMessage.textColor,R.errorMessage=X,R}return i(e,v),e.prototype.open=function(){this.setProperties({visible:!0}),this.showDefaultOptions()},e.prototype.close=function(){this.setProperties({visible:!1}),this.inputText.reset()},e.prototype.setItems=function(v,T){this.options=v.reduce((function(v,T){var A;return T.searchBy=null!==(A=T.searchBy)&&void 0!==A?A:"string"==typeof T.visualText?T.visualText:"text"in T.visualText?T.visualText.text:T.visualText.topLeft,v[T.id]=T,v}),{}),T?this.setDropdownDefaults(T):this.defaultOptions=T,this.hideAllOptions()},e.prototype.setDropdownDefaults=function(v){var T,A;try{for(var C=r(v),E=C.next();!E.done;E=C.next()){var R=E.value;if(!(R in this.options))return void error("Couldn't find an option with id '"+R+"'. Will not set new defaults")}}catch(v){T={error:v}}finally{try{E&&!E.done&&(A=C.return)&&A.call(C)}finally{if(T)throw T.error}}this.defaultOptions=v},e.prototype.showDefaultOptions=function(){var v,T=this;if(this.defaultOptions)v=this.defaultOptions.map((function(v){return T.options[v]})).slice(0,this.config.options.maxVisibleOptions);else for(var A in v=[],this.options)if(v.push(this.options[A]),v.length===this.config.options.maxVisibleOptions)break;this.showOptions(v)},e.prototype.showOptions=function(v){var T=this;this.resizeHeight(this.config.initialHeight*v.length+2*this.config.borderSize),v.forEach((function(v,A){var C=T.uiOptions[A];C.setOption(v,(function(){T.onSuccessfulSelection(v),T.setProperties({visible:!1})})),C.setProperties({visible:!0})})),this.errorMessage.visible=!1},e.prototype.hideAllOptions=function(){this.uiOptions.forEach((function(v){return v.setProperties({visible:!1})}))},e.prototype.showErrorMessage=function(v){this.errorMessage.visible=!0,this.errorMessage.value=v,this.resizeHeight(60)},e.prototype.resizeHeight=function(v){this.setProperties({height:this.config.initialHeight+v}),this.insideContainer.height=this.config.initialHeight+v-2*this.config.borderSize},e.DEFAULTS={borderColor:Color4.FromInts(232,236,253,255),backgroundColor:Color4.White(),borderSize:2,width:300,initialHeight:60,search:{fontSize:16,textColor:Color4.FromInts(24,26,70,255),placeholder:{defaultText:"Click to search",textColor:Color4.FromInts(118,120,181,200)}},options:{maxVisibleOptions:5,oddBackgroundColor:Color4.FromInts(246,246,255,255),topFontSize:14,bottomFontSize:14,imageSize:36,topTextColor:Color4.FromInts(14,16,60,255),bottomTextColor:Color4.FromInts(117,120,181,255)},errorMessage:{fontSize:13,textColor:Color4.FromInts(125,127,157,255)}},e}(ee),ae=function(v){function e(T,A,C,E){var R=v.call(this,new UIContainerRect(T),o({},C))||this;R.onSuccessfulSelection=E,C.visible,C.opacity,C.hAlign,C.vAlign,C.positionX,C.positionY;var O=n(C,["visible","opacity","hAlign","vAlign","positionX","positionY"]);R.config=q(se.DEFAULTS,O),R.setProperties({width:R.config.width,height:R.config.initialHeight,color:R.config.borderColor});var z=new ie(R.shape,{color:R.config.backgroundColor,width:R.config.width-2*R.config.borderSize,height:R.config.initialHeight-2*R.config.borderSize,onClick:function(){return R.uiSearchPrompt.open()}}),M=new oe(z.shape,o(o({},R.config.options),{height:R.config.initialHeight,color:Color4.Clear(),width:R.config.width-2*R.config.borderSize-20,visible:!0,hAlign:"left",isPointerBlocker:!1})),V=new UIText(z.shape);if(V.value="Click to select an option",V.fontSize=R.config.search.fontSize,V.color=R.config.search.placeholder.textColor,V.vTextAlign=V.hTextAlign="center",V.positionX=-R.config.borderSize-10,V.isPointerBlocker=!1,V.opacity=V.color.a,R.initialText=V,null==A?void 0:A.initialItemId){var H=A.items.filter((function(v){return v.id===A.initialItemId}))[0];H&&(M.setOption(H),R.initialText.visible=!1)}var W=new Texture("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABAAgMAAADXB5lNAAAAA3NCSVQICAjb4U/gAAAACXBIWXMAAAN5AAADeQELGyzWAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAAAlQTFRF////AAAAAAAAflGpXQAAAAJ0Uk5TAICbK04YAAAAeklEQVQ4je3PsRXEMAgE0VFCEapG9agaiiDRVXkJxlpq8IYT/AfwTbZ/ssPUEJgGZ2hYDTmgSIAiDoqsdskBRQIUcVBktXdO/jeVuBDPMBpRyEMUEhVMiUKKSOQlEokrmBKJXARsJWAqAaYEjEbAVgJmtGDewmjEt9wfISOqAUzY2sAAAAAASUVORK5CYII="),j=new UIImage(z.shape,W);return j.sourceWidth=j.sourceHeight=64,j.height=15,j.width=12,j.hAlign="right",j.vAlign="center",j.positionX=-10,j.visible=!0,j.isPointerBlocker=!1,R.uiSearchPrompt=new se(R.shape,A,o(o({},C),{visible:!1,vAlign:"top",initialHeight:R.config.initialHeight-2*R.config.borderSize}),(function(v){M.setOption(v),R.initialText.visible=!1,R.onSuccessfulSelection(v)})),R}return i(e,v),e.prototype.open=function(){this.setProperties({visible:!0})},e.prototype.close=function(){this.setProperties({visible:!1})},e.prototype.setSearchItems=function(v,T){this.uiSearchPrompt.setItems(v,T)},e.prototype.setSearchDropdownDefaults=function(v){this.uiSearchPrompt.setDropdownDefaults(v)},e}(ee);v.CenterImage=kt,v.CornerLabel=Jt,v.CustomPrompt=Wt,v.CustomPromptButton=qt,v.CustomPromptCheckBox=Gt,v.CustomPromptIcon=Qt,v.CustomPromptSwitch=Yt,v.CustomPromptText=Kt,v.CustomPromptTextBox=Zt,v.FillInPrompt=Ht,v.LargeIcon=Bt,v.LoadingIcon=$t,v.MediumIcon=Lt,v.OkPrompt=Ut,v.OptionPrompt=Vt,v.SFFont=R,v.SFHeavyFont=O,v.SmallIcon=Ft,v.UIBar=zt,v.UICounter=Z,v.UISearchPrompt=se,v.UISelectBox=ae,v.canvas=E,v.darkTheme=M,v.displayAnnouncement=function(v,A,C,E,R){V.visible=!0,V.value=v,V.color=C||Color4.Yellow(),V.fontSize=E||50,V.font=O,V.outlineColor=Color4.Black(),V.outlineWidth=R?0:.1,V.adaptWidth=!1,V.textWrapping=!0,V.width=900;var z=new Entity;engine.addEntity(z),-1!=A&&z.addComponentOrReplace(new T(A||3,(function(){V.visible=!1})))},v.hideAnnouncements=function(){V.visible=!1},v.lightTheme=z,Object.defineProperty(v,"__esModule",{value:!0})}));var __extends=this&&this.__extends||function(){var extendStatics=function(v,T){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,T){v.__proto__=T}||function(v,T){for(var A in T)Object.prototype.hasOwnProperty.call(T,A)&&(v[A]=T[A])},extendStatics(v,T)};return function(v,T){if("function"!=typeof T&&null!==T)throw new TypeError("Class extends value "+String(T)+" is not a constructor or null");function __(){this.constructor=v}extendStatics(v,T),v.prototype=null===T?Object.create(T):(__.prototype=T.prototype,new __)}}(),__awaiter=this&&this.__awaiter||function(v,T,A,C){return new(A||(A=Promise))((function(E,R){function fulfilled(v){try{step(C.next(v))}catch(v){R(v)}}function rejected(v){try{step(C.throw(v))}catch(v){R(v)}}function step(v){var T;v.done?E(v.value):(T=v.value,T instanceof A?T:new A((function(v){v(T)}))).then(fulfilled,rejected)}step((C=C.apply(v,T||[])).next())}))},__generator=this&&this.__generator||function(v,T){var A,C,E,R,O={label:0,sent:function(){if(1&E[0])throw E[1];return E[1]},trys:[],ops:[]};return R={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(R[Symbol.iterator]=function(){return this}),R;function verb(R){return function(z){return function(R){if(A)throw new TypeError("Generator is already executing.");for(;O;)try{if(A=1,C&&(E=2&R[0]?C.return:R[0]?C.throw||((E=C.return)&&E.call(C),0):C.next)&&!(E=E.call(C,R[1])).done)return E;switch(C=0,E&&(R=[2&R[0],E.value]),R[0]){case 0:case 1:E=R;break;case 4:return O.label++,{value:R[1],done:!1};case 5:O.label++,C=R[1],R=[0];continue;case 7:R=O.ops.pop(),O.trys.pop();continue;default:if(!((E=(E=O.trys).length>0&&E[E.length-1])||6!==R[0]&&2!==R[0])){O=0;continue}if(3===R[0]&&(!E||R[1]>E[0]&&R[1]<E[3])){O.label=R[1];break}if(6===R[0]&&O.label<E[1]){O.label=E[1],E=R;break}if(E&&O.label<E[2]){O.label=E[2],O.ops.push(R);break}E[2]&&O.ops.pop(),O.trys.pop();continue}R=T.call(v,O)}catch(v){R=[6,v],C=0}finally{A=E=0}if(5&R[0])throw R[1];return{value:R[0]?R[1]:void 0,done:!0}}([R,z])}}},__decorate=this&&this.__decorate||function(v,T,A,C){var E,R=arguments.length,O=R<3?T:null===C?C=Object.getOwnPropertyDescriptor(T,A):C;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)O=Reflect.decorate(v,T,A,C);else for(var z=v.length-1;z>=0;z--)(E=v[z])&&(O=(R<3?E(O):R>3?E(T,A,O):E(T,A))||O);return R>3&&O&&Object.defineProperty(T,A,O),O},__values=this&&this.__values||function(v){var T="function"==typeof Symbol&&Symbol.iterator,A=T&&v[T],C=0;if(A)return A.call(v);if(v&&"number"==typeof v.length)return{next:function(){return v&&C>=v.length&&(v=void 0),{value:v&&v[C++],done:!v}}};throw new TypeError(T?"Object is not iterable.":"Symbol.iterator is not defined.")};define("berlage/floor",["require","exports"],(function(v,T){Object.defineProperty(T,"__esModule",{value:!0}),T.Floor=void 0;var A=function(v){function Floor(T){var A=v.call(this)||this;return engine.addEntity(A),A.addComponent(new Transform({position:T,scale:new Vector3(1,1,1),rotation:(new Quaternion).setEuler(0,0,0)})),A.addComponent(new GLTFShape("models/floor/floor.gltf")),A}return __extends(Floor,v),Floor}(Entity);T.Floor=A})),define("berlage/berlage",["require","exports"],(function(v,T){Object.defineProperty(T,"__esModule",{value:!0}),T.Berlage=void 0;var A=function(v){function Berlage(){var T=v.call(this)||this;return engine.addEntity(T),T.addComponent(new Transform({position:new Vector3(15.8,0,24),scale:new Vector3(1,1,1),rotation:(new Quaternion).setEuler(0,-90,0)})),T.addComponent(new GLTFShape("models/berlage/berlage.gltf")),T}return __extends(Berlage,v),Berlage}(Entity);T.Berlage=A})),define("berlage/teleporter",["require","exports"],(function(v,T){Object.defineProperty(T,"__esModule",{value:!0}),T.Teleporter=void 0;var A=function(v){function Teleporter(T,A,C){var E=v.call(this)||this;return engine.addEntity(E),E.addComponent(new Transform({position:C,scale:new Vector3(1,1,1),rotation:(new Quaternion).setEuler(0,0,0)})),E.addComponent(new GLTFShape("models/berlage/teleporter.gltf")),E.addComponent(new OnPointerDown((function(v){teleportTo(A)}),{hoverText:T+" "+A})),E}return __extends(Teleporter,v),Teleporter}(Entity);T.Teleporter=A})),define("berlage/social-link",["require","exports"],(function(v,T){Object.defineProperty(T,"__esModule",{value:!0}),T.SocialLink=void 0;var A=function(v){function SocialLink(T,A,C,E,R,O){void 0===R&&(R=(new Quaternion).setEuler(0,-45,0)),void 0===O&&(O=new Vector3(2,2,2));var z=v.call(this)||this;return engine.addEntity(z),z.addComponent(new Transform({position:E,scale:O,rotation:R})),z.addComponent(new GLTFShape("models/socials/"+A)),z.addComponent(new OnPointerDown((function(v){openExternalURL(C)}),{hoverText:T})),z}return __extends(SocialLink,v),SocialLink}(Entity);T.SocialLink=A})),define("berlage/rotator",["require","exports"],(function(v,T){Object.defineProperty(T,"__esModule",{value:!0}),T.Rotator=void 0;var A=function(){function Rotator(v,T){void 0===T&&(T=30),this.entities=v,this.timer=0,this.speed=30,this.rotation=0,this.speed=T}return Rotator.prototype.update=function(v){var T=this;this.timer+=v,this.entities.forEach((function(v){v.getComponent(Transform).rotation.setEuler(T.rotation,T.timer*T.speed,0)}))},Rotator}();T.Rotator=A})),define("berlage/eth",["require","exports"],(function(v,T){Object.defineProperty(T,"__esModule",{value:!0}),T.Eth=void 0;var A=function(v){function Eth(T,A,C){void 0===A&&(A=(new Quaternion).setEuler(0,-45,0)),void 0===C&&(C=new Vector3(1,1,1));var E=v.call(this)||this;return engine.addEntity(E),E.addComponent(new Transform({position:T,scale:C,rotation:A})),E.addComponent(new GLTFShape("models/berlage/eth.gltf")),E}return __extends(Eth,v),Eth}(Entity);T.Eth=A})),define("berlage/arrow",["require","exports","@decentraland/RestrictedActions"],(function(v,T,A){Object.defineProperty(T,"__esModule",{value:!0}),T.ArrowDown=T.ArrowUp=void 0;var C=function(v){function ArrowUp(T,C,E){void 0===C&&(C=(new Quaternion).setEuler(0,0,0)),void 0===E&&(E=new Vector3(2,2,2));var R=v.call(this)||this;return engine.addEntity(R),R.addComponent(new Transform({position:T,scale:E,rotation:C})),R.addComponent(new GLTFShape("models/socials/arrow.gltf")),R.addComponent(new OnPointerDown((function(v){(0,A.movePlayerTo)({x:6.5,y:55,z:40},{x:8,y:1,z:8})}),{hoverText:"Up"})),R}return __extends(ArrowUp,v),ArrowUp}(Entity);T.ArrowUp=C;var E=function(v){function ArrowDown(T,C,E){void 0===C&&(C=(new Quaternion).setEuler(180,-45,0)),void 0===E&&(E=new Vector3(2,2,2));var R=v.call(this)||this;return engine.addEntity(R),R.addComponent(new Transform({position:T,scale:E,rotation:C})),R.addComponent(new GLTFShape("models/socials/arrow.gltf")),R.addComponent(new OnPointerDown((function(v){(0,A.movePlayerTo)({x:15,y:20,z:37},{x:8,y:1,z:8})}),{hoverText:"Up"})),R}return __extends(ArrowDown,v),ArrowDown}(Entity);T.ArrowDown=E})),define("berlage/poap/sounds",["require","exports"],(function(v,T){Object.defineProperty(T,"__esModule",{value:!0}),T.PlayCoinSound=T.PlayCloseSound=T.PlayOpenSound=T.coinSound=T.closeDialogSound=T.openDialogSound=void 0,T.openDialogSound=new Entity,T.openDialogSound.addComponent(new Transform),T.openDialogSound.addComponent(new AudioSource(new AudioClip("sounds/navigationForward.mp3"))),T.openDialogSound.getComponent(AudioSource).volume=.5,engine.addEntity(T.openDialogSound),T.openDialogSound.setParent(Attachable.AVATAR),T.closeDialogSound=new Entity,T.closeDialogSound.addComponent(new Transform),T.closeDialogSound.addComponent(new AudioSource(new AudioClip("sounds/navigationBackward.mp3"))),T.closeDialogSound.getComponent(AudioSource).volume=.5,engine.addEntity(T.closeDialogSound),T.closeDialogSound.setParent(Attachable.AVATAR),T.coinSound=new Entity,T.coinSound.addComponent(new Transform),T.coinSound.addComponent(new AudioSource(new AudioClip("sounds/star-collect.mp3"))),T.coinSound.getComponent(AudioSource).volume=.5,T.coinSound.getComponent(AudioSource).loop=!1,engine.addEntity(T.coinSound),T.coinSound.setParent(Attachable.AVATAR),T.PlayOpenSound=function(){T.openDialogSound.getComponent(AudioSource).playOnce()},T.PlayCloseSound=function(){T.closeDialogSound.getComponent(AudioSource).playOnce()},T.PlayCoinSound=function(){T.coinSound.getComponent(AudioSource).playOnce()}})),define("berlage/poap/ui",["require","exports","@dcl/ecs-scene-utils","@dcl/ui-scene-utils","berlage/poap/sounds"],(function(v,T,A,C,E){Object.defineProperty(T,"__esModule",{value:!0}),T.viewSuccessMessage=T.alreadyClaimed=T.captcha=T.metamask=void 0,T.metamask=function(){var v=new C.CustomPrompt;v.addText("A MetaMask Digital wallet\nis required to claim this token.",0,25,Color4.Black(),20),v.addButton("Get MetaMask",-100,-100,(function(){openExternalURL("https://metamask.io/")}),C.ButtonStyles.RED),v.addButton("Cancel",100,-100,(function(){(0,E.PlayCloseSound)(),v.hide()}),C.ButtonStyles.F)},T.captcha=function(v,T){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(A){return[2,new Promise((function(A){var E=new C.CustomPrompt("dark",600,370);E.addText("Please complete this captcha",0,160,Color4.White(),24),E.addIcon("https://".concat(v,"/captcha/").concat(T),0,40,500,150,{sourceHeight:0,sourceWidth:0});var R="";E.addTextBox(0,-75,"",(function(v){R=v})),E.addButton("Submit",100,-140,(function(){E.hide(),A(R)}),C.ButtonStyles.ROUNDGOLD),E.addButton("Cancel",-100,-140,(function(){E.hide(),A(void 0)}),C.ButtonStyles.ROUNDBLACK)}))]}))}))},T.alreadyClaimed=function(){var v=new C.CustomPrompt;v.addText("Already attempted",0,120,Color4.Red(),24),v.addText("You've already requested to\nclaim this POAP token.",0,50,Color4.Black(),22),v.addButton("See my POAPs",-100,-100,(function(){openExternalURL("https://app.poap.xyz")}),C.ButtonStyles.DARK),v.addButton("Ok",100,-100,(function(){v.hide(),(0,E.PlayCloseSound)()}),C.ButtonStyles.E)},T.viewSuccessMessage=function(v,T,R,O){(0,E.PlayCoinSound)();var z=new Texture(T,{hasAlpha:!0}),M=new UIText(C.canvas);M.value=v,M.color=Color4.Yellow(),M.outlineColor=Color4.Black(),M.outlineWidth=.1,M.positionY=-85,M.visible=!0,M.fontSize=30,M.hTextAlign="center",M.hAlign="center";var V=new UIImage(C.canvas,z);V.hAlign="center",V.vAlign="center",V.positionY=90,V.width=256,V.height=256,V.sourceLeft=0,V.sourceTop=0,V.sourceHeight=O,V.sourceWidth=R,V.visible=!0;var H=new UIText(C.canvas);H.value="This POAP token is being sent to your wallet",H.color=Color4.Black(),H.positionY=-128,H.visible=!0,H.fontSize=30,H.hTextAlign="center",H.hAlign="center",A.setTimeout(7e3,(function(){M.visible=!1,V.visible=!1,H.visible=!1}))}})),define("berlage/poap/dispenser",["require","exports","@dcl/ecs-scene-utils","@dcl/ui-scene-utils","berlage/poap/ui","@decentraland/Identity","@decentraland/EnvironmentAPI","berlage/poap/sounds","@decentraland/SignedFetch"],(function(v,T,A,C,E,R,O,z,M){Object.defineProperty(T,"__esModule",{value:!0}),T.createDispenser=T.sceneMessageBus=void 0,T.sceneMessageBus=new MessageBus,T.createDispenser=function(v,V,H){var W=H||"poap-api.decentraland.org",j=!1,X=new Entity;engine.addEntity(X),V=V,X.addComponent(new Transform(v));var K=new AnimationState("Idle_POAP",{looping:!0});X.addComponent(new Animator),X.getComponent(Animator).addClip(K),X.getComponent(Animator).addClip(new AnimationState("Action_POAP",{looping:!1})),K.play();var Z=new Entity;function getCaptcha(){return __awaiter(this,void 0,void 0,(function(){var v;return __generator(this,(function(T){switch(T.label){case 0:return[4,(0,M.signedFetch)("https://".concat(W,"/captcha"),{method:"POST"})];case 1:return(v=T.sent()).text?[2,JSON.parse(v.text).data.uuid]:[2,"undefined"]}}))}))}function claimCall(v,T,A){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(C){switch(C.label){case 0:return[4,fetch("https://".concat(W,"/claim/").concat(V),{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({address:T.publicKey,catalyst:A.domain,room:A.room,captcha:v})})];case 1:return[2,C.sent()]}}))}))}return Z.addComponent(new GLTFShape("models/socials/poap-berlage.gltf")),Z.addComponent(new Animator),Z.getComponent(Animator).addClip(new AnimationState("Button_Action",{looping:!1})),Z.setParent(X),Z.addComponent(new OnPointerDown((function(v){Z.getComponent(Animator).getClip("Button_Action").play(),function(){__awaiter(this,void 0,void 0,(function(){var v,A,M,V,H,X;return __generator(this,(function(K){switch(K.label){case 0:return[4,(0,R.getUserData)()];case 1:return(v=K.sent())&&v.hasConnectedWeb3?j?((0,z.PlayCloseSound)(),E.alreadyClaimed(),[2]):(j=!0,[4,(0,O.getCurrentRealm)()]):(log("no wallet"),(0,z.PlayCloseSound)(),E.metamask(),[2]);case 2:A=K.sent(),K.label=3;case 3:return K.trys.push([3,8,,9]),[4,getCaptcha()];case 4:return M=K.sent(),[4,E.captcha(W,M)];case 5:return void 0===(V=K.sent())?(j=!1,[2]):A?[4,claimCall(V,v,A)]:[2];case 6:return H=K.sent(),log(H),log(H.status),[4,H.json()];case 7:return X=K.sent(),log(X),200===H.status?(E.viewSuccessMessage(X.data.event.name,X.data.event.image_url,1024,1024),T.sceneMessageBus.emit("activatePoap",{})):((0,z.PlayCloseSound)(),"Address already claimed a code for this event"===X.error?C.displayAnnouncement("You already claimed this event",3):(j=!1,C.displayAnnouncement('Oops, there was an error: "'.concat(X.error,'"'),3))),[3,9];case 8:return K.sent(),j=!1,log("Error fetching from POAP server ",W),[3,9];case 9:return[2]}}))}))}()}),{hoverText:"Get Attendance Token"})),engine.addEntity(Z),T.sceneMessageBus.on("activatePoap",(function(){var v;(v=X.getComponent(Animator)).getClip("Action_POAP").play(),X.addComponentOrReplace(new A.Delay(4e3,(function(){v.getClip("Action_POAP").stop(),v.getClip("Idle_POAP").play()})))})),X}})),define("game",["require","exports","berlage/floor","berlage/berlage","berlage/teleporter","berlage/social-link","berlage/rotator","berlage/eth","berlage/arrow","berlage/poap/dispenser"],(function(v,T,A,C,E,R,O,z,M,V){Object.defineProperty(T,"__esModule",{value:!0});var H=new C.Berlage;new A.Floor(new Vector3(8,.1,8)),new A.Floor(new Vector3(24,.1,8)),new A.Floor(new Vector3(8,.1,24)),new A.Floor(new Vector3(24,.1,24)),new A.Floor(new Vector3(8,.1,40)),new A.Floor(new Vector3(24,.1,40)),new E.Teleporter("Teleport to IRL-Art","-42,49",new Vector3(14.5,1.72,39)),new E.Teleporter("Teleport to IRL-Art","-42,49",new Vector3(16.75,1.72,39)),new E.Teleporter("Teleport to IRL-Art","-42,49",new Vector3(19,1.72,39)),new M.ArrowUp(new Vector3(12,20,37)),new M.ArrowDown(new Vector3(6.5,41,40));var W=1.15,j=6.1,X=new R.SocialLink("Discord","discord.gltf","https://discord.gg/FhmA3KeF3B",new Vector3(W,5.4,j)),K=new R.SocialLink("Twitter","twitter.gltf","https://twitter.com/efdevconnect",new Vector3(W,4.4,j)),Z=new R.SocialLink("Telegram","devconnect.gltf","https://devconnect.org/",new Vector3(W,3.4,j)),J=new R.SocialLink("Telegram","telegram.gltf","https://t.me/efdevconnect",new Vector3(W,2.4,j));engine.addSystem(new O.Rotator([X],20)),engine.addSystem(new O.Rotator([K],30)),engine.addSystem(new O.Rotator([Z],40)),engine.addSystem(new O.Rotator([J],50));var $=new z.Eth(new Vector3(-13.2,2.9,14.85)),et=new z.Eth(new Vector3(10.8,2.9,14.85)),nt=new z.Eth(new Vector3(19.8,2.9,-1),void 0,new Vector3(.444,.444,.444));engine.addSystem(new O.Rotator([$,et,nt],30)),[X,K,Z,J,$,et,nt].forEach((function(v){v.setParent(H)})),(0,V.createDispenser)({position:new Vector3(8,42,41),scale:new Vector3(2,2,2),rotation:Quaternion.Euler(0,0,0)},"3add5ac5-62f1-495e-9ab5-d14766324a83")})),define("radioUtils",["require","exports"],(function(v,T){Object.defineProperty(T,"__esModule",{value:!0}),T.RadioDelayManager=T.Delay=void 0;var A=function(){function Delay(v,T){this.timer=v/1e3,this.action=T}return __decorate([Component("org.decentraland.radioDelay")],Delay)}();T.Delay=A;var C=function(){function RadioDelayManager(){this.group=engine.getComponentGroup(A)}return RadioDelayManager.prototype.update=function(v){var T,C;try{for(var E=__values(this.group.entities),R=E.next();!R.done;R=E.next()){var O=R.value,z=O.getComponent(A);z.timer-=v,z.timer<0&&(z.action(),O.removeComponent(A))}}catch(v){T={error:v}}finally{try{R&&!R.done&&(C=E.return)&&C.call(E)}finally{if(T)throw T.error}}},RadioDelayManager}();T.RadioDelayManager=C})),define("entities/berlage",["require","exports"],(function(v,T){Object.defineProperty(T,"__esModule",{value:!0}),T.Berlage=void 0;var A=function(v){function Berlage(){var T=v.call(this)||this;return engine.addEntity(T),T.addComponent(new Transform({position:new Vector3(15.8,0,24),scale:new Vector3(1,1,1),rotation:(new Quaternion).setEuler(0,-90,0)})),T.addComponent(new GLTFShape("models/05_berlage.gltf")),T}return __extends(Berlage,v),Berlage}(Entity);T.Berlage=A})),define("entities/teleporter",["require","exports"],(function(v,T){Object.defineProperty(T,"__esModule",{value:!0}),T.Teleporter=void 0;var A=function(v){function Teleporter(){var T=v.call(this)||this;return engine.addEntity(T),T.addComponent(new Transform({position:new Vector3(0,1.72,0),scale:new Vector3(1,1,1),rotation:(new Quaternion).setEuler(0,0,0)})),T.addComponent(new GLTFShape("models/teleporter.gltf")),T}return __extends(Teleporter,v),Teleporter}(Entity);T.Teleporter=A}));